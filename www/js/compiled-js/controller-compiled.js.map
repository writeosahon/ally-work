{"version":3,"sources":["controller.js"],"names":[],"mappings":"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","file":"controller-compiled.js","sourcesContent":["/**\r\n * Created by UTOPIA SOFTWARE on 3/11/2017.\r\n */\r\n\r\n/**\r\n * file defines all View-Models, Controllers and Event Listeners used by the app\r\n *\r\n * The 'utopiasoftware.ally' namespace has being defined in the base js file.\r\n * The author uses the terms 'method' and function interchangeably; likewise the terms 'attribute' and 'property' are\r\n * also used interchangeably\r\n */\r\n\r\n\r\n// define the controller namespace\r\nutopiasoftware.ally.controller = {\r\n\r\n    /**\r\n     * method is used to handle the special event created by the intel xdk developer library. The special event (app.Ready)\r\n     * is triggered when ALL the hybrid app plugins have been loaded/readied and also the document DOM content is ready\r\n     */\r\n    appReady: () => {\r\n\r\n        // initialise the onsen library\r\n        ons.ready(function () {\r\n            // set the default handler for the app\r\n            ons.setDefaultDeviceBackButtonListener(function(){\r\n                // does nothing for now!!\r\n            });\r\n\r\n\r\n            if(utopiasoftware.ally.model.isAppReady === false){ // if app has not completed loading\r\n                // displaying prepping message\r\n                $('#loader-modal-message').html(\"Loading App...\");\r\n                $('#loader-modal').get(0).show(); // show loader\r\n            }\r\n\r\n            // check if the user is currently logged in\r\n            if(window.localStorage.getItem(\"app-status\") && window.localStorage.getItem(\"app-status\") != \"\"){ // user is logged in\r\n                //set the first page to be displayed to be the login page\r\n                $('ons-splitter').get(0).content.load(\"login-template\");\r\n            }\r\n            else{ // user has NOT been logged in\r\n                // set the first page to be displayed to be the onboarding page\r\n                $('ons-splitter').get(0).content.load(\"onboarding-template\");\r\n            }\r\n\r\n\r\n            // listen to when the device back button is clicked when the lock screen modal is shown\r\n            $('#lock-screen-modal').get(0).onDeviceBackButton = utopiasoftware.ally.controller.\r\n                lockScreenModalViewModel.exitButtonClicked;\r\n\r\n            // listen to when the device back button is clicked when the lock screen modal is shown\r\n            $('#merchant-payment-receipt-modal').get(0).onDeviceBackButton = function(){\r\n                $('#merchant-payment-receipt-modal').get(0).hide();\r\n            };\r\n\r\n            // listen for \"HOLD\" events that are triggered in the app\r\n            document.addEventListener('hold', function(event) {\r\n                // check if the backspace button in the 'lock-screen-modal' is held\r\n                if ($(event.target).closest('#lock-screen-backspace-col', '#lock-screen-modal').\r\n                    is('#lock-screen-backspace-col')) { //backspace button has been held\r\n                    // remove the entire contents of the input field\r\n                    $('#lock-screen-modal #lock-screen-lock-pin').val(\"\");\r\n                    return; // exit\r\n                }\r\n\r\n\r\n            });\r\n\r\n        });\r\n        // END OF ONSEN LIBRARY READY EVENT\r\n\r\n\r\n        // add listener for when the Internet network connection is offline\r\n        document.addEventListener(\"offline\", function(){\r\n\r\n            // display a toast message to let user no there is no Internet connection\r\n            window.plugins.toast.showWithOptions({\r\n                message: \"No Internet Connection. App functionality may be limited\",\r\n                duration: 4000, // 4000 ms\r\n                position: \"bottom\",\r\n                styling: {\r\n                    opacity: 1,\r\n                    backgroundColor: '#000000',\r\n                    textColor: '#FFFFFF',\r\n                    textSize: 14\r\n                }\r\n            });\r\n\r\n        }, false);\r\n\r\n        // add listener for when the Internet network connection is online\r\n        document.addEventListener(\"online\", function(){\r\n\r\n            // setup code=push plugin to download remote update\r\n            // codePush.sync(null, { updateDialog: null, installMode: InstallMode.ON_NEXT_RESTART,\r\n            //     mandatoryInstallMode: InstallMode.ON_NEXT_RESTART});\r\n\r\n        }, false);\r\n\r\n        // add listener for when the device is going into the background i.e. paused\r\n        document.addEventListener(\"pause\", function(){\r\n            // get the current page view\r\n            var currentPageView = $('ons-splitter').get(0).content.page;\r\n\r\n            // if user is on the onboarding or login screens, do nothing\r\n            if(currentPageView.toString() == 'onboarding-template' || currentPageView.toString() == 'login-template'){\r\n                return; // exit\r\n            }\r\n\r\n            cordova.plugins.Keyboard.close(); // hide the keyboard, if it is visible\r\n\r\n            // reset the input that was previously displayed\r\n            $('#lock-screen-modal #lock-screen-lock-pin').val(\"\");\r\n            // hide the screen pin display message\r\n            $('#lock-screen-modal #lock-screen-message').css(\"visibility\", \"hidden\");\r\n\r\n            // show the lock screen modal\r\n            $('#lock-screen-modal').get(0).show();\r\n        }, false);\r\n\r\n\r\n        try {\r\n            // lock the orientation of the device to 'PORTRAIT'\r\n        screen.orientation.lock('portrait');\r\n        }\r\n        catch(err){}\r\n\r\n        // set status bar color\r\n        StatusBar.backgroundColorByHexString(\"#2C8E01\");\r\n\r\n        // prepare the inapp browser plugin\r\n        window.open = cordova.InAppBrowser.open;\r\n\r\n        // use Promises to load the other cordova plugins\r\n        new Promise(function(resolve, reject){\r\n            // this promise  just sets the promise chain in motion\r\n            window.setTimeout(function(){\r\n                resolve(); // resolve the promise\r\n            }, 0);\r\n        }).\r\n        then(function(){ // setup code=push plugin to download remote update\r\n\r\n            // codePush.sync(null, { updateDialog: null, installMode: InstallMode.ON_NEXT_RESTART,\r\n            //     mandatoryInstallMode: InstallMode.ON_NEXT_RESTART});\r\n            return null;\r\n        }).\r\n        then(function(){ // load the securely stored / encrypted data into the app\r\n            // check if the user is currently logged in\r\n            if(! window.localStorage.getItem(\"app-status\") || window.localStorage.getItem(\"app-status\") == \"\"){ // user is not logged in\r\n                return null;\r\n            }\r\n\r\n            return Promise.all(\r\n                [Promise.resolve(intel.security.secureStorage.read({\"id\": \"ally-user-details\"})),\r\n                    Promise.resolve(intel.security.secureStorage.read({\"id\": \"ally-user-secure-pin\"}))]);\r\n        }).\r\n        then(function(instanceIdArray){\r\n            if(instanceIdArray == null || instanceIdArray[0] == null || instanceIdArray[1] == null){ // user is not logged in\r\n                return null;\r\n            }\r\n\r\n            return Promise.all([Promise.resolve(intel.security.secureData.getData(instanceIdArray[0])),\r\n                Promise.resolve(intel.security.secureData.getData(instanceIdArray[1]))]);\r\n        }).\r\n        then(function(secureDataArray){\r\n\r\n            if(secureDataArray == null || secureDataArray[0] == null || secureDataArray[1] == null){ // user is not logged in\r\n                return null;\r\n            }\r\n\r\n            utopiasoftware.ally.model.appUserDetails = JSON.parse(secureDataArray[0]); // transfer the collected user details to the app\r\n            utopiasoftware.ally.model.appSecurePin = secureDataArray[1];\r\n\r\n            return null;\r\n        }).then(function(){ // setup push notification for the app\r\n\r\n            window.plugins.OneSignal\r\n                .startInit(\"d5d2bdba-eec0-46b1-836e-c5b8e318e928\")\r\n                .inFocusDisplaying(window.plugins.OneSignal.OSInFocusDisplayOption.None)\r\n                .handleNotificationReceived(utopiasoftware.ally.controller.pushNotificationModel.notificationOpened)\r\n                .handleNotificationOpened(utopiasoftware.ally.controller.pushNotificationModel.notificationOpened)\r\n                .endInit();\r\n            return null;\r\n        }).\r\n        then(function(){ // start analytics tracking\r\n            hockeyapp.start(function(){\r\n                hockeyapp.trackEvent(function(){}, function(){}, \"USER SESSION STARTED\"); // track start app session\r\n            }, function(){}, \"eeb9deb1b58d44948be72f178c159fbc\");\r\n\r\n        }).\r\n        then(function(){\r\n            // notify the app that the app has been successfully initialised and is ready for further execution (set app ready flag to true)\r\n            utopiasoftware.ally.model.isAppReady = true;\r\n            // hide the splash screen\r\n            navigator.splashscreen.hide();\r\n        }).\r\n        catch(function(err){\r\n            // notify the app that the app has been successfully initialised and is ready for further execution (set app ready flag to true)\r\n            utopiasoftware.ally.model.isAppReady = true;\r\n            // hide the splash screen\r\n            navigator.splashscreen.hide();\r\n\r\n            // display a toast message to let user no there is no Internet connection\r\n            window.plugins.toast.showWithOptions({\r\n                message: \"Startup Error. App functionality may be limited. Always update the app to \" +\r\n                \"get the best secure experience. Please contact us if problem continues\",\r\n                duration: 5000, // 5000 ms\r\n                position: \"bottom\",\r\n                styling: {\r\n                    opacity: 1,\r\n                    backgroundColor: '#000000',\r\n                    textColor: '#FFFFFF',\r\n                    textSize: 14\r\n                }\r\n            });\r\n        });\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is the view-model for the app side menu\r\n     */\r\n    sideMenuViewModel : {\r\n\r\n        /**\r\n         * method is used to listen for when the list\r\n         * items in the side menu is clicked\r\n         *\r\n         * @param label {String} label represents clicked list item in the side-menu\r\n         */\r\n        sideMenuListClicked: function(label) {\r\n\r\n\r\n            if(label == \"change pin\"){ // 'change pin' list item was clicked\r\n\r\n                // close the side menu\r\n                $('ons-splitter').get(0).right.close().\r\n                then(function(){\r\n                    $('#app-main-navigator').get(0).bringPageTop(\"change-pin-page.html\", {}); // navigate to the specified page\r\n                }).catch(function(){});\r\n\r\n                return;\r\n            }\r\n\r\n            if(label == \"my account\"){ // 'my account' list item was clicked\r\n\r\n                // close the side menu\r\n                $('ons-splitter').get(0).right.close().\r\n                then(function(){\r\n                    $('#app-main-navigator').get(0).bringPageTop(\"account-page.html\", {}); // navigate to the specified page\r\n                }).catch(function(){});\r\n\r\n                return;\r\n            }\r\n\r\n            if(label == \"account settings\"){ // 'account settings' list item was clicked\r\n\r\n                // close the side menu\r\n                $('ons-splitter').get(0).right.close().\r\n                then(function(){\r\n                    $('#app-main-navigator').get(0).bringPageTop(\"account-settings-page.html\", {}); // navigate to the specified page\r\n                }).catch(function(){});\r\n\r\n                return;\r\n            }\r\n\r\n            if(label == \"transaction history\"){ // 'transaction history' list item was clicked\r\n\r\n                // close the side menu\r\n                $('ons-splitter').get(0).right.close().\r\n                then(function(){\r\n                    $('#app-main-navigator').get(0).bringPageTop(\"transaction-history-page.html\", {}); // navigate to the specified page\r\n                }).catch(function(){});\r\n\r\n                return;\r\n            }\r\n\r\n            if(label == \"sign out\"){ // 'sign out' list item was clicked\r\n\r\n                // display the loader message to indicate that user is signing out;\r\n                $('#loader-modal-message').html(\"Completing User Sign Out...\");\r\n\r\n                // close the side menu\r\n                Promise.all([$('ons-splitter').get(0).right.close(), $('#loader-modal').get(0).show()]).\r\n                then(function(){\r\n                    // clear all data in the device local/session storage\r\n                    window.localStorage.clear();\r\n                    window.sessionStorage.clear();\r\n                    // clear the user data used in-app\r\n                    utopiasoftware.ally.model.appSecurePin = null;\r\n                    utopiasoftware.ally.model.appUserDetails = {};\r\n\r\n                    return new Promise(function(resolve, reject){\r\n                        // delete the user app details from secure storage if it exists\r\n                        Promise.resolve(intel.security.secureStorage.\r\n                        delete({'id':'ally-user-details'})).\r\n                        then(function(){resolve();},function(){resolve();}); // ALWAYS resolve the promise\r\n                    });\r\n\r\n                }).\r\n                then(function(){ // hide the loader\r\n                    return $('#loader-modal').get(0).hide();\r\n                }).\r\n                then(function(){ // load the login page\r\n                    $('ons-splitter').get(0).content.load('login-template'); // navigate to the login page\r\n                }).\r\n                catch(function(){});\r\n                Promise.all([$('#loader-modal').get(0).hide(), $('ons-splitter').get(0).content.load('login-template')]);\r\n                return;\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * object is the view-model for the app push notification\r\n     */\r\n    pushNotificationModel: {\r\n\r\n        /**\r\n         * method is used to handle both when notification are opened from the notification tray AND when a\r\n         * notification is received when the app is open\r\n         * @param notificationObj\r\n         */\r\n        notificationOpened(notificationObj){\r\n\r\n            // check if the notification data is stored in another object(for when the notification is opened from 'tray')\r\n            if(notificationObj.notification){ // notification was opened from tray\r\n                notificationObj = notificationObj.notification; // assign the 'real' notification object to the passed param\r\n            }\r\n\r\n            // set the title for the notification message\r\n            $('#push-notification-modal #push-notification-heading').html(notificationObj.payload.title);\r\n            // set the content for the push notification message\r\n            $('#push-notification-modal #push-notification-message').html(notificationObj.payload.body);\r\n            $('#push-notification-modal').get(0).show(); // show the push-notification modal\r\n        }\r\n    },\r\n\r\n    /**\r\n     * object is the view-model for the app lock-screen-modal\r\n     */\r\n    lockScreenModalViewModel: {\r\n\r\n        /**\r\n         * property holds the input field jquery object used in the\r\n         * security pin lock modal\r\n         */\r\n        $pinLockInputField: null,\r\n\r\n\r\n        /**\r\n         * holds the unique id assigned to every timer which is used to\r\n         * change the input field entry from 'visible' to 'hidden'\r\n         */\r\n        clearTimeoutId: -1,\r\n\r\n\r\n        /**\r\n         * method is triggered when a number key on the app security pin lock is tapped\r\n         *\r\n         * @param numberInput {String} number input\r\n         */\r\n        numberButtonClicked: function(numberInput){\r\n            // check if the input field jquery object is null. if so, initialise it\r\n            if(!utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField){\r\n                // initialise the input property\r\n                utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField =\r\n                    $('#lock-screen-modal #lock-screen-lock-pin');\r\n            }\r\n\r\n            // hide the WRONG PIN message that may be displayed\r\n            $('#lock-screen-modal #lock-screen-message').css(\"visibility\", \"hidden\");\r\n\r\n            // update the security input field with the provided number input\r\n            utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField.\r\n            val(utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField.val() + numberInput);\r\n            // update the input field css text input style, so user can see the inputed number\r\n            $('input', utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField).\r\n            css('-webkit-text-security', 'none');\r\n\r\n            // clear any previous timeout that may have been set\r\n            window.clearTimeout(utopiasoftware.ally.controller.lockScreenModalViewModel.clearTimeoutId);\r\n\r\n            utopiasoftware.ally.controller.lockScreenModalViewModel.clearTimeoutId =\r\n                setTimeout(function(){ // wait for 1 second\r\n                    // update the input field css text input style, so user cannot see the inputed number\r\n                    $('input', utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField).\r\n                    css('-webkit-text-security', 'disc');\r\n                }, 1000);\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the exit button on the app security pin is clicked\r\n         */\r\n        exitButtonClicked: function(){\r\n\r\n            ons.notification.confirm('Do you want to close the app?', {title: 'Exit',\r\n                    buttonLabels: ['No', 'Yes']}) // Ask for confirmation\r\n                .then(function(index) {\r\n                    if (index === 1) { // OK button\r\n                        navigator.app.exitApp(); // Close the app\r\n                    }\r\n                });\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the \"confirm\" button on the\r\n         * app security pin is clicked\r\n         */\r\n        confirmButtonClicked: function(){\r\n\r\n            // check if the input field jquery object is null. if so, initialise it\r\n            // check if the input field jquery object is null. if so, initialise it\r\n            if(!utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField){\r\n                // initialise the input property\r\n                utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField =\r\n                    $('#lock-screen-modal #lock-screen-lock-pin');\r\n            }\r\n\r\n            if(utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField.val() ===\r\n                utopiasoftware.ally.model.appSecurePin){ // authentication successful\r\n\r\n                $('#lock-screen-modal').get(0).hide(); // hide the security pin modal\r\n            }\r\n            else{ // authentication failed\r\n                $('#lock-screen-modal #lock-screen-message').css(\"visibility\", \"visible\");\r\n            }\r\n\r\n            // reset the input value of the security pin modal\r\n            utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField.val(\"\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the backspace button on the\r\n         * app security pin is clicked\r\n         */\r\n        backspaceButtonClicked: function(){\r\n\r\n            // check if the input field jquery object is null. if so, initialise it\r\n            if(!utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField){\r\n                // initialise the input property\r\n                utopiasoftware.ally.controller.lockScreenModalViewModel.$pinLockInputField =\r\n                    $('#lock-screen-modal #lock-screen-lock-pin');\r\n            }\r\n\r\n            var inputString = $('#lock-screen-modal #lock-screen-lock-pin').val(); // get the value from the input\r\n            // remove the last character from the input field\r\n            $('#lock-screen-modal #lock-screen-lock-pin').val(inputString.substring(0, inputString.length - 1));\r\n        },\r\n\r\n        /**\r\n         * method is used to prevent the device from displaying the content menu for\r\n         * devices\r\n         * @param event\r\n         * @returns {boolean}\r\n         */\r\n        preventContextMenuForInput: function(event){\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            return false;\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for main-menu page\r\n     */\r\n    mainMenuPageViewModel: {\r\n\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n            $('#menu-tabbar .tabbar__border').css(\"visibility\", \"hidden\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // stop the rotating animation on main menu page\r\n            //$('.rotating-infinite-ease-in-1').addClass('rotating-infinite-ease-in-1-paused');\r\n        },\r\n\r\n\r\n\r\n        /**\r\n         * method is used to track changes on the tabbar tabs\r\n         * @param event\r\n         */\r\n        tabbarPreChange(event){\r\n\r\n            // run the hide method of the payment page to ensure webpage is NOT transparent\r\n            utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.pageHide();\r\n            // proceed to to the 1st hidden tab on the payment page (i.e. reset payment)\r\n            $('#payments-page #payments-tabbar').get(0).setActiveTab(0);\r\n\r\n            // determine the tab that was clicked\r\n            switch(event.originalEvent.index){\r\n                case 0:\r\n                    $('#menu-tabbar ons-tab').removeAttr(\"label\"); // remove all displaced labels\r\n\r\n                    $(event.originalEvent.tabItem).attr(\"label\", \"Dashboard\"); // update the label of the to-be displayed tab\r\n\r\n                    break;\r\n\r\n                case 1:\r\n                    $('#menu-tabbar ons-tab').removeAttr(\"label\"); // remove all displaced labels\r\n\r\n                    $(event.originalEvent.tabItem).attr(\"label\", \"Payments\"); // update the label of the to-be displayed tab\r\n\r\n                    break;\r\n\r\n                case 2:\r\n                    $('#menu-tabbar ons-tab').removeAttr(\"label\"); // remove all displaced labels\r\n\r\n                    $(event.originalEvent.tabItem).attr(\"label\", \"Wallet\"); // update the label of the to-be displayed tab\r\n\r\n                    break;\r\n\r\n                case 3:\r\n                    $('#menu-tabbar ons-tab').removeAttr(\"label\"); // remove all displaced labels\r\n\r\n                    $(event.originalEvent.tabItem).attr(\"label\", \"Transfers\"); // update the label of the to-be displayed tab\r\n\r\n                    break;\r\n\r\n                case 4:\r\n                    $('#menu-tabbar ons-tab').removeAttr(\"label\"); // remove all displaced labels\r\n\r\n                    $(event.originalEvent.tabItem).attr(\"label\", \"Expense Tracker\"); // update the label of the to-be displayed tab\r\n\r\n                    break;\r\n            }\r\n        }\r\n\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for onboarding page\r\n     */\r\n    onboardingPageViewModel: {\r\n\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#onboarding-navigator').get(0).topPage.onDeviceBackButton = function(){\r\n                    ons.notification.confirm('Do you want to close the app?', {title: 'Exit',\r\n                            buttonLabels: ['No', 'Yes']}) // Ask for confirmation\r\n                        .then(function(index) {\r\n                            if (index === 1) { // OK button\r\n                                navigator.app.exitApp(); // Close the app\r\n                            }\r\n                        });\r\n                };\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n        },\r\n\r\n\r\n        /**\r\n         * method is used to listen for click events of the \"Sign Up\" button\r\n         *\r\n         */\r\n        signupButtonClicked: function(){\r\n\r\n            $('#onboarding-navigator').get(0).pushPage(\"signup-page.html\", {}); // navigate to the signup page\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * method is used to listen for click events of the \"Login\" button\r\n         *\r\n         */\r\n        loginButtonClicked: function(){\r\n\r\n            $('ons-splitter').get(0).content.load('login-template'); // navigate to the login page\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * method is used to track changes on the carousel slides\r\n         * @param event\r\n         */\r\n        carouselPostChange(event){\r\n\r\n            // change the carousel counter indicator based on the currently active and previously active carousel slides\r\n            $('#onboarding-page .carousel-counter').eq(event.originalEvent.lastActiveIndex).removeClass('active');\r\n            $('#onboarding-page .carousel-counter').eq(event.originalEvent.activeIndex).addClass('active');\r\n        }\r\n\r\n\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for login page\r\n     */\r\n    loginPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the sign-in page\r\n         */\r\n        formValidator: null,\r\n\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#login-navigator').get(0).topPage.onDeviceBackButton = function(){\r\n\r\n                    $('ons-splitter').get(0).content.load('onboarding-template');\r\n                };\r\n\r\n                // check if the user is currently logged in\r\n                if(window.localStorage.getItem(\"app-status\") && window.localStorage.getItem(\"app-status\") != \"\"){ // user is logged in\r\n                    // display the user's save phone number on the login page phonenumber input\r\n                    $('#login-page #login-phone-number').val(window.localStorage.getItem(\"app-status\"));\r\n                }\r\n\r\n                // initialise the login form validation\r\n                utopiasoftware.ally.controller.loginPageViewModel.formValidator = $('#login-form').parsley();\r\n\r\n                // attach listener for the log in button click event on the login page\r\n                $('#login-signin').get(0).onclick = function(){\r\n                    // run the validation method for the sign-in form\r\n                    utopiasoftware.ally.controller.loginPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for log in form field validation failure event\r\n                utopiasoftware.ally.controller.loginPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for log in form field validation success event\r\n                utopiasoftware.ally.controller.loginPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for log in form validation success\r\n                utopiasoftware.ally.controller.loginPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.loginPageViewModel.loginFormValidated);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n\r\n            try {\r\n                // remove any tooltip being displayed on all forms in the login page\r\n                $('#login-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#login-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object in the sign-in page\r\n                utopiasoftware.ally.controller.loginPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n            try{\r\n                // remove any tooltip being displayed on all forms in the login page\r\n                $('#login-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#login-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects in the login page\r\n                utopiasoftware.ally.controller.loginPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when sign-in form is successfully validated\r\n         *\r\n         */\r\n        loginFormValidated: function(){\r\n\r\n            // check if Internet Connection is available AND if user has been logged in  before proceeding\r\n            if(navigator.connection.type === Connection.NONE &&\r\n                (window.localStorage.getItem(\"app-status\") && window.localStorage.getItem(\"app-status\") !== \"\")){\r\n                // no Internet Connection, but user has been previously logged in\r\n\r\n                // inform the user that cached data will be used for log in\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be used for log in\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // begin login process\r\n                Promise.resolve().\r\n                then(function(){\r\n                    // display the loader message to indicate that account is being created;\r\n                    $('#loader-modal-message').html(\"Completing User Login...\");\r\n                    return Promise.resolve($('#loader-modal').get(0).show()); // show loader\r\n                }).\r\n                then(function(){\r\n                    // get the log-in credentials from the form\r\n                    var formData = {\r\n                        lock: $('#login-page #login-pin').val(),\r\n                        phone: $('#login-page #login-phone-number').val().startsWith(\"0\") ?\r\n                            $('#login-page #login-phone-number').val().replace(\"0\", \"+234\"):$('#login-page #login-phone-number').val()\r\n                    };\r\n\r\n                    return formData;\r\n                }).\r\n                then(function(formData){ // check that the log-in credentials are valid\r\n                    if(formData.phone === utopiasoftware.ally.model.appUserDetails.phone &&\r\n                    formData.lock === utopiasoftware.ally.model.appSecurePin){ // user provided valid credentials\r\n                        // log user in\r\n                        return $('ons-splitter').get(0).content.load(\"app-main-template\");\r\n                    }\r\n                    else { // user provided invalid credentials, so throw error\r\n                        throw \"Invalid phone number or PIN\";\r\n                    }\r\n                }).\r\n                then(function(){ // log in completed\r\n                    return Promise.all([$('#loader-modal').get(0).hide(),\r\n                        ons.notification.toast(\"Login complete! Welcome\", {timeout:3000})]);\r\n                }).\r\n                catch(function(err){\r\n                    if(typeof err !== \"string\"){ // if err is NOT a String\r\n                        err = \"Sorry. Login could not be completed\"\r\n                    }\r\n                    $('#loader-modal').get(0).hide(); // hide loader\r\n                    ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                    'style=\"color: red;\"></ons-icon> Log In Failed',\r\n                        messageHTML: '<span>' + err + '</span>',\r\n                        cancelable: false\r\n                    });\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            // no internet connection to log user in remotely\r\n            if(navigator.connection.type === Connection.NONE){\r\n                // inform user of this\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"user cannot login to ALLY account without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                lock: $('#login-page #login-pin').val(),\r\n                phone: $('#login-page #login-phone-number').val().startsWith(\"0\") ?\r\n                    $('#login-page #login-phone-number').val().replace(\"0\", \"+234\"):$('#login-page #login-phone-number').val()\r\n            };\r\n\r\n\r\n            // begin login process\r\n            Promise.resolve().\r\n            then(function(){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#loader-modal-message').html(\"Completing User Login...\");\r\n                return Promise.resolve($('#loader-modal').get(0).show()); // show loader\r\n            }).\r\n            then(function(){ // clear all data belonging to previous user\r\n                var promisesArray = []; // holds all the Promise objects for all data being deleted\r\n\r\n                var promiseObject = new Promise(function(resolve, reject){\r\n                    // delete the user app details from secure storage if it exists\r\n                    Promise.resolve(intel.security.secureStorage.\r\n                    delete({'id':'ally-user-details'})).\r\n                    then(function(){resolve();},function(){resolve();}); // ALWAYS resolve the promise\r\n                });\r\n\r\n                // add the promise object to the promise array\r\n                promisesArray.push(promiseObject);\r\n\r\n                promiseObject = new Promise(function(resolve, reject){\r\n                    // delete the user secure pin from secure storage if it exists\r\n                    Promise.resolve(intel.security.secureStorage.\r\n                    delete({'id':'ally-user-secure-pin'})).\r\n                    then(function(){resolve();},function(){resolve();}); // ALWAYS resolve the promise\r\n                });\r\n\r\n                // add the promise object to the promise array\r\n                promisesArray.push(promiseObject);\r\n                // if the previously logged in user is NOT the same user trying to log in\r\n                if(window.localStorage.getItem(\"app-status\") != formData.phone){ // a different user from the stored user is loggin in\r\n                    // add the promise object used to delete all other cached data\r\n                    promisesArray.push(utopiasoftware.ally.dashboardCharts.deleteWalletTransferInData(),\r\n                        utopiasoftware.ally.dashboardCharts.deleteWalletTransferOutData(),\r\n                        utopiasoftware.ally.dashboardCharts.deleteExpenseTrackerData(),\r\n                        utopiasoftware.ally.dashboardCharts.deletePaymentOutData(),\r\n                        utopiasoftware.ally.dashboardCharts.deletePaymentInData(),\r\n                        utopiasoftware.ally.transactionHistoryCharts.deleteTransactionHistoryData(),\r\n                        utopiasoftware.ally.expenseTrackerGrid.deleteExpenseTrackerData(),\r\n                        utopiasoftware.ally.expenseTrackerChart.deleteExpenseTrackerData());\r\n                }\r\n\r\n                // return promise when all operations have completed\r\n                return Promise.all(promisesArray);\r\n            }).\r\n            then(function(){\r\n                // if the previously logged in user is NOT the same user trying to log in\r\n                if(window.localStorage.getItem(\"app-status\") != formData.phone){ // a different user from the stored user is loggin in\r\n                    // clear all data in the device local/session storage\r\n                    window.localStorage.clear();\r\n                    window.sessionStorage.clear();\r\n                }\r\n                return null;\r\n            }).\r\n            then(function(){\r\n                // upload the user details to the server\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/login.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData\r\n                    }\r\n                ));\r\n\r\n            }).\r\n            then(function(serverResponseText){\r\n                serverResponseText +=  \"\";\r\n                var newUser = JSON.parse(serverResponseText.trim()); // get the new user object\r\n                // add a timestamp for the last time user details was updated\r\n                newUser._lastUpdatedDate = Date.now();\r\n\r\n                // check if any error occurred\r\n                if(newUser.status == \"error\"){ // an error occured\r\n                    throw newUser.message; // throw the error message attached to this error\r\n                }\r\n\r\n                // store user data\r\n                utopiasoftware.ally.model.appUserDetails = newUser; // store the user details\r\n\r\n                // store the user secure pin\r\n                utopiasoftware.ally.model.appSecurePin = formData.lock;\r\n\r\n                return newUser; // return user data\r\n\r\n            }).\r\n            then(function(newUser){\r\n                // create a cypher data of the user details & secure pin\r\n                return Promise.all([Promise.resolve(intel.security.secureData.\r\n                createFromData({\"data\": JSON.stringify(newUser)})),\r\n                    Promise.resolve(intel.security.secureData.\r\n                    createFromData({\"data\": utopiasoftware.ally.model.appSecurePin}))]);\r\n            }).\r\n            then(function(instanceIdArray){\r\n                // store the cyphered user data & secure pin in secure persistent storage\r\n                return Promise.all([Promise.resolve(\r\n                    intel.security.secureStorage.write({\"id\": \"ally-user-details\", \"instanceID\": instanceIdArray[0]})),\r\n                    Promise.resolve(\r\n                        intel.security.secureStorage.write({\"id\": \"ally-user-secure-pin\", \"instanceID\": instanceIdArray[1]}))]);\r\n            }).\r\n            then(function(){\r\n\r\n                // set app-status local storage (as user phone number)\r\n                window.localStorage.setItem(\"app-status\", utopiasoftware.ally.model.appUserDetails.phone);\r\n\r\n                // update the first name being displayed in the side menu\r\n                //$('#side-menu-username').html(utopiasoftware.saveup.model.appUserDetails.firstName);\r\n\r\n                return $('#loader-modal').get(0).hide(); // hide loader\r\n            }).\r\n            then(function(){ // navigate to the main menu page\r\n                return $('ons-splitter').get(0).content.load(\"app-main-template\");\r\n            }).\r\n            then(function(){\r\n                ons.notification.toast(\"Login complete! Welcome\", {timeout:3000});\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Login could not be completed\"\r\n                }\r\n                $('#loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Log In Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n\r\n        }\r\n\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for forgot-pin page\r\n     */\r\n    forgotPinPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#login-navigator').get(0).topPage.onDeviceBackButton = function(){\r\n\r\n                    $('#login-navigator').get(0).popPage({});\r\n                };\r\n\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator = $('#forgot-pin-form').parsley();\r\n\r\n                // attach listener for the log in button click event on the login page\r\n                $('#forgot-pin-reset').get(0).onclick = function(){\r\n                    // run the validation method for the sign-in form\r\n                    utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for log in form field validation failure event\r\n                utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for log in form field validation success event\r\n                utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for log in form validation success\r\n                utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.forgotPinPageViewModel.forgotPinFormValidated);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n\r\n            try {\r\n                // remove any tooltip being displayed on all forms in the page\r\n                $('#forgot-pin-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#forgot-pin-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object in the page\r\n                utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n            try{\r\n                // remove any tooltip being displayed on all forms in the page\r\n                $('#forgot-pin-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#forgot-pin-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects in the page\r\n                utopiasoftware.ally.controller.forgotPinPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         *\r\n         */\r\n        forgotPinFormValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY user secure PIN cannot be reset without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // prepare the form data to be submitted\r\n            var formData = {\r\n                phone: $('#forgot-pin-page #forgot-pin-phone-number').val().startsWith(\"0\") ?\r\n                    $('#forgot-pin-page #forgot-pin-phone-number').val().replace(\"0\", \"+234\"):\r\n                    $('#forgot-pin-page #forgot-pin-phone-number').val()\r\n            };\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#loader-modal-message').html(\"Resetting User PIN...\");\r\n\r\n            // begin pin reset process\r\n            Promise.resolve($('#loader-modal').get(0).show()). // show loader.\r\n            then(function(){\r\n                // upload the user details to the server\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/reset-password.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData\r\n                    }\r\n                ));\r\n\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status == \"error\"){ // an error occurred\r\n                    throw serverResponse.message; // throw the error message attached to this error\r\n                }\r\n\r\n                // pin reset was successful, hide loader\r\n                return Promise.all([serverResponse, Promise.resolve($('#loader-modal').get(0).hide())])\r\n\r\n            }).\r\n            then(function(promiseArray){\r\n\r\n                // go back to the login page\r\n                return Promise.all([promiseArray[0], $('#login-navigator').get(0).popPage({})]);\r\n            }).\r\n            then(function(promiseArray){ // display a message to the user that the secure pin has been reset\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-check-circle\" size=\"32px\" ' +\r\n                'style=\"color: green;\"></ons-icon> PIN Reset Successful',\r\n                    messageHTML: `<span>${promiseArray[0].message}</span>`,\r\n                    cancelable: false\r\n                });\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. PIN reset failed. You can try again\"\r\n                }\r\n                $('#loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> PIN Reset Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n\r\n        }\r\n\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for signup page\r\n     */\r\n    signupPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#onboarding-navigator').get(0).topPage.onDeviceBackButton = function(){\r\n                    // move to the onboarding page\r\n                    $('#onboarding-navigator').get(0).popPage({});\r\n                };\r\n\r\n                // initialise the create-account form validation\r\n                utopiasoftware.ally.controller.signupPageViewModel.formValidator = $('#signup-form').parsley();\r\n\r\n                // attach listener for the sign up button on the page\r\n                $('#signup-signup-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.signupPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for log in form field validation failure event\r\n                utopiasoftware.ally.controller.signupPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.signupPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.signupPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.signupPageViewModel.signupFormValidated);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the signup page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#signup-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#signup-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.signupPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the signup page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#signup-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#signup-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.signupPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when sign-up form is successfully validated\r\n         */\r\n        signupFormValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY account cannot be created without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var createAcctFormData = {\r\n                firstName: $('#signup-page #signup-firstname').val().trim(),\r\n                lastName: $('#signup-page #signup-lastname').val().trim(),\r\n                lock: $('#signup-page #signup-secure-pin').val(),\r\n                phone: $('#signup-page #signup-phone-number').val().startsWith(\"0\") ?\r\n                    $('#signup-page #signup-phone-number').val().replace(\"0\", \"+234\"):$('#signup-page #signup-phone-number').val()\r\n            };\r\n\r\n\r\n            // tell the user that phone number verification is necessary\r\n            new Promise(function(resolve, reject){\r\n                ons.notification.confirm('To complete sign up, your phone number must be verified. <br>' +\r\n                        'You will receive an SMS with your verification code shortly.<br> ' +\r\n                        \"Tap 'OK' to proceed\", {title: 'Verify Phone Number',\r\n                        buttonLabels: ['Cancel', 'Ok']}) // Ask for confirmation\r\n                    .then(function(index) {\r\n                        if (index === 1) { // OK button\r\n                            resolve();\r\n                        }\r\n                        else{\r\n                            reject(\"your phone number could not be verified\");\r\n                        }\r\n                    });\r\n            }).\r\n            then(function(){ // verify the user's phone number\r\n\r\n                //return null;\r\n                return utopiasoftware.ally.validatePhoneNumber($('#signup-page #signup-phone-number').val());\r\n            }).\r\n            then(function(){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#loader-modal-message').html(\"Completing Sign Up...\");\r\n                return Promise.resolve($('#loader-modal').get(0).show()); // show loader\r\n            }).\r\n            then(function(){ // clear all data belonging to previous user\r\n                var promisesArray = []; // holds all the Promise objects for all data being deleted\r\n\r\n                var promiseObject = new Promise(function(resolve, reject){\r\n                    // delete the user app details from secure storage if it exists\r\n                    Promise.resolve(intel.security.secureStorage.\r\n                    delete({'id':'ally-user-details'})).\r\n                    then(function(){resolve();},function(){resolve();}); // ALWAYS resolve the promise\r\n                });\r\n\r\n                // add the promise object to the promise array\r\n                promisesArray.push(promiseObject);\r\n\r\n                promiseObject = new Promise(function(resolve, reject){\r\n                    // delete the user secure pin from secure storage if it exists\r\n                    Promise.resolve(intel.security.secureStorage.\r\n                    delete({'id':'ally-user-secure-pin'})).\r\n                    then(function(){resolve();},function(){resolve();}); // ALWAYS resolve the promise\r\n                });\r\n\r\n                // add the promise object to the promise array\r\n                promisesArray.push(promiseObject);\r\n\r\n                // add the promise object used to delete the cached chart data\r\n                promisesArray.push(utopiasoftware.ally.dashboardCharts.deleteWalletTransferInData(),\r\n                    utopiasoftware.ally.dashboardCharts.deleteWalletTransferOutData(),\r\n                    utopiasoftware.ally.dashboardCharts.deleteExpenseTrackerData(),\r\n                    utopiasoftware.ally.dashboardCharts.deletePaymentOutData(),\r\n                    utopiasoftware.ally.dashboardCharts.deletePaymentInData(),\r\n                    utopiasoftware.ally.transactionHistoryCharts.deleteTransactionHistoryData(),\r\n                    utopiasoftware.ally.expenseTrackerGrid.deleteExpenseTrackerData(),\r\n                    utopiasoftware.ally.expenseTrackerChart.deleteExpenseTrackerData());\r\n\r\n                // return promise when all operations have completed\r\n                return Promise.all(promisesArray);\r\n            }).\r\n            then(function(){\r\n                // clear all data in the device local/session storage\r\n                window.localStorage.clear();\r\n                window.sessionStorage.clear();\r\n                return null;\r\n            }).\r\n            then(function(){\r\n                // upload the user details to the server\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/signup.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: createAcctFormData\r\n                    }\r\n                ));\r\n\r\n            }).\r\n            then(function(serverResponseText){\r\n                serverResponseText +=  \"\";\r\n                var newUser = JSON.parse(serverResponseText.trim()); // get the new user object\r\n                // add a timestamp for the last time user details was updated\r\n                newUser._lastUpdatedDate = Date.now();\r\n\r\n                // check if any error occurred\r\n                if(newUser.status == \"error\"){ // an error occured\r\n                    throw newUser.message; // throw the error message attached to this error\r\n                }\r\n\r\n                // store user data & secure pin\r\n                utopiasoftware.ally.model.appUserDetails = newUser;\r\n                utopiasoftware.ally.model.appSecurePin = createAcctFormData.lock;\r\n\r\n                return newUser;\r\n\r\n            }).\r\n            then(function(newUser){\r\n                // create a cypher data of the user details & secure pin\r\n                return Promise.all([Promise.resolve(intel.security.secureData.\r\n                createFromData({\"data\": JSON.stringify(newUser)})),\r\n                    Promise.resolve(intel.security.secureData.\r\n                    createFromData({\"data\": createAcctFormData.lock}))]);\r\n            }).\r\n            then(function(instanceIdArray){\r\n                // store the cyphered data & secure pin in secure persistent storage\r\n                return Promise.all([\r\n                    Promise.resolve(\r\n                    intel.security.secureStorage.write({\"id\": \"ally-user-details\", \"instanceID\": instanceIdArray[0]})),\r\n                    Promise.resolve(\r\n                        intel.security.secureStorage.write({\"id\": \"ally-user-secure-pin\", \"instanceID\": instanceIdArray[1]}))\r\n                ]);\r\n            }).\r\n            then(function(){\r\n\r\n                // set app-status local storage (as user phone number)\r\n                window.localStorage.setItem(\"app-status\", utopiasoftware.ally.model.appUserDetails.phone);\r\n\r\n                // update the first name being displayed in the side menu\r\n                //$('#side-menu-username').html(utopiasoftware.saveup.model.appUserDetails.firstName);\r\n\r\n                return $('#loader-modal').get(0).hide(); // hide loader\r\n            }).\r\n            then(function(){\r\n                return $('ons-splitter').get(0).content.load(\"app-main-template\");\r\n            }).\r\n            then(function(){\r\n                ons.notification.toast(\"Sign Up complete! Welcome\", {timeout:3000});\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Sign Up could not be completed\"\r\n                }\r\n                $('#loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Sign Up Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the PIN visibility button is clicked.\r\n         * It toggles pin visibility\r\n         *\r\n         * @param buttonElement\r\n         */\r\n        pinVisibilityButtonClicked: function(buttonElement){\r\n            if($(buttonElement).attr(\"data-ally-visible\") === \"no\"){ // pin is not visible, make it visible\r\n                $('#signup-secure-pin input').css(\"-webkit-text-security\", \"none\"); // change the text-security for the input field\r\n                $(buttonElement).find('ons-icon').attr(\"icon\", \"md-eye-off\"); // change the icon associated with the input\r\n                $(buttonElement).attr(\"data-ally-visible\", \"yes\"); // flag the pin is now visible\r\n            }\r\n            else{ // make the pin not visible\r\n                $('#signup-secure-pin input').css(\"-webkit-text-security\", \"disc\"); // change the text-security for the input field\r\n                $(buttonElement).find('ons-icon').attr(\"icon\", \"md-eye\"); // change the icon associated with the input\r\n                $(buttonElement).attr(\"data-ally-visible\", \"no\"); // flag the pin is now invisible\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the PIN visibility button is clicked.\r\n         * It toggles pin visibility\r\n         *\r\n         * @param buttonElement\r\n         */\r\n        confirmPinVisibilityButtonClicked: function(buttonElement){\r\n            if($(buttonElement).attr(\"data-ally-visible\") === \"no\"){ // pin is not visible, make it visible\r\n                $('#signup-confirm-secure-pin input').css(\"-webkit-text-security\", \"none\"); // change the text-security for the input field\r\n                $(buttonElement).find('ons-icon').attr(\"icon\", \"md-eye-off\"); // change the icon associated with the input\r\n                $(buttonElement).attr(\"data-ally-visible\", \"yes\"); // flag the pin is now visible\r\n            }\r\n            else{ // make the pin not visible\r\n                $('#signup-confirm-secure-pin input').css(\"-webkit-text-security\", \"disc\"); // change the text-security for the input field\r\n                $(buttonElement).find('ons-icon').attr(\"icon\", \"md-eye\"); // change the icon associated with the input\r\n                $(buttonElement).attr(\"data-ally-visible\", \"no\"); // flag the pin is now invisible\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is used to change the value for the Verify Phone Number based on the checkbox state.\r\n         * This change is used to enable validation for the input\r\n         *\r\n         * @param inputElement\r\n         */\r\n        verifyPhoneNumberClicked: function(inputElement){\r\n            if(inputElement.checked){ // input is checked\r\n                // update the input value\r\n                inputElement.value = \"checked\"\r\n            }\r\n            else{ // input is NOT checked\r\n                // reset the input value\r\n                inputElement.value = \"\"\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for dashboard page\r\n     */\r\n    dashboardPageViewModel: {\r\n\r\n\r\n        /**\r\n         * property is used to hold the \"Period Select\" dropdown list\r\n         */\r\n        periodDropDownListObject: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Transfers In\" Chart\r\n         */\r\n        walletIncomingChart: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Transfers Out\" Chart\r\n         */\r\n        walletOutgoingChart: null,\r\n\r\n\r\n        /**\r\n         * property is used to hold the \"Payments Out\" Chart\r\n         */\r\n        paymentsOutChart: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Payments In\" Chart\r\n         */\r\n        paymentsInChart: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Expense Tracker\" Chart\r\n         */\r\n        expenseTrackerChart: null,\r\n\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $thisPage.get(0).onDeviceBackButton = utopiasoftware.ally.controller.dashboardPageViewModel.backButtonClicked;\r\n\r\n                // inject the the modules required to create various charts for the dashboard page\r\n                ej.charts.Chart.Inject(ej.charts.Legend, ej.charts.LineSeries, ej.charts.AreaSeries, ej.charts.DateTime,\r\n                ej.charts.Tooltip);\r\n                ej.charts.AccumulationChart.Inject(ej.charts.Legend, ej.charts.PieSeries,\r\n                    ej.charts.AccumulationDataLabel, ej.charts.Tooltip);\r\n\r\n                // initialise the DropDownList\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject =\r\n                    new ej.dropdowns.DropDownList({\r\n                        placeholder: \"Select Period\",\r\n                        floatLabelType: 'Auto'\r\n                    });\r\n\r\n                // add listener for when the value of the period dropdown list is changed\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.\r\n                    addEventListener(\"change\", function(){\r\n                    // call the method used to ujpdate all charts on the dashboard.\r\n                    // Provide the currently selected value of the eriod dropdown list\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.refreshDashboardCharts(this.value);\r\n                });\r\n\r\n                // render initialized DropDownList\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.\r\n                appendTo('#dashboard-period-select');\r\n\r\n                // update the wallet balance dashboard\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.updateWalletDashboard();\r\n\r\n                // update the wallet-incoming chart using the value of the select Period dropdown list\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.\r\n                updateWalletIncomingDashboard(utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.value);\r\n\r\n                // update the wallet-outgoing chart using the value of the select Period dropdown list\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.\r\n                updateWalletOutgoingDashboard(utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.value);\r\n\r\n                // update the expense tracker chart using the value of the select Period dropdown list\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.\r\n                updateExpenseTrackerDashboard(utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.value);\r\n\r\n                // update the payments-out chart using the value of the select Period dropdown list\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.\r\n                updatePaymentOutDashboard(utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.value);\r\n\r\n                // update the payments-in chart using the value of the select Period dropdown list\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.\r\n                updatePaymentInDashboard(utopiasoftware.ally.controller.dashboardPageViewModel.periodDropDownListObject.value);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // stop the rotating animation on main menu page\r\n            //$('.rotating-infinite-ease-in-1').addClass('rotating-infinite-ease-in-1-paused');\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            ons.notification.confirm('Do you want to close the app?', {title: 'Exit',\r\n                    buttonLabels: ['No', 'Yes']}) // Ask for confirmation\r\n                .then(function(index) {\r\n                    if (index === 1) { // OK button\r\n                        navigator.app.exitApp(); // Close the app\r\n                    }\r\n                });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is used to update the ALLY Wallet Balance on the dashboard\r\n         */\r\n        updateWalletDashboard: function() {\r\n\r\n            // create an object that contains the balance of the user wallet\r\n            var tempObj = {balance: 0};\r\n\r\n             // show appropriate loader\r\n            $('#dashboard-ally-wallet-loader').css(\"display\", \"inline-block\");\r\n            $('#dashboard-ally-wallet').css(\"display\", \"none\");\r\n            $('#dashboard-ally-wallet').html(\"&#8358;\" + \"0\");\r\n            $('#dashboard-ally-wallet-last-updated').html(\"\");\r\n\r\n            // try to retrieve user updated wallet details\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-profile.php\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponseText){\r\n                serverResponseText +=  \"\";\r\n                var userDetailsData = JSON.parse(serverResponseText.trim()); // get the new user object\r\n                // add a timestamp for the last time user details was updated\r\n                userDetailsData._lastUpdatedDate = Date.now();\r\n\r\n                // check if any error occurred\r\n                if(userDetailsData.status == \"error\"){ // an error occurred\r\n                    throw userDetailsData.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return userDetailsData;\r\n\r\n            }, function(){\r\n                return utopiasoftware.ally.loadUserCachedAppDetails();\r\n            }).\r\n            then(function(userDetailsData){\r\n\r\n                // save the user details in the local app data and also cache it\r\n                utopiasoftware.ally.model.appUserDetails = userDetailsData;\r\n                return utopiasoftware.ally.saveUserAppDetails(userDetailsData);\r\n            }).\r\n            then(function(userDetailsData){\r\n\r\n                var walletElement = $('#dashboard-ally-wallet'); // holds the wallet element\r\n\r\n                anime({\r\n                    targets: tempObj,\r\n                    balance: userDetailsData.balance,\r\n                    duration: 1200,\r\n                    easing: 'linear',\r\n                    begin: function(){\r\n                        $('#dashboard-ally-wallet-loader').css(\"display\", \"none\");\r\n                        walletElement.css(\"display\", \"inline-block\");\r\n                    },\r\n                    update: function() {\r\n                        walletElement.html(\"&#8358;\" + tempObj.balance);\r\n                    },\r\n                    complete: function(){\r\n                        walletElement.html(\"&#8358;\" + kendo.toString(kendo.parseFloat(tempObj.balance), \"n2\"));\r\n                        $('#dashboard-ally-wallet-last-updated').\r\n                        html(kendo.toString(new Date(userDetailsData._lastUpdatedDate), \"MMM d yyyy, h:mmtt\"));\r\n                    }\r\n                });\r\n            });\r\n\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * update the wallet transfer-in dashboard. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updateWalletIncomingDashboard: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers In (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers In (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers In (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the walletIncoming Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.dashboardPageViewModel.walletIncomingChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.walletIncomingChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#dashboard-page #dashboard-wallet-incoming-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Wallet Transfers In\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadWalletTransferInData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.walletIncomingChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#30A401\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Time (GMT +1)',\r\n                                valueType: 'DateTime',\r\n                                labelFormat: chartCustomisableSettings.labelFormat,\r\n                                intervalType: chartCustomisableSettings.intervalType,\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount in thousands (N)',\r\n                                valueType: 'Double',\r\n                                labelFormat: '{value}k',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 2,\r\n                                marker: {visible: true, width: 8, height:8},\r\n                                xName: 'DDATE', yName: 'AMOUNT',\r\n                                name: 'Incoming Transfers',\r\n                                //Series type as line\r\n                                type: 'Line'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#dashboard-page #dashboard-wallet-incoming-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.walletIncomingChart.\r\n                    appendTo('#dashboard-wallet-incoming-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet transfer-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/chart-transfer-in.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone, duration: periodType} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadWalletTransferInData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.dashboardCharts.saveWalletTransferInData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.walletIncomingChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#30A401\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Time (GMT +1)',\r\n                            valueType: 'DateTime',\r\n                            labelFormat: chartCustomisableSettings.labelFormat,\r\n                            intervalType: chartCustomisableSettings.intervalType,\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount in thousands (N)',\r\n                            valueType: 'Double',\r\n                            labelFormat: '{value}k',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 2,\r\n                            marker: {visible: true, width: 8, height:8},\r\n                            xName: 'DDATE', yName: 'AMOUNT',\r\n                            name: 'Incoming Transfers',\r\n                            //Series type as line\r\n                            type: 'Line'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#dashboard-page #dashboard-wallet-incoming-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.walletIncomingChart.\r\n                appendTo('#dashboard-wallet-incoming-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = (kendo.parseFloat(dataObject.AMOUNT)) / 1000; // divide amount by 1000\r\n                    dataObject.DDATE = kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * update the wallet transfer-in dashboard. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updateWalletOutgoingDashboard: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers Out (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers Out (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers Out (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the walletOutgoing Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.dashboardPageViewModel.walletOutgoingChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.walletOutgoingChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#dashboard-page #dashboard-wallet-outgoing-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Wallet Transfers Out\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadWalletTransferOutData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.walletOutgoingChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#0FD0D0\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Time (GMT +1)',\r\n                                valueType: 'DateTime',\r\n                                labelFormat: chartCustomisableSettings.labelFormat,\r\n                                intervalType: chartCustomisableSettings.intervalType,\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount in thousands (N)',\r\n                                valueType: 'Double',\r\n                                labelFormat: '{value}k',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 2,\r\n                                marker: {visible: true, width: 8, height:8},\r\n                                xName: 'DDATE', yName: 'AMOUNT',\r\n                                name: 'Outgoing Transfers',\r\n                                //Series type as line\r\n                                type: 'Line'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#dashboard-page #dashboard-wallet-outgoing-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.walletOutgoingChart.\r\n                    appendTo('#dashboard-wallet-outgoing-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet transfer-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/chart-transfer-out.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone, duration: periodType} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadWalletTransferOutData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.dashboardCharts.saveWalletTransferOutData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.walletOutgoingChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#0FD0D0\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Time (GMT +1)',\r\n                            valueType: 'DateTime',\r\n                            labelFormat: chartCustomisableSettings.labelFormat,\r\n                            intervalType: chartCustomisableSettings.intervalType,\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount in thousands (N)',\r\n                            valueType: 'Double',\r\n                            labelFormat: '{value}k',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 2,\r\n                            marker: {visible: true, width: 8, height:8},\r\n                            xName: 'DDATE', yName: 'AMOUNT',\r\n                            name: 'Outgoing Transfers',\r\n                            //Series type as line\r\n                            type: 'Line'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#dashboard-page #dashboard-wallet-outgoing-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.walletOutgoingChart.\r\n                appendTo('#dashboard-wallet-outgoing-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = (kendo.parseFloat(dataObject.AMOUNT)) / 1000; // divide amount by 1000\r\n                    dataObject.DDATE = kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * update the expense tracker dashboard. Eithe using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updateExpenseTrackerDashboard: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the Doughnut Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.dashboardPageViewModel.expenseTrackerChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.expenseTrackerChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#dashboard-page #dashboard-expense-tracker-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Expense Tracker\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadExpenseTrackerData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.expenseTrackerChart =\r\n                        new ej.charts.AccumulationChart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            //palettes: [\"#0FD0D0\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Category: ${point.x} <br> Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            enableSmartLabels: true,\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                xName: 'CATEGORY', yName: 'SUM',\r\n                                name: 'Expenses',\r\n                                dataLabel: {\r\n                                    visible: true,\r\n                                    name: 'LABELTEXT',\r\n                                    position: 'Outside',\r\n                                    font: {\r\n                                        color: '#000000'\r\n                                    }\r\n                                },\r\n                                innerRadius: '0%',\r\n                                //Series type as Column\r\n                                type: 'Pie'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#dashboard-page #dashboard-expense-tracker-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.expenseTrackerChart.\r\n                    appendTo('#dashboard-expense-tracker-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            // create the data to be sent to server\r\n            var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                duration: periodType};\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet payments-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-expenses-group.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: formData // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadExpenseTrackerData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n\r\n                return utopiasoftware.ally.dashboardCharts.saveExpenseTrackerData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.expenseTrackerChart =\r\n                    new ej.charts.AccumulationChart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        //palettes: [\"#0FD0D0\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Category: ${point.x} <br> Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        enableSmartLabels: true,\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            xName: 'CATEGORY', yName: 'SUM',\r\n                            name: 'Expenses',\r\n                            dataLabel: {\r\n                                visible: true,\r\n                                name: 'LABELTEXT',\r\n                                position: 'Outside',\r\n                                font: {\r\n                                    color: '#000000'\r\n                                }\r\n                            },\r\n                            innerRadius: '0%',\r\n                            //Series type as Column\r\n                            type: 'Pie'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#dashboard-page #dashboard-expense-tracker-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.expenseTrackerChart.\r\n                appendTo('#dashboard-expense-tracker-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray = []){\r\n                var totalSum = 0; // the variable holds the grand total of all category summation\r\n\r\n                // get the grand total\r\n                totalSum = chartDataArray.reduce(function(accumulator, currentValue){\r\n                    accumulator += kendo.parseFloat(currentValue.SUM);\r\n                    return accumulator;\r\n                }, totalSum);\r\n\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.SUM = (kendo.parseFloat(dataObject.SUM));\r\n                    dataObject.LABELTEXT = kendo.toString((dataObject.SUM / totalSum), \"p\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * update the wallet payment-out dashboard. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updatePaymentOutDashboard: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments Out (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments Out (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments Out (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the walletIncoming Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.dashboardPageViewModel.paymentsOutChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.paymentsOutChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#dashboard-page #dashboard-wallet-payments-out-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Wallet Payments Out\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadPaymentOutData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.paymentsOutChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#30A401\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Time (GMT +1)',\r\n                                valueType: 'DateTime',\r\n                                labelFormat: chartCustomisableSettings.labelFormat,\r\n                                intervalType: chartCustomisableSettings.intervalType,\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount in thousands (N)',\r\n                                valueType: 'Double',\r\n                                labelFormat: '{value}k',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 2,\r\n                                marker: {visible: true, width: 8, height:8},\r\n                                xName: 'DDATE', yName: 'AMOUNT',\r\n                                name: 'Outgoing Payments',\r\n                                //Series type as line\r\n                                type: 'Area'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#dashboard-page #dashboard-wallet-payments-out-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.paymentsOutChart.\r\n                    appendTo('#dashboard-wallet-payments-out-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet payments-out data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/chart-payment-out.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone, duration: periodType} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadPaymentOutData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.dashboardCharts.savePaymentOutData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.paymentsOutChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#30A401\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Time (GMT +1)',\r\n                            valueType: 'DateTime',\r\n                            labelFormat: chartCustomisableSettings.labelFormat,\r\n                            intervalType: chartCustomisableSettings.intervalType,\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount in thousands (N)',\r\n                            valueType: 'Double',\r\n                            labelFormat: '{value}k',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 2,\r\n                            marker: {visible: true, width: 8, height:8},\r\n                            xName: 'DDATE', yName: 'AMOUNT',\r\n                            name: 'Outgoing Payments',\r\n                            //Series type as line\r\n                            type: 'Area'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#dashboard-page #dashboard-wallet-payments-out-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.paymentsOutChart.\r\n                appendTo('#dashboard-wallet-payments-out-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = (kendo.parseFloat(dataObject.AMOUNT)) / 1000; // divide amount by 1000\r\n                    dataObject.DDATE = kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * update the wallet payment-in dashboard. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updatePaymentInDashboard: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments In (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments In (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments In (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the walletIncoming Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.dashboardPageViewModel.paymentsInChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.paymentsInChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#dashboard-page #dashboard-wallet-payments-in-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Wallet Payments In\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadPaymentInData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.paymentsInChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#0FD0D0\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Time (GMT +1)',\r\n                                valueType: 'DateTime',\r\n                                labelFormat: chartCustomisableSettings.labelFormat,\r\n                                intervalType: chartCustomisableSettings.intervalType,\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount in thousands (N)',\r\n                                valueType: 'Double',\r\n                                labelFormat: '{value}k',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 2,\r\n                                marker: {visible: true, width: 8, height:8},\r\n                                xName: 'DDATE', yName: 'AMOUNT',\r\n                                name: 'Incoming Payments',\r\n                                //Series type as line\r\n                                type: 'Area'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#dashboard-page #dashboard-wallet-payments-in-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.dashboardPageViewModel.paymentsInChart.\r\n                    appendTo('#dashboard-wallet-payments-in-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet payments-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/chart-payment-in.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone, duration: periodType} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadPaymentInData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.dashboardCharts.savePaymentInData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.paymentsInChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#0FD0D0\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Time (GMT +1)',\r\n                            valueType: 'DateTime',\r\n                            labelFormat: chartCustomisableSettings.labelFormat,\r\n                            intervalType: chartCustomisableSettings.intervalType\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount in thousands (N)',\r\n                            valueType: 'Double',\r\n                            labelFormat: '{value}k'\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 2,\r\n                            marker: {visible: true, width: 8, height:8},\r\n                            xName: 'DDATE', yName: 'AMOUNT',\r\n                            name: 'Incoming Payments',\r\n                            //Series type as line\r\n                            type: 'Area'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#dashboard-page #dashboard-wallet-payments-in-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.dashboardPageViewModel.paymentsInChart.\r\n                appendTo('#dashboard-wallet-payments-in-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = (kendo.parseFloat(dataObject.AMOUNT)) / 1000; // divide amount by 1000\r\n                    dataObject.DDATE = kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is used to request a refresh of all chars on the dashboard page\r\n         *\r\n         * @param periodType {String} the time period for which the chars sghould be refreshed\r\n         */\r\n        refreshDashboardCharts: function(periodType){\r\n\r\n            // update the wallet-incoming chart using the value of the select Period dropdown list\r\n            utopiasoftware.ally.controller.dashboardPageViewModel.\r\n            updateWalletIncomingDashboard(periodType);\r\n\r\n            // update the wallet-outgoing chart using the value of the select Period dropdown list\r\n            utopiasoftware.ally.controller.dashboardPageViewModel.\r\n            updateWalletOutgoingDashboard(periodType);\r\n\r\n            // update the expense tracker chart using the value of the select Period dropdown list\r\n            utopiasoftware.ally.controller.dashboardPageViewModel.\r\n                updateExpenseTrackerDashboard(periodType)\r\n\r\n            // update the payments-out chart using the value of the select Period dropdown list\r\n            utopiasoftware.ally.controller.dashboardPageViewModel.\r\n            updatePaymentOutDashboard(periodType);\r\n\r\n            // update the payments-in chart using the value of the select Period dropdown list\r\n            utopiasoftware.ally.controller.dashboardPageViewModel.\r\n            updatePaymentInDashboard(periodType);\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for account page\r\n     */\r\n    accountPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $thisPage.get(0).onDeviceBackButton = utopiasoftware.ally.controller.accountPageViewModel.backButtonClicked;\r\n\r\n                $('#account-preloading-fab', $thisPage).css(\"display\", \"inline-block\"); // display page preloader\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.accountPageViewModel.formValidator = $('#account-page #account-form').parsley();\r\n\r\n                // listen for form field validation failure event\r\n                utopiasoftware.ally.controller.accountPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.accountPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.accountPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.accountPageViewModel.accountFormValidated);\r\n\r\n                // load the user data\r\n                utopiasoftware.ally.controller.accountPageViewModel.loadUserAccountData().\r\n                then(function(userDetails){ // save the returned user details in app cache\r\n                    return utopiasoftware.ally.saveUserAppDetails(userDetails);\r\n                }).\r\n                then(function(userDetails){ // update the page with the collect data details\r\n\r\n                    // update user data on app\r\n                    utopiasoftware.ally.model.appUserDetails = userDetails;\r\n\r\n                    $('#account-wallet-balance', $thisPage).\r\n                    html(kendo.toString(kendo.parseFloat(userDetails.balance), \"n2\"));\r\n                    $('#account-last-updated', $thisPage).\r\n                    html(kendo.toString(new Date(userDetails._lastUpdatedDate), \"MMM d yyyy, h:mmtt\"));\r\n                    $('#account-firstname', $thisPage).val(userDetails.firstname);\r\n                    $('#account-lastname', $thisPage).val(userDetails.lastname);\r\n                    $('#account-phone-number', $thisPage).val(userDetails.phone);\r\n                    $('#account-email', $thisPage).val((userDetails.email && userDetails.email != \"\") ? userDetails.email : \"\");\r\n\r\n                    // display the necessary page components\r\n                    $('#account-list', $thisPage).css(\"display\", \"block\");\r\n                    $('#account-reload-fab', $thisPage).css(\"display\", \"inline-block\");\r\n                    $('#account-edit-fab', $thisPage).css(\"display\", \"inline-block\");\r\n\r\n                    // hide necessary page components\r\n                    $('#account-save', $thisPage).css(\"display\", \"none\");\r\n                    $('#account-page-error', $thisPage).css(\"display\", \"none\");\r\n                    // hide page preloader\r\n                    $('#account-preloading-fab', $thisPage).css(\"display\", \"none\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n                }).\r\n                catch(function(){ // an error occurred when trying to load the user data\r\n\r\n                    // hide the necessary page components\r\n                    $('#account-list', $thisPage).css(\"display\", \"none\");\r\n                    $('#account-save', $thisPage).css(\"display\", \"none\");\r\n                    $('#account-edit-fab', $thisPage).css(\"display\", \"none\");\r\n\r\n                    // display necessary page components\r\n                    $('#account-page-error', $thisPage).css(\"display\", \"block\");\r\n                    $('#account-reload-fab', $thisPage).css(\"display\", \"inline-block\");\r\n\r\n                    // hide page preloader\r\n                    $('#account-preloading-fab', $thisPage).css(\"display\", \"none\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n                });\r\n\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#account-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#account-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator objects on the page\r\n                utopiasoftware.ally.controller.accountPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#account-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#account-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.accountPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // go back to previous page in the main-navigator stack\r\n            $('#app-main-navigator').get(0).popPage({});\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the Edit Account fab button is clicked\r\n         */\r\n        editAccountButtonClicked(){\r\n\r\n            // remove the the readonly attributes, so the form  elements can be editable\r\n            $('#account-page [data-ally-readonly-field]').removeAttr('readonly');\r\n            // hide the edit account button\r\n            $('#account-page #account-edit-fab').css(\"display\", \"none\");\r\n            // show the save account button\r\n            $('#account-page #account-save').css(\"display\", \"inline-block\");\r\n            // display the instruction for running the account edit\r\n            ons.notification.toast(\"you can edit your account\", {timeout:3000});\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the Refresh Account fab button is clicked\r\n         */\r\n        refreshAccountButtonClicked(){\r\n\r\n            // add the the readonly attributes, so the form  elements cannot be editable\r\n            $('#account-page [data-ally-readonly-field]').attr('readonly', true);\r\n            // hide the edit account button\r\n            $('#account-page #account-edit-fab').css(\"display\", \"none\");\r\n            // hide the save account button\r\n            $('#account-page #account-save').css(\"display\", \"none\");\r\n            // remove any tooltip being displayed on all forms on the page\r\n            $('#account-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n            $('#account-page [data-hint]').removeAttr(\"data-hint\");\r\n            // reset the form validator objects on the page\r\n            utopiasoftware.ally.controller.accountPageViewModel.formValidator.reset();\r\n\r\n            // display the page preloader\r\n            $('#account-page #account-preloading-fab').css(\"display\", \"inline-block\");\r\n\r\n            // load the user data\r\n            utopiasoftware.ally.controller.accountPageViewModel.loadUserAccountData().\r\n            then(function(userDetails){ // save the returned user details in app cache\r\n                return utopiasoftware.ally.saveUserAppDetails(userDetails);\r\n            }).\r\n            then(function(userDetails){ // update the page with the collected data details\r\n\r\n                // update user data on app\r\n                utopiasoftware.ally.model.appUserDetails = userDetails;\r\n\r\n                $('#account-page #account-wallet-balance').\r\n                html(kendo.toString(kendo.parseFloat(userDetails.balance), \"n2\"));\r\n                $('#account-page #account-last-updated').\r\n                html(kendo.toString(new Date(userDetails._lastUpdatedDate), \"MMM d yyyy, h:mmtt\"));\r\n                $('#account-page #account-firstname').val(userDetails.firstname);\r\n                $('#account-page #account-lastname').val(userDetails.lastname);\r\n                $('#account-page #account-phone-number').val(userDetails.phone);\r\n                $('#account-page #account-email').val((userDetails.email && userDetails.email != \"\") ? userDetails.email : \"\");\r\n\r\n                // display the necessary page components\r\n                $('#account-page #account-list').css(\"display\", \"block\");\r\n                $('#account-page #account-reload-fab').css(\"display\", \"inline-block\");\r\n                $('#account-page #account-edit-fab').css(\"display\", \"inline-block\");\r\n\r\n                // hide necessary page components\r\n                $('#account-page #account-save').css(\"display\", \"none\");\r\n                $('#account-page #account-page-error').css(\"display\", \"none\");\r\n                // hide page preloader\r\n                $('#account-page #account-preloading-fab').css(\"display\", \"none\");\r\n\r\n            }).\r\n            catch(function(){ // an error occurred when trying to load the user data\r\n\r\n                // hide the necessary page components\r\n                $('#account-page #account-list').css(\"display\", \"none\");\r\n                $('#account-page #account-save').css(\"display\", \"none\");\r\n                $('#account-page #account-edit-fab').css(\"display\", \"none\");\r\n\r\n                // display necessary page components\r\n                $('#account-page #account-page-error').css(\"display\", \"block\");\r\n                $('#account-page #account-reload-fab').css(\"display\", \"inline-block\");\r\n\r\n                // hide page preloader\r\n                $('#account-page #account-preloading-fab').css(\"display\", \"none\");\r\n\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the Save Account fab button is clicked\r\n         */\r\n        saveAccountButtonClicked(){\r\n\r\n            // run the validation method for the sign-in form\r\n            utopiasoftware.ally.controller.accountPageViewModel.formValidator.whenValidate();\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when form is successfully validated\r\n         */\r\n        accountFormValidated(){\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY account cannot be updated without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // ask user for secure PIN before proceeding. secure pin MUST match\r\n            ons.notification.prompt({title: '<ons-icon icon=\"ion-lock-combination\" size=\"28px\" ' +\r\n            'style=\"color: #30a401;\"></ons-icon> Security Check', id: \"pin-security-check\",\r\n                messageHTML: '<div><span>' +\r\n                'Please enter your ALLY Secure PIN to proceed</span></div>',\r\n                cancelable: true, placeholder: \"Secure PIN\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                submitOnEnter: true\r\n            }).\r\n            then(function(userInput){ // collect user secure PIN and submit the rest of the form data\r\n\r\n                // add the the readonly attributes, so the form  elements cannot be editable\r\n                $('#account-page [data-ally-readonly-field]').attr('readonly', true);\r\n                // hide the edit account button\r\n                $('#account-page #account-edit-fab').css(\"display\", \"none\");\r\n                // hide the save account button\r\n                $('#account-page #account-save').css(\"display\", \"none\");\r\n\r\n\r\n                // create the form data to be submitted\r\n                var formData = {\r\n                    firstName: $('#account-page #account-firstname').val().trim(),\r\n                    lastName: $('#account-page #account-lastname').val().trim(),\r\n                    lock: userInput,\r\n                    phone: $('#account-page #account-phone-number').val(),\r\n                    email: $('#account-page #account-email').val()\r\n                };\r\n\r\n\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Saving Account Details...\");\r\n                // forward the form data &show loader\r\n                return Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]);\r\n\r\n            }).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/update-profile.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponseText){\r\n                serverResponseText +=  \"\";\r\n                var userAcctDetails = JSON.parse(serverResponseText.trim()); // get the new user object\r\n                // add a timestamp for the last time user details was updated\r\n                userAcctDetails._lastUpdatedDate = Date.now();\r\n\r\n                // check if any error occurred\r\n                if(userAcctDetails.status == \"error\"){ // an error occured\r\n                    throw userAcctDetails.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return utopiasoftware.ally.saveUserAppDetails(userAcctDetails); // cache the returned account details\r\n            }).\r\n            then(function(userAcctDetails){\r\n               // update the user data on the app\r\n                utopiasoftware.ally.model.appUserDetails = userAcctDetails;\r\n                return userAcctDetails;\r\n            }).\r\n            then(function(){\r\n\r\n                // display the necessary page components\r\n                $('#account-page #account-list').css(\"display\", \"block\");\r\n                $('#account-page #account-reload-fab').css(\"display\", \"inline-block\");\r\n                $('#account-page #account-edit-fab').css(\"display\", \"inline-block\");\r\n\r\n                // hide necessary page components\r\n                $('#account-page #account-save').css(\"display\", \"none\");\r\n                $('#account-page #account-page-error').css(\"display\", \"none\");\r\n                // hide page preloader\r\n                $('#account-page #account-preloading-fab').css(\"display\", \"none\");\r\n\r\n                return $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n            }).\r\n            then(function(){\r\n                // populate the payments-out chart\r\n                //utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.updatePaymentOutChart('today');\r\n\r\n                // send push notification that account was updated\r\n                let pushNotification = { // create the push notification object\r\n                    \"app_id\": \"d5d2bdba-eec0-46b1-836e-c5b8e318e928\",\r\n                    \"filters\": [{\"field\": \"tag\", \"key\": \"phone\", \"relation\": \"=\", \"value\":\r\n                    utopiasoftware.ally.model.appUserDetails.phone}],\r\n                    \"contents\": {\"en\": \"Your ALLY account details were just updated\"},\r\n                    \"headings\": {\"en\": \"Account Updated\"},\r\n                    \"android_channel_id\": \"605bcdb3-611b-4aed-ba02-7e33c3d50542\",\r\n                    \"android_visibility\": 1,\r\n                    \"priority\": 10\r\n                };\r\n\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: \"https://onesignal.com/api/v1/notifications\",\r\n                        type: \"post\",\r\n                        contentType: \"application/json\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"Authorization\", \"Basic MmQ3ODcwZGUtYmIyYS00NzY5LWIwZWQtMTk5ZGRjNzU2M2Q3\");\r\n                        },\r\n                        dataType: \"json\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: false,\r\n                        data: JSON.stringify(pushNotification)\r\n                    }\r\n                ));\r\n\r\n                // display toast to user that account was updated\r\n                ons.notification.toast(\"Account Details Updated!\", {timeout:3000});\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Your account details could not be updated. Please retry\"\r\n                }\r\n\r\n                // remove the readonly attributes, so the form  elements can be editable\r\n                $('#account-page [data-ally-readonly-field]').removeAttr('readonly', true);\r\n                // hide the edit account button\r\n                $('#account-page #account-edit-fab').css(\"display\", \"none\");\r\n                // show the save account button\r\n                $('#account-page #account-save').css(\"display\", \"inline-block\");\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Account Update Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is used to load the user account data either from\r\n         * the locally cached data OR directly from the remote server\r\n         */\r\n        loadUserAccountData(){\r\n            return new Promise(function(resolve, reject){\r\n\r\n                // check if there is internet connection\r\n                if(navigator.connection.type === Connection.NONE){ // no internet connection\r\n                    // inform the user that cached data will be displayed in the absence of internet\r\n                    window.plugins.toast.showWithOptions({\r\n                        message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                        duration: 4000,\r\n                        position: \"top\",\r\n                        styling: {\r\n                            opacity: 1,\r\n                            backgroundColor: '#008000',\r\n                            textColor: '#FFFFFF',\r\n                            textSize: 14\r\n                        }\r\n                    }, function(toastEvent){\r\n                        if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                            window.plugins.toast.hide();\r\n                        }\r\n                    });\r\n                    // no internet connection, so use local cache of data\r\n                    resolve(utopiasoftware.ally.loadUserCachedAppDetails());\r\n                }\r\n                else{ // there's internet, so make request for new data\r\n\r\n                    Promise.resolve($.ajax(\r\n                        {\r\n                            url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-profile.php\",\r\n                            type: \"post\",\r\n                            contentType: \"application/x-www-form-urlencoded\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                            },\r\n                            dataType: \"text\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: true,\r\n                            data: {phone: utopiasoftware.ally.model.appUserDetails.phone} // data to submit to server\r\n                        }\r\n                    )).\r\n                    then(function(serverResponseText){\r\n                        serverResponseText +=  \"\";\r\n                        var userDetailsData = JSON.parse(serverResponseText.trim()); // get the new user object\r\n                        // add a timestamp for the last time user details was updated\r\n                        userDetailsData._lastUpdatedDate = Date.now();\r\n\r\n                        // check if any error occurred\r\n                        if(userDetailsData.status == \"error\"){ // an error occurred\r\n                            throw userDetailsData.message; // throw the error message attached to this error\r\n                        }\r\n\r\n\r\n                        resolve(userDetailsData); // return user data and resolve the Promise\r\n\r\n                    }).catch(function(err){\r\n                        reject(err); // reject the Promise error\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for wallet page\r\n     */\r\n    walletPageViewModel: {\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $thisPage.get(0).onDeviceBackButton = utopiasoftware.ally.controller.walletPageViewModel.backButtonClicked;\r\n\r\n                $('#wallet-preloading-fab', $thisPage).css(\"display\", \"inline-block\"); // display page preloader\r\n\r\n                // load the user data\r\n                utopiasoftware.ally.controller.walletPageViewModel.loadUserAccountData().\r\n                then(function(userDetails){ // save the returned user details in app cache\r\n                    return utopiasoftware.ally.saveUserAppDetails(userDetails);\r\n                }).\r\n                then(function(userDetails){ // update the page with the collect data details\r\n\r\n                    // update user data on app\r\n                    utopiasoftware.ally.model.appUserDetails = userDetails;\r\n\r\n                    $('#wallet-balance', $thisPage).\r\n                    html(kendo.toString(kendo.parseFloat(userDetails.balance), \"n2\"));\r\n\r\n                    $('#wallet-owner-name', $thisPage).html(userDetails.firstname + \" \" + userDetails.lastname);\r\n\r\n                    // display the necessary page components\r\n                    $('#wallet-list', $thisPage).css(\"display\", \"block\");\r\n                    $('#wallet-reload-fab', $thisPage).css(\"display\", \"inline-block\");\r\n\r\n                    // hide page preloader\r\n                    $('#wallet-preloading-fab', $thisPage).css(\"display\", \"none\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n                }).\r\n                catch(function(){ // an error occurred when trying to load the user data\r\n\r\n                    // display the necessary page components\r\n                    $('#wallet-list', $thisPage).css(\"display\", \"block\");\r\n\r\n                    // display necessary page components\r\n                    $('#wallet-reload-fab', $thisPage).css(\"display\", \"inline-block\");\r\n\r\n                    // hide page preloader\r\n                    $('#wallet-preloading-fab', $thisPage).css(\"display\", \"none\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n                });\r\n\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // check if the user triggered a page refresh\r\n            if($('#app-main-navigator').get(0).topPage.data.refresh !== true){ // page refresh was NOT triggered\r\n                return; // exit\r\n            }\r\n\r\n            // a page refresh was triggered, so begin refresh the wallet page content\r\n\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n\r\n            $('#wallet-preloading-fab', $thisPage).css(\"display\", \"inline-block\"); // display page preloader\r\n\r\n            // hide the necessary page components\r\n            $('#wallet-list', $thisPage).css(\"display\", \"none\");\r\n\r\n            // load the user data\r\n            utopiasoftware.ally.controller.walletPageViewModel.loadUserAccountData().\r\n            then(function(userDetails){ // save the returned user details in app cache\r\n                return utopiasoftware.ally.saveUserAppDetails(userDetails);\r\n            }).\r\n            then(function(userDetails){ // update the page with the collect data details\r\n\r\n                // update user data on app\r\n                utopiasoftware.ally.model.appUserDetails = userDetails;\r\n\r\n                $('#wallet-balance', $thisPage).\r\n                html(kendo.toString(kendo.parseFloat(userDetails.balance), \"n2\"));\r\n\r\n                $('#wallet-owner-name', $thisPage).html(userDetails.firstname + \" \" + userDetails.lastname);\r\n\r\n                // display the necessary page components\r\n                $('#wallet-list', $thisPage).css(\"display\", \"block\");\r\n                $('#wallet-reload-fab', $thisPage).css(\"display\", \"inline-block\");\r\n\r\n                // hide page preloader\r\n                $('#wallet-preloading-fab', $thisPage).css(\"display\", \"none\");\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n            }).\r\n            catch(function(){ // an error occurred when trying to load the user data\r\n\r\n                // display the necessary page components\r\n                $('#wallet-list', $thisPage).css(\"display\", \"block\");\r\n\r\n                // display necessary page components\r\n                $('#wallet-reload-fab', $thisPage).css(\"display\", \"inline-block\");\r\n\r\n                // hide page preloader\r\n                $('#wallet-preloading-fab', $thisPage).css(\"display\", \"none\");\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // check if the menu tabbar exists\r\n            if($('#menu-tabbar').get(0)){ // the menu tabbar object exists\r\n                // move to the previous tab\r\n                $('#menu-tabbar').get(0).setActiveTab(1);\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the Refresh Account fab button is clicked\r\n         */\r\n        refreshAccountButtonClicked(){\r\n\r\n            // display the page preloader\r\n            $('#wallet-page #wallet-preloading-fab').css(\"display\", \"inline-block\");\r\n\r\n            // load the user data\r\n            utopiasoftware.ally.controller.walletPageViewModel.loadUserAccountData().\r\n            then(function(userDetails){ // save the returned user details in app cache\r\n                return utopiasoftware.ally.saveUserAppDetails(userDetails);\r\n            }).\r\n            then(function(userDetails){ // update the page with the collected data details\r\n\r\n                // update user data on app\r\n                utopiasoftware.ally.model.appUserDetails = userDetails;\r\n\r\n                $('#wallet-page #wallet-balance').\r\n                html(kendo.toString(kendo.parseFloat(userDetails.balance), \"n2\"));\r\n\r\n                $('#wallet-page #wallet-owner-name').html(userDetails.firstname + \" \" + userDetails.lastname);\r\n\r\n                // display the necessary page components\r\n                $('#wallet-page #wallet-list').css(\"display\", \"block\");\r\n                $('#wallet-page #wallet-reload-fab').css(\"display\", \"inline-block\");\r\n\r\n                // hide page preloader\r\n                $('#wallet-page #wallet-preloading-fab').css(\"display\", \"none\");\r\n\r\n            }).\r\n            catch(function(){ // an error occurred when trying to load the user data\r\n\r\n                // display the necessary page components\r\n                $('#wallet-page #wallet-list').css(\"display\", \"none\");\r\n\r\n                // display necessary page components\r\n                $('#wallet-page #wallet-reload-fab').css(\"display\", \"inline-block\");\r\n\r\n                // hide page preloader\r\n                $('#wallet-page #wallet-preloading-fab').css(\"display\", \"none\");\r\n\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is used to load the user account data either from\r\n         * the locally cached data OR directly from the remote server\r\n         */\r\n        loadUserAccountData(){\r\n            return new Promise(function(resolve, reject){\r\n\r\n                // check if there is internet connection\r\n                if(navigator.connection.type === Connection.NONE){ // no internet connection\r\n                    // inform the user that cached data will be displayed in the absence of internet\r\n                    window.plugins.toast.showWithOptions({\r\n                        message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                        duration: 4000,\r\n                        position: \"top\",\r\n                        styling: {\r\n                            opacity: 1,\r\n                            backgroundColor: '#008000',\r\n                            textColor: '#FFFFFF',\r\n                            textSize: 14\r\n                        }\r\n                    }, function(toastEvent){\r\n                        if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                            window.plugins.toast.hide();\r\n                        }\r\n                    });\r\n                    // no internet connection, so use local cache of data\r\n                    resolve(utopiasoftware.ally.loadUserCachedAppDetails());\r\n                }\r\n                else{ // there's internet, so make request for new data\r\n\r\n                    Promise.resolve($.ajax(\r\n                        {\r\n                            url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-profile.php\",\r\n                            type: \"post\",\r\n                            contentType: \"application/x-www-form-urlencoded\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                            },\r\n                            dataType: \"text\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: true,\r\n                            data: {phone: utopiasoftware.ally.model.appUserDetails.phone} // data to submit to server\r\n                        }\r\n                    )).\r\n                    then(function(serverResponseText){\r\n                        serverResponseText +=  \"\";\r\n                        var userDetailsData = JSON.parse(serverResponseText.trim()); // get the new user object\r\n                        // add a timestamp for the last time user details was updated\r\n                        userDetailsData._lastUpdatedDate = Date.now();\r\n\r\n                        // check if any error occurred\r\n                        if(userDetailsData.status == \"error\"){ // an error occurred\r\n                            throw userDetailsData.message; // throw the error message attached to this error\r\n                        }\r\n\r\n\r\n                        resolve(userDetailsData); // return user data and resolve the Promise\r\n\r\n                    }).catch(function(err){\r\n                        reject(err); // reject the Promise error\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for fund-wallet page\r\n     */\r\n    fundWalletPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the Card Number DropDownList component\r\n         */\r\n        cardDropDownList: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.fundWalletPageViewModel.backButtonClicked;\r\n\r\n                // display the page preloader\r\n                $('.page-preloader', $thisPage).css('display', \"block\");\r\n\r\n                // hide the form\r\n                $('#fund-wallet-form', $thisPage).css('display', \"none\");\r\n\r\n                // initialise the card DropDown widget\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.cardDropDownList =  new ej.dropdowns.DropDownList({\r\n                    //set the data to dataSource property\r\n                    dataSource: [],\r\n                    fields: {text: 'CARDNUMBER2', value: 'CARDNUMBER2'},\r\n                    placeholder: \"Select Card\",\r\n                    floatLabelType: \"Auto\",\r\n                    popupHeight: \"300px\"\r\n                });\r\n\r\n                // render initialized card DropDownList\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.cardDropDownList.appendTo('#fund-wallet-card-number');\r\n\r\n\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formTooltip.appendTo('#fund-wallet-form');\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.amountFieldValidator =\r\n                    $('#fund-wallet-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#fund-wallet-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#fund-wallet-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator = $('#fund-wallet-form').parsley();\r\n\r\n                // attach listener for the fund wallet button on the page\r\n                $('#fund-wallet-fund-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.fundWalletPageViewModel.formValidated);\r\n\r\n\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // get the collection of stored/tokenised cards\r\n                Promise.resolve(formData).\r\n                then(function(){\r\n                    // submit the form data\r\n                    return Promise.resolve($.ajax(\r\n                        {\r\n                            url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-cards.php\",\r\n                            type: \"post\",\r\n                            contentType: \"application/x-www-form-urlencoded\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                            },\r\n                            dataType: \"text\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: true,\r\n                            data: formData // data to submit to server\r\n                        }\r\n                    ));\r\n                }).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n                    return serverResponse; // forward the server response i.e. collection of tokenised cards\r\n                }).\r\n                then(function(cardCollectionArray){\r\n\r\n                    // initialise the card DropDown widget\r\n                    utopiasoftware.ally.controller.fundWalletPageViewModel.cardDropDownList.dataSource = cardCollectionArray;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.fundWalletPageViewModel.cardDropDownList.dataBind();\r\n\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#fund-wallet-form', $thisPage).css('display', \"block\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n\r\n                }).\r\n                catch(function(){\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#fund-wallet-form', $thisPage).css('display', \"block\");\r\n\r\n                    // inform the user that they cannot proceed without Internet\r\n                    window.plugins.toast.showWithOptions({\r\n                        message: \"some content could be loaded without an Internet Connection\",\r\n                        duration: 4000,\r\n                        position: \"top\",\r\n                        styling: {\r\n                            opacity: 1,\r\n                            backgroundColor: '#ff0000', //red\r\n                            textColor: '#FFFFFF',\r\n                            textSize: 14\r\n                        }\r\n                    }, function(toastEvent){\r\n                        if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                            window.plugins.toast.hide();\r\n                        }\r\n                    });\r\n                });\r\n\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#fund-wallet-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#fund-wallet-page [title]').removeAttr(\"title\");\r\n                $('#fund-wallet-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#fund-wallet-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#fund-wallet-page [data-hint]').removeAttr(\"title\");\r\n                $('#fund-wallet-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formValidator.destroy();\r\n                // destroy other form components\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.cardDropDownList.destroy();\r\n                utopiasoftware.ally.controller.fundWalletPageViewModel.formTooltip.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY wallet cannot be funded without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                firstname: utopiasoftware.ally.model.appUserDetails.firstname,\r\n                lastname: utopiasoftware.ally.model.appUserDetails.lastname,\r\n                phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                email: utopiasoftware.ally.model.appUserDetails.email ? utopiasoftware.ally.model.appUserDetails.email : \"\",\r\n                cardno: utopiasoftware.ally.controller.fundWalletPageViewModel.cardDropDownList.value,\r\n                amount: kendo.parseFloat($('#fund-wallet-page #fund-wallet-amount').val())\r\n            };\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Funding User Wallet...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/rave-payment-using-token.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message || serverResponse.data.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(responseArray){\r\n                // ask user for transaction otp\r\n                return Promise.all([responseArray[0], ons.notification.alert({title: '<ons-icon icon=\"md-check-circle\" size=\"32px\" ' +\r\n                    'style=\"color: green;\"></ons-icon> Wallet Funded',\r\n                    messageHTML: `<span>AMOUNT CHARGED: ${kendo.toString(kendo.parseFloat(responseArray[0].data.amount), 'n2')}</span>`,\r\n                    cancelable: false\r\n                })]);\r\n            }).\r\n            then(function(){\r\n                hockeyapp.trackEvent(function(){}, function(){}, \"WALLET FUNDED\"); // track wallet funding\r\n                return Promise.all([ons.notification.toast(\"Wallet Funded Successfully!\", {timeout:4000}),\r\n                    $('#app-main-navigator').get(0).popPage({data: {refresh: true}})]);\r\n\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Your ALLY wallet could not be funded. Please retry\"\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Wallet Funding Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // remove this page form the main navigator stack\r\n            $('#app-main-navigator').get(0).popPage();\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for Add Card page\r\n     */\r\n    addCardPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to validate the card number field\r\n         */\r\n        cardNumberFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the ej library card masked text input\r\n         */\r\n        cardMaskedTextInput: null,\r\n\r\n        /**\r\n         * used to hold the ej library card month dropdown list component\r\n         */\r\n        cardMonthDropDownList: null,\r\n\r\n        /**\r\n         * used to hold the ej library card year dropdown list component\r\n         */\r\n        cardYearDropDownList: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.addCardPageViewModel.backButtonClicked;\r\n\r\n\r\n\r\n                // initialise the card masked input widget\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardMaskedTextInput =  new ej.inputs.MaskedTextBox({\r\n                    mask: '0000 0000 0000 0000 99999',\r\n                    placeholder: \"Card Number\",\r\n                    promptChar: '*',\r\n                    floatLabelType: \"Always\"\r\n                });\r\n\r\n                // render initialized card masked input widget\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardMaskedTextInput.appendTo('#add-card-card-number');\r\n\r\n                // initialise the card month DropDown widget\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardMonthDropDownList =\r\n                    new ej.dropdowns.DropDownList({\r\n                    dataSource: [{value: \"01\", displayText: \"01\"},\r\n                        {value: \"02\", displayText: \"02\"},\r\n                        {value: \"03\", displayText: \"03\"},\r\n                        {value: \"04\", displayText: \"04\"},\r\n                        {value: \"05\", displayText: \"05\"},\r\n                        {value: \"06\", displayText: \"06\"},\r\n                        {value: \"07\", displayText: \"07\"},\r\n                        {value: \"08\", displayText: \"08\"},\r\n                        {value: \"09\", displayText: \"09\"},\r\n                        {value: \"10\", displayText: \"10\"},\r\n                        {value: \"11\", displayText: \"11\"},\r\n                        {value: \"12\", displayText: \"12\"}],\r\n                        fields: {text: 'displayText', value: 'value'},\r\n                    placeholder: \"Expiry Month\",\r\n                    floatLabelType: \"Auto\"\r\n                });\r\n\r\n                // render the initialized card month dropdown list\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardMonthDropDownList.appendTo('#add-card-expiry-month');\r\n\r\n                // initialise the array to hold the valid card expiry years\r\n                var cardYearsArray = [];\r\n                var yearOption = (new Date()).getFullYear(); // get the current year\r\n                // add the current year as an object in the cardYearsArray\r\n                cardYearsArray.push({value: (\"\" + yearOption).substring(2,4), displayText: yearOption});\r\n\r\n                // add 3 more years to the cardYearsArray for the Card Expiry Year\r\n                for(var index = 0; index < 3; index++){\r\n                    // increase the yearOption by 1\r\n                    yearOption += 1;\r\n                    // add the additional year as an object in the cardYearsArray\r\n                    cardYearsArray.push({value: (\"\" + yearOption).substring(2,4), displayText: yearOption});\r\n                }\r\n\r\n                // initialise the card expiry year DropDown widget\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardYearDropDownList =\r\n                    new ej.dropdowns.DropDownList({\r\n                        dataSource: cardYearsArray,\r\n                        fields: {text: 'displayText', value: 'value'},\r\n                        placeholder: \"Expiry Year\",\r\n                        floatLabelType: \"Auto\"\r\n                    });\r\n\r\n                // render the initialized card expiry year dropdown list\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardYearDropDownList.appendTo('#add-card-expiry-year');\r\n\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formTooltip.appendTo('#add-card-form');\r\n\r\n                // initialise the card number field validator\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardNumberFieldValidator =\r\n                    $('#add-card-card-number').parsley({\r\n                        value: function(parsley) {\r\n                            // return the unmasked input from the card number field\r\n                            return utopiasoftware.ally.controller.addCardPageViewModel.cardMaskedTextInput.value;\r\n                        }\r\n                    });\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.addCardPageViewModel.amountFieldValidator =\r\n                    $('#add-card-charge-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#add-card-charge-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#add-card-charge-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formValidator = $('#add-card-form').parsley();\r\n\r\n                // attach listener for the fund wallet button on the page\r\n                $('#add-card-fund-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.addCardPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.addCardPageViewModel.formValidated);\r\n\r\n                // display the form\r\n                $('#add-card-form', $thisPage).css(\"display\", \"block\");\r\n                // hide the preloader\r\n                $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-card-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-card-page [title]').removeAttr(\"title\");\r\n                $('#add-card-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-card-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-card-page [title]').removeAttr(\"title\");\r\n                $('#add-card-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardNumberFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addCardPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formValidator.destroy();\r\n                // destroy other form components\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardMaskedTextInput.destroy();\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardMonthDropDownList.destroy();\r\n                utopiasoftware.ally.controller.addCardPageViewModel.cardYearDropDownList.destroy();\r\n                utopiasoftware.ally.controller.addCardPageViewModel.formTooltip.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY wallet cannot be saved without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                firstName: utopiasoftware.ally.model.appUserDetails.firstname,\r\n                lastName: utopiasoftware.ally.model.appUserDetails.lastname,\r\n                phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                email: utopiasoftware.ally.model.appUserDetails.email ? utopiasoftware.ally.model.appUserDetails.email : \"\",\r\n                cardno: utopiasoftware.ally.controller.addCardPageViewModel.cardMaskedTextInput.value,\r\n                cvv: $('#add-card-page #add-card-cvv').val(),\r\n                expirymonth: utopiasoftware.ally.controller.addCardPageViewModel.cardMonthDropDownList.value,\r\n                expiryyear: utopiasoftware.ally.controller.addCardPageViewModel.cardYearDropDownList.value,\r\n                pin: $('#add-card-page #add-card-pin').val(),\r\n                amount: kendo.parseFloat($('#add-card-page #add-card-charge-amount').val())\r\n            };\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Funding User Wallet...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/rave-card-payment.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message || serverResponse.data.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(responseArray){\r\n                // ask user for transaction otp\r\n                return Promise.all([responseArray[0], ons.notification.prompt({title: \"OTP Confirmation\",\r\n                    messageHTML: `<div><ons-icon icon=\"md-ally-icon-otp\" size=\"24px\"\r\n                    style=\"color: #30a401; float: left; width: 26px;\"></ons-icon>\r\n                    <span style=\"float: right; width: calc(100% - 26px);\">\r\n                    AMOUNT TO CHARGE: ${kendo.toString(kendo.parseFloat(responseArray[0].data.amount), 'n2')}<br>\r\n                    Confirm Transaction by providing OTP sent to your phone or generated by your bank token</span></div>`,\r\n                    cancelable: false, placeholder: \"OTP\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                    submitOnEnter: true\r\n                })]);\r\n            }).\r\n            then(function(responseArray){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Authorizing Wallet Fund...\");\r\n                return Promise.all([...responseArray, $('#hour-glass-loader-modal').get(0).show()])\r\n            }).\r\n            then(function(responseArray){\r\n\r\n                // create the data object to be sent\r\n                var submitData = {raverefid: responseArray[0].data.flwRef, otp: responseArray[1],\r\n                    phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n                submitData.savecard = $('#add-card-page #add-card-save-card-details').get(0).checked;\r\n\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/rave-approve-card-payment-via-otp.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: submitData // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status == \"error\"){ // an error occured\r\n                    throw serverResponse.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n            }).\r\n            then(function(){\r\n                return Promise.all([ons.notification.toast(\"Wallet Funded Successfully!\", {timeout:4000}),\r\n                    $('#app-main-navigator').get(0).popPage({data: {refresh: true}})]);\r\n\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Your ALLY wallet could not be funded. Please retry\"\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Wallet Funding Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // remove this page form the main navigator stack\r\n            $('#app-main-navigator').get(0).replacePage('fund-wallet-page.html', {animation: 'fade-md'});\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for wallet-transfer page\r\n     */\r\n    walletTransferPageViewModel: {\r\n\r\n        /**\r\n         * property is used to hold the \"Transfers Out\" Chart\r\n         */\r\n        transfersOutChart: null,\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * used to hold the transfer mode ej DropdownList component\r\n         */\r\n        transferModeDropdown: null,\r\n\r\n        /**\r\n         * used to hold the card ej DropdownList component\r\n         */\r\n        cardDropDownList: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.backButtonClicked;\r\n\r\n                // update the transfers-out chart\r\n                //utopiasoftware.ally.controller.walletTransferPageViewModel.updateTransfersOutChart('today');\r\n\r\n                // attach listen for when the 'wallet-transfer-add-recipient-button' is clicked\r\n                $('#wallet-transfer-add-recipient-button').get(0).onclick =\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.pickContactButtonClicked;\r\n\r\n                // display the page preloader\r\n                $('.page-preloader', $thisPage).css('display', \"block\");\r\n\r\n                // hide the form\r\n                $('#wallet-transfer-form', $thisPage).css('display', \"none\");\r\n\r\n                // initialise transfer mode dropdownlist\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown =\r\n                    new ej.dropdowns.DropDownList({\r\n                    placeholder: \"Select Mode\",\r\n                    floatLabelType: 'Auto',\r\n                    change: function(){ // change event handler\r\n                        // check the value of the transfer mode dropdown\r\n                        switch(utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value){\r\n                            case \"wallet transfer\": // user selected wallet transfer\r\n                                // remove the required attribute for the card number dropdown\r\n                                $('#wallet-transfer-card-number').removeAttr(\"required\");\r\n                                // so animatedly hide the card selection\r\n                                anime({targets: '#wallet-transfer-card-section', height: \"0em\", duration: 450});\r\n                                break;\r\n                            case \"card transfer\": // user selected card transfer\r\n                                // add the required attribute for the card dropdown\r\n                                $('#wallet-transfer-card-number').attr(\"required\", true);\r\n                                // so animatedly show the card selection\r\n                                anime({targets: '#wallet-transfer-card-section', height: \"3.5em\", duration: 450,\r\n                                complete: function(){$('#wallet-transfer-card-section').css(\"height\", \"auto\")}});\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.appendTo('#wallet-transfer-mode');\r\n\r\n                // initialise the card DropDown widget\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList =  new ej.dropdowns.DropDownList({\r\n                    //set the data to dataSource property\r\n                    dataSource: [],\r\n                    fields: {text: 'CARDNUMBER2', value: 'CARDNUMBER2'},\r\n                    placeholder: \"Select Card\",\r\n                    floatLabelType: \"Auto\",\r\n                    popupHeight: \"300px\"\r\n                });\r\n\r\n                // render initialized card DropDownList\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList.\r\n                appendTo('#wallet-transfer-card-number');\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formTooltip.appendTo('#wallet-transfer-form');\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.amountFieldValidator =\r\n                    $('#wallet-transfer-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#wallet-transfer-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#wallet-transfer-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator = $('#wallet-transfer-form').parsley();\r\n\r\n                // attach listener for the wallet-transfer button on the page\r\n                $('#wallet-transfer-transfer-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.formValidated);\r\n\r\n                $('#wallet-transfer-card-section').css(\"height\", \"0em\");\r\n\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // start a promise chain to setup the page\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-cards.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData // data to submit to server\r\n                    }\r\n                )).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                    // initialise the card DropDown widget\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.\r\n                        cardDropDownList.dataSource = serverResponse;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList.dataBind();\r\n                }).\r\n                then(function(){\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#wallet-transfer-form', $thisPage).css('display', \"block\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n\r\n\r\n                }).\r\n                catch(function(err){\r\n                    console.log(err);\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#wallet-transfer-form', $thisPage).css('display', \"block\");\r\n\r\n                });\r\n\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {\r\n            // check if the financial cards dropdown has been initialised\r\n            if(utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList){\r\n                // repopulate the financial cards dropdown list\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // start a promise chain to setup the page\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-cards.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData // data to submit to server\r\n                    }\r\n                )).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                    // initialise the card DropDown widget\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.\r\n                        cardDropDownList.dataSource = serverResponse;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList.dataBind();\r\n                }).catch(function(){});\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#wallet-transfer-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#wallet-transfer-page [title]').removeAttr(\"title\");\r\n                $('#wallet-transfer-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.reset();\r\n\r\n                // reset the transfer mode dropdown to the default value\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value = \"wallet transfer\";\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.dataBind();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#wallet-transfer-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#wallet-transfer-page [data-hint]').removeAttr(\"title\");\r\n                $('#wallet-transfer-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * update the wallet transfer-in chart. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updateTransfersOutChart: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers Out (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers Out (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Transfers Out (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the walletOutgoing Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.walletTransferPageViewModel.transfersOutChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transfersOutChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#wallet-transfer-page #wallet-transfer-transfers-out-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Wallet Transfers Out\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadWalletTransferOutData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.transfersOutChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#30A401\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Time (GMT +1)',\r\n                                valueType: 'DateTime',\r\n                                labelFormat: chartCustomisableSettings.labelFormat,\r\n                                intervalType: chartCustomisableSettings.intervalType,\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount in thousands (N)',\r\n                                valueType: 'Double',\r\n                                labelFormat: '{value}k',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 2,\r\n                                marker: {visible: true, width: 8, height:8},\r\n                                xName: 'DDATE', yName: 'AMOUNT',\r\n                                name: 'Outgoing Transfers',\r\n                                //Series type as line\r\n                                type: 'Line'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#wallet-transfer-page #wallet-transfer-transfers-out-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.transfersOutChart.\r\n                    appendTo('#wallet-transfer-transfers-out-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet transfer-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/chart-transfer-out.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone, duration: periodType} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadWalletTransferOutData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.dashboardCharts.saveWalletTransferOutData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transfersOutChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#30A401\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Time (GMT +1)',\r\n                            valueType: 'DateTime',\r\n                            labelFormat: chartCustomisableSettings.labelFormat,\r\n                            intervalType: chartCustomisableSettings.intervalType,\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount in thousands (N)',\r\n                            valueType: 'Double',\r\n                            labelFormat: '{value}k',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 2,\r\n                            marker: {visible: true, width: 8, height:8},\r\n                            xName: 'DDATE', yName: 'AMOUNT',\r\n                            name: 'Outgoing Transfers',\r\n                            //Series type as line\r\n                            type: 'Line'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#wallet-transfer-page #wallet-transfer-transfers-out-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.walletTransferPageViewModel.transfersOutChart.\r\n                appendTo('#wallet-transfer-transfers-out-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = (kendo.parseFloat(dataObject.AMOUNT)) / 1000; // divide amount by 1000\r\n                    dataObject.DDATE = kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY wallet transfer cannot be performed without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                phone_sender: utopiasoftware.ally.model.appUserDetails.phone,\r\n                phone_receiver: $('#wallet-transfer-page #wallet-transfer-receiver-phone-number').val(),\r\n                amount: kendo.parseFloat($('#wallet-transfer-page #wallet-transfer-amount').val())\r\n            };\r\n\r\n            // check if the phone_receiver parameter is properly formatted for sending\r\n            if(formData.phone_receiver.startsWith(\"0\")){ // the phone number starts with 0, replace it with international dialing code\r\n                formData.phone_receiver = formData.phone_receiver.replace(\"0\", \"+234\");\r\n            }\r\n\r\n            // check the transfer mode for the wallet transfer\r\n            if(utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value == \"wallet transfer\"){\r\n                // add the specified transfer mode to the form data\r\n                formData.transfer_mode = \"wallet transfer\";\r\n            }\r\n            // check the transfer mode for the wallet transfer\r\n            if(utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value == \"card transfer\"){\r\n                // add the specified transfer mode and card number to the form data\r\n                formData.transfer_mode = \"card transfer\";\r\n                formData.cardno = utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList.value;\r\n            }\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Completing Wallet Transfer...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/transfer-wallet-to-wallet.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message || serverResponse.data.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(responseArray){\r\n                // ask user for transaction otp\r\n                return Promise.all([responseArray[0], ons.notification.prompt({title: \"ALLY Secure PIN Confirmation\",\r\n                    id: 'pin-security-check2',\r\n                    messageHTML: `<div><ons-icon icon=\"ion-lock-combination\" size=\"24px\"\r\n                    style=\"color: #30a401; float: left; width: 26px;\"></ons-icon>\r\n                    <span style=\"float: right; width: calc(100% - 26px);\">\r\n                    ${responseArray[0].fullname.length > 1 ?\r\n                        'RECIPIENT: ' +  responseArray[0].fullname + '<br>' :  ''}\r\n                    TRANSFER FEE: ${kendo.toString(kendo.parseFloat(responseArray[0].appfee), 'n2')}<br>\r\n                    AMOUNT TO CHARGE: ${kendo.toString(kendo.parseFloat(responseArray[0].total), 'n2')}<br>\r\n                    Confirm wallet transfer by providing your ALLY Secure PIN</span></div>`,\r\n                    cancelable: false, placeholder: \"Secure PIN\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                    submitOnEnter: true\r\n                })]);\r\n            }).\r\n            then(function(responseArray){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Authorizing Wallet Transfer...\");\r\n                return Promise.all([...responseArray, $('#hour-glass-loader-modal').get(0).show()])\r\n            }).\r\n            then(function(responseArray){\r\n                // create the data to be sent for confirm of wallet transfer\r\n                var confirmationData = responseArray[0];\r\n                confirmationData.lock = responseArray[1];\r\n                confirmationData.cardno = utopiasoftware.ally.controller.walletTransferPageViewModel.cardDropDownList.value;\r\n                confirmationData.transfer_mode = formData.transfer_mode;\r\n\r\n                // submit the data\r\n                return Promise.all([Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/transfer-wallet-to-wallet-confirm.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: confirmationData // data to submit to server\r\n                    }\r\n                )), responseArray[0]]);\r\n            }).\r\n            then(function(serverResponse){ // NOTE: serverResponse is an array\r\n                serverResponse[0] = JSON.parse((serverResponse[0] +\"\").trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse[0].status == \"error\"){ // an error occured\r\n                    throw serverResponse[0].message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the serverResponse i.e the user details object\r\n            }).\r\n            then(function(responseDetailsArray){ // the parameter contains 2 items. item 1 - userDetails; item 2- details of the wallet transfer\r\n                // forward details of the wallet-transfer; also save the user details to encrypted storage;\r\n               return Promise.all([responseDetailsArray[1], utopiasoftware.ally.saveUserAppDetails(responseDetailsArray[0])]);\r\n            }).\r\n            then(function(dataArray){\r\n                // update local copy of user app details\r\n                utopiasoftware.ally.model.appUserDetails = dataArray[1];\r\n                // update the transfers-out chart\r\n                //utopiasoftware.ally.controller.walletTransferPageViewModel.updateTransfersOutChart('today');\r\n                // reset the page scroll position to the top\r\n                $('#wallet-transfer-page .page__content').scrollTop(0);\r\n                // forward details of the wallet-transfer and the user details\r\n                return Promise.all([...dataArray, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(dataArray){\r\n                // check if the recipient of the wallet transfer is a registered user\r\n                if(dataArray[0].isregistereduser != \"yes\") {\r\n                    // append the json details for the wallet-transfer to the wallet-transfer-sms-confirm-modal confirmation button\r\n                    $($('#wallet-transfer-sms-confirm-modal #wallet-transfer-sms-confirm-button').get(0)).\r\n                    attr(\"data-wallet-transfer\", JSON.stringify(dataArray[0]));\r\n                    // show the wallet-transfer-sms-confirm-modal to the user\r\n                    return $('#wallet-transfer-sms-confirm-modal').get(0).show();\r\n                }\r\n                else{ // recipient is registered\r\n                    return \"registered recipient\";\r\n                }\r\n            }).\r\n            then(function(result){\r\n                if(result === \"registered recipient\"){ // the recipient of the wallet transfer is already registered\r\n\r\n                    hockeyapp.trackEvent(function(){}, function(){}, \"FUND TRANSFERRED\"); // track fund transfer\r\n\r\n                    // reset the form for the wallet transfer page\r\n                    $('#wallet-transfer-page #wallet-transfer-form').get(0).reset();\r\n                    // reset the form validator object on the page\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.reset();\r\n\r\n                    // reset the transfer mode dropdown to the default value\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value = \"wallet transfer\";\r\n                    utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.dataBind();\r\n\r\n                    // send push notification to the recipient of the transfer\r\n                    let pushNotification = { // create the push notification object\r\n                        \"app_id\": \"d5d2bdba-eec0-46b1-836e-c5b8e318e928\",\r\n                        \"filters\": [{\"field\": \"tag\", \"key\": \"phone\", \"relation\": \"=\", \"value\":\r\n                        formData.phone_receiver}],\r\n                        \"contents\": {\"en\": \"You received funds into your ALLY WALLET from \" +\r\n                        utopiasoftware.ally.model.appUserDetails.firstname + \" \" + utopiasoftware.ally.model.appUserDetails.lastname},\r\n                        \"headings\": {\"en\": \"Funds Received\"},\r\n                        \"android_channel_id\": \"66dfeddf-12d7-4194-b3d9-38325042d258\",\r\n                        \"android_visibility\": 0,\r\n                        \"priority\": 5\r\n                    };\r\n\r\n                    Promise.resolve($.ajax(\r\n                        {\r\n                            url: \"https://onesignal.com/api/v1/notifications\",\r\n                            type: \"post\",\r\n                            contentType: \"application/json\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"Authorization\", \"Basic MmQ3ODcwZGUtYmIyYS00NzY5LWIwZWQtMTk5ZGRjNzU2M2Q3\");\r\n                            },\r\n                            dataType: \"json\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: false,\r\n                            data: JSON.stringify(pushNotification)\r\n                        }\r\n                    ));\r\n\r\n                    return Promise.all([ons.notification.toast(\"Wallet Transfer Successful!\", {timeout:4000})]); // conclude wallet transfer process\r\n                }\r\n\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Your ALLY wallet transfer could not be completed. Please retry\"\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Wallet Transfer Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // check if the menu tabbar exists\r\n            if($('#menu-tabbar').get(0)){ // the menu tabbar object exists\r\n                // move to the previous tab\r\n                $('#menu-tabbar').get(0).setActiveTab(2);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the 'Pick Contact\" button is clicked\r\n         */\r\n        pickContactButtonClicked: function(){\r\n\r\n            // display the list of contacts from the user's phone address book\r\n            new Promise(function(resolve, reject){\r\n                window.plugins.contactNumberPicker.pick(resolve, reject);\r\n            }).\r\n            then(function(contact){ // retrieve picked contact\r\n\r\n                // get the selected contact phone number\r\n                var contactPhoneNumber = contact.phoneNumber;\r\n\r\n                //format the retrieved phone number to acceptable app standards\r\n                contactPhoneNumber = contactPhoneNumber.replace(/\\D/ig, \"\"); // remove any non-digit character between phone numbers\r\n                // if any number brings with '0' replace it with '+234'\r\n                if(contactPhoneNumber.startsWith(\"0\")){ // the phone number starts with 0, replace it with international dialing code\r\n                    contactPhoneNumber = contactPhoneNumber.replace(\"0\", \"+234\");\r\n                }\r\n                //ensure phone number begins with a '+'\r\n                if(!contactPhoneNumber.startsWith(\"+\")){ // the phone number does not start with '+'\r\n                    contactPhoneNumber = \"+\" + contactPhoneNumber; // append the '+' to the beginning\r\n                }\r\n\r\n                // update the recipient phone input field with the retrieved & formatted phone number\r\n                $('#wallet-transfer-form #wallet-transfer-receiver-phone-number').val(contactPhoneNumber);\r\n            }).\r\n            catch(function(){\r\n\r\n                // inform the user that there was an error\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"phone contacts could not be accessed right now\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the \"Add Card\" button is clicked\r\n         */\r\n        addCardButtonClicked: function(){\r\n\r\n            // generate the formData that will be passed over to the \"Add Card (Wallet Transfer) page\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                phone_sender: utopiasoftware.ally.model.appUserDetails.phone,\r\n                phone_receiver: $('#wallet-transfer-page #wallet-transfer-receiver-phone-number').val(),\r\n                amount: kendo.parseFloat($('#wallet-transfer-page #wallet-transfer-amount').val())\r\n            };\r\n\r\n            // check if the phone_receiver parameter is properly formatted for sending\r\n            if(formData.phone_receiver.startsWith(\"0\")){ // the phone number starts with 0, replace it with international dialing code\r\n                formData.phone_receiver = formData.phone_receiver.replace(\"0\", \"+234\");\r\n            }\r\n\r\n            // check the transfer mode for the wallet transfer\r\n            if(utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value == \"wallet transfer\"){\r\n                // add the specified transfer mode to the form data\r\n                formData.transfer_mode = \"wallet transfer\";\r\n            }\r\n            // check the transfer mode for the wallet transfer\r\n            if(utopiasoftware.ally.controller.walletTransferPageViewModel.transferModeDropdown.value == \"card transfer\"){\r\n                // add the specified transfer mode to the form data\r\n                formData.transfer_mode = \"card transfer\";\r\n            }\r\n\r\n            // display the \"Add Card (Wallet Transfer)\" page\r\n            $('#app-main-navigator').get(0).pushPage('add-card-wallet-transfer-page.html',\r\n                {data: formData, animation: 'lift-md'});\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the 'Confirm' button on the transfer wallet sms confirmation message is clicked\r\n         *\r\n         * @param buttonElem\r\n         * @returns {Promise}\r\n         */\r\n        walletTransferSmsConfirmButtonClicked: function(buttonElem){\r\n\r\n            hockeyapp.trackEvent(function(){}, function(){}, \"FUND TRANSFERRED\"); // track fund transfer\r\n\r\n            // get the details of the wall transfer for which an sms confirmation is being sent\r\n            var walletTransferDetails = JSON.parse($(buttonElem).attr('data-wallet-transfer'));\r\n\r\n            // use a promise to send the sms confirmation message to the recipient\r\n            new Promise(function(resolve, reject){\r\n                // send sms\r\n                SMS.sendSMS(walletTransferDetails.receiver, \"Hello, I just sent N\" +\r\n                    walletTransferDetails.amount + \" to your ALLY wallet. Download ALLY using this link \" +\r\n                    \"and your phone number to receive your funds\\r\\n\" +\r\n                    utopiasoftware.ally.model.ally_app_share_link, resolve, reject);\r\n            });\r\n\r\n            // hide the sms confirmation modal\r\n            $('#wallet-transfer-sms-confirm-modal').get(0).hide();\r\n\r\n            // reset the form for the wallet transfer page\r\n            $('#wallet-transfer-page #wallet-transfer-form').get(0).reset();\r\n            // reset the form validator object on the page\r\n            utopiasoftware.ally.controller.walletTransferPageViewModel.formValidator.reset();\r\n\r\n            return Promise.all([ons.notification.toast(\"Wallet Transfer Successful!\", {timeout:4000})]); // conclude wallet transfer process\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for disburse-wallet page\r\n     */\r\n    disburseWalletPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the Account Number ComboBox component\r\n         */\r\n        accountNumberComboBox: null,\r\n\r\n        /**\r\n         * used to hold the Banks DropDownList component\r\n         */\r\n        banksDropDownList: null,\r\n\r\n        /**\r\n         ** used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.backButtonClicked;\r\n\r\n                // display the page preloader\r\n                $('.page-preloader', $thisPage).css('display', \"block\");\r\n\r\n                // hide the form\r\n                $('#disburse-wallet-form', $thisPage).css('display', \"none\");\r\n\r\n                // initialise the bank DropDown widget\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList =  new ej.dropdowns.DropDownList({\r\n                    //set the data to dataSource property\r\n                    dataSource: [],\r\n                    fields: {text: 'name', value: 'code'},\r\n                    sortOrder: \"Ascending\",\r\n                    enabled: true,\r\n                    placeholder: \"Select Bank\",\r\n                    floatLabelType: \"Auto\",\r\n                    popupHeight: \"300px\"\r\n                });\r\n\r\n                // render initialised bank dropdown list\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.\r\n                banksDropDownList.appendTo('#disburse-wallet-bank');\r\n\r\n                // initialise the account number combo box widget\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.accountNumberComboBox =\r\n                 new ej.dropdowns.ComboBox({\r\n                 //set the data to dataSource property\r\n                 dataSource: [],\r\n                 fields: {text: 'displayText', value: 'ACCOUNTNUMBER'},\r\n                 placeholder: \"Account Name or Number (NUBAN)\",\r\n                 floatLabelType: \"Auto\",\r\n                 popupHeight: \"300px\",\r\n                 allowCustom: true\r\n                 });\r\n\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.\r\n                accountNumberComboBox.appendTo('#disburse-wallet-account-number');\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formTooltip.appendTo('#disburse-wallet-form');\r\n\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.amountFieldValidator =\r\n                    $('#disburse-wallet-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#disburse-wallet-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#disburse-wallet-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator = $('#disburse-wallet-form').parsley();\r\n\r\n                // attach listener for the disburse wallet button on the page\r\n                $('#disburse-wallet-disburse-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidated);\r\n\r\n\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // get the collection of stored bank accounts and bank names\r\n                Promise.resolve(formData).\r\n                then(function(){\r\n                    // submit the form data\r\n                    return Promise.resolve($.ajax(\r\n                        {\r\n                            url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-bank-accounts.php\",\r\n                            type: \"post\",\r\n                            contentType: \"application/x-www-form-urlencoded\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                            },\r\n                            dataType: \"text\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: true,\r\n                            data: formData // data to submit to server\r\n                        }\r\n                    ));\r\n                }).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object (i.e. array of bank account objects)\r\n                    serverResponse.forEach(function(acctObject){  // add an additional property to each object\r\n                        // this property is displayed to the user\r\n                        acctObject.displayText = acctObject.RECIPIENTNAME + \" - \" + acctObject.ACCOUNTNUMBER;\r\n                    });\r\n\r\n                    return Promise.all([serverResponse,\r\n                    utopiasoftware.ally.banksData()]); // forward the server response i.e. collection of bank accounts (and the list of banks)\r\n                }).\r\n                then(function(promiseArray){ // this array contains the list of user bank accounts AND the list of banks in nigeria\r\n\r\n                    //populate data fir the bank dropdown list\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.dataSource =\r\n                        promiseArray[1];\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.dataBind();\r\n\r\n                    // populate data for the account combo box\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.accountNumberComboBox.dataSource =\r\n                        promiseArray[0];\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.accountNumberComboBox.dataBind();\r\n\r\n                    // add the change event listener to listen for changes in the bank account number combo box\r\n                    utopiasoftware.ally.controller.disburseWalletPageViewModel.\r\n                    accountNumberComboBox.addEventListener(\"change\", function(){\r\n                        var accountObj = this.getDataByValue(this.value); // get the object that matches the selected value\r\n                        if(accountObj){\r\n                            // update the bank selection dropdown\r\n                            utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.value =\r\n                                accountObj[\"BANKCODE\"];\r\n                            utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.enabled = false;\r\n                            // update the account nickname input\r\n                            $('#disburse-wallet-page #disburse-wallet-account-name').val(accountObj.RECIPIENTNAME);\r\n                            $('#disburse-wallet-page #disburse-wallet-account-name').attr(\"readonly\", true);\r\n                        }\r\n                        else{\r\n                            // update the bank selection dropdown\r\n                            utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.enabled = true;\r\n                            utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.value = null;\r\n                            utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.text = null;\r\n                            // update the account nickname input\r\n                            $('#disburse-wallet-page #disburse-wallet-account-name').val(\"\");\r\n                            $('#disburse-wallet-page #disburse-wallet-account-name').removeAttr(\"readonly\");\r\n                        }\r\n                        // update the bank selection dropdown\r\n                        utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.dataBind();\r\n                    });\r\n\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#disburse-wallet-form', $thisPage).css('display', \"block\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n\r\n                }).\r\n                catch(function(err){\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#disburse-wallet-form', $thisPage).css('display', \"block\");\r\n\r\n                    // inform the user that they cannot proceed without Internet\r\n                    window.plugins.toast.showWithOptions({\r\n                        message: \"some content could be loaded without an Internet Connection\",\r\n                        duration: 4000,\r\n                        position: \"top\",\r\n                        styling: {\r\n                            opacity: 1,\r\n                            backgroundColor: '#ff0000', //red\r\n                            textColor: '#FFFFFF',\r\n                            textSize: 14\r\n                        }\r\n                    }, function(toastEvent){\r\n                        if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                            window.plugins.toast.hide();\r\n                        }\r\n                    });\r\n                });\r\n\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#disburse-wallet-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#disburse-wallet-page [title]').removeAttr(\"title\");\r\n                $('#disburse-wallet-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#disburse-wallet-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#disburse-wallet-page [data-hint]').removeAttr(\"title\");\r\n                $('#disburse-wallet-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formValidator.destroy();\r\n                // destroy other form components\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.accountNumberComboBox.destroy();\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.destroy();\r\n                utopiasoftware.ally.controller.disburseWalletPageViewModel.formTooltip.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY wallet disbursal cannot be performed without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                amount: kendo.parseFloat($('#disburse-wallet-page #disburse-wallet-amount').val()),\r\n                phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                accountno: utopiasoftware.ally.controller.disburseWalletPageViewModel.\r\n                accountNumberComboBox.text.substring(utopiasoftware.ally.controller.disburseWalletPageViewModel.\r\n                    accountNumberComboBox.text.length - 10, utopiasoftware.ally.controller.disburseWalletPageViewModel.\r\n                    accountNumberComboBox.text.length),\r\n                bankcode: utopiasoftware.ally.controller.disburseWalletPageViewModel.banksDropDownList.value\r\n            };\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Completing Wallet Disbursal...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/transfer-wallet-to-account.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message || serverResponse.data.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(responseArray){\r\n                // ask user for transaction otp\r\n                return Promise.all([responseArray[0], ons.notification.prompt({title: \"ALLY Secure PIN Confirmation\",\r\n                    id: 'pin-security-check2',\r\n                    messageHTML: `<div><ons-icon icon=\"ion-lock-combination\" size=\"24px\"\r\n                    style=\"color: #30a401; float: left; width: 26px;\"></ons-icon>\r\n                    <span style=\"float: right; width: calc(100% - 26px);\">\r\n                    ${responseArray[0].accountno.length > 1 ?\r\n                    'ACCOUNT: ' +  responseArray[0].accountno + '<br>' :  ''}\r\n                    TRANSFER FEE: ${kendo.toString(kendo.parseFloat(responseArray[0].appfee), 'n2')}<br>\r\n                    AMOUNT TO CHARGE: ${kendo.toString(kendo.parseFloat(responseArray[0].total), 'n2')}<br>\r\n                    Confirm wallet disbursal by providing your ALLY Secure PIN</span></div>`,\r\n                    cancelable: false, placeholder: \"Secure PIN\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                    submitOnEnter: true\r\n                })]);\r\n            }).\r\n            then(function(responseArray){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Authorizing Wallet Disbursal...\");\r\n                return Promise.all([...responseArray, $('#hour-glass-loader-modal').get(0).show()])\r\n            }).\r\n            then(function(responseArray){\r\n                // create the data to be sent for confirm of wallet transfer\r\n                var confirmationData = responseArray[0];\r\n                confirmationData.lock = responseArray[1];\r\n                confirmationData.saveaccount = $('#disburse-wallet-page #disburse-wallet-save-account-details').get(0).checked;\r\n                confirmationData.recipientnickname = $('#disburse-wallet-page #disburse-wallet-account-name').val();\r\n\r\n                // submit the data\r\n                return Promise.all([Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/transfer-wallet-to-account-confirm.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: confirmationData // data to submit to server\r\n                    }\r\n                )), responseArray[0]]);\r\n            }).\r\n            then(function(serverResponse){ // NOTE: serverResponse is an array\r\n                serverResponse[0] = JSON.parse((serverResponse[0] +\"\").trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse[0].status == \"error\"){ // an error occured\r\n                    throw serverResponse.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the serverResponse i.e the user details object\r\n            }).\r\n            then(function(responseDetailsArray){ // the parameter contains 2 items. item 1 - userDetails; item 2- details of the wallet disbursal\r\n                // forward details of the wallet-disbursal; also save the user details to encrypted storage;\r\n                return Promise.all([responseDetailsArray[1], utopiasoftware.ally.saveUserAppDetails(responseDetailsArray[0])]);\r\n            }).\r\n            then(function(dataArray){\r\n                // update local copy of user app details\r\n                utopiasoftware.ally.model.appUserDetails = dataArray[1];\r\n                // forward details of the wallet-transfer and the user details\r\n                return Promise.all([$('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(){\r\n\r\n                hockeyapp.trackEvent(function(){}, function(){}, \"WALLET DISBURSED\"); // track wallet disbursement\r\n                return Promise.all([ons.notification.toast(\"Wallet Disbursal Successful!\", {timeout:4000}),\r\n                $('#app-main-navigator').get(0).popPage({data: {refresh: true}})]); // conclude wallet disbursal process\r\n\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Your ALLY wallet disbursal could not be completed. Please retry\"\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Wallet Disbursal Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // remove this page form the main navigator stack\r\n            $('#app-main-navigator').get(0).popPage();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for payments page\r\n     */\r\n    paymentsPageViewModel: {\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $thisPage.get(0).onDeviceBackButton = utopiasoftware.ally.controller.paymentsPageViewModel.backButtonClicked;\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // get the payments tab hidden object\r\n            var paymentsButtonSegment = $('#payments-page #payments-tabbar').get(0);\r\n\r\n            // check which button in the button segment is active\r\n            if(paymentsButtonSegment.getActiveTabIndex() == 0){ // the 1st hidden tab is active\r\n\r\n                // check if there is an active payment is ongoing\r\n                if(utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.activePayment === true){ // there is an active payment\r\n                    // caution tohe user about leaving the page when an active payment is ongoing\r\n                    ons.notification.confirm({title: '<ons-icon icon=\"md-alert-triangle\" size=\"36px\" ' +\r\n                    'style=\"color: orange;\"></ons-icon> Cancel Payment',\r\n                        messageHTML: '<span>Merchant payment is in progress. <br>' +\r\n                        'If you leave, all information on payment will be lost.<br>' +\r\n                        'Do you want to leave?</span>',\r\n                        cancelable: false,\r\n                        buttonLabels: [\"No\", \"Yes\"]\r\n                    }).\r\n                    then(function(buttonIndex){ // check which button was selected\r\n                        if(buttonIndex === 0){ // user chose not to leave the page\r\n                            return; // exit\r\n                        }\r\n\r\n                        // user chose to leave, so call the hide method for the currently active page\r\n                        utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.pageHide();\r\n                        // move to the previous tab in the menu-tabbar\r\n                        $('#menu-tabbar').get(0).setActiveTab(0);\r\n\r\n                    }).catch();\r\n                }\r\n                else{ // there is no active payment\r\n\r\n                    // call the hide method for the currently active page\r\n                    utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.pageHide();\r\n\r\n                    // move to the previous tab in the menu-tabbar\r\n                    $('#menu-tabbar').get(0).setActiveTab(0);\r\n                }\r\n\r\n                return; // exit\r\n            }\r\n\r\n            if(paymentsButtonSegment.getActiveTabIndex() == 1){ // the 2nd hidden tab is active\r\n\r\n                // check if there is an active payment is ongoing\r\n                if(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment === true){ // there is an active payment\r\n                    // caution tohe user about leaving the page when an active payment is ongoing\r\n                    ons.notification.confirm({title: '<ons-icon icon=\"md-alert-triangle\" size=\"36px\" ' +\r\n                    'style=\"color: orange;\"></ons-icon> Cancel Payment',\r\n                        messageHTML: '<span>Merchant payment is in progress. <br>' +\r\n                        'If you leave, all information on payment will be lost.<br>' +\r\n                        'Do you want to leave?</span>',\r\n                        cancelable: false,\r\n                        buttonLabels: [\"No\", \"Yes\"]\r\n                    }).\r\n                    then(function(buttonIndex){ // check which button was selected\r\n                        if(buttonIndex === 0){ // user chose not to leave the page\r\n                            return; // exit\r\n                        }\r\n\r\n                        // user chose to leave, so call the hide method for the currently active page\r\n                        utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.pageHide();\r\n                        paymentsButtonSegment.setActiveTab(0); // move to the 1st hidden tab\r\n\r\n                    }).catch();\r\n                }\r\n                else{ // there is no active payment\r\n\r\n                    // call the hide method for the currently active page\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.pageHide();\r\n\r\n                    paymentsButtonSegment.setActiveTab(0); // move to the 1st button's page\r\n                }\r\n\r\n                return; // exit\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * object is view-model for payments-ally-scan page\r\n     */\r\n    paymentsAllyScanPageViewModel: {\r\n\r\n        /**\r\n         * property is used to hold the \"Payments Out\" Chart\r\n         */\r\n        paymentsOutChart: null,\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        //amountFieldValidator: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * property is used to track whether there is an active ongoing payment.\r\n         * A value of true means there is an active payment; any other value means there is none\r\n         */\r\n        activePayment: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // initialise the 'active payment' status to false i.e. no active payment\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.activePayment = false;\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formTooltip.appendTo('#payments-ally-scan-form');\r\n\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator = $('#payments-ally-scan-form').parsley();\r\n\r\n                // attach listener for the FIND button on the page\r\n                $('#payments-ally-scan-find-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // attach listener for the payments-ally-scan-modal back buttons\r\n                $('#payments-ally-scan-modal').get(0).onDeviceBackButton =\r\n                    $('#payments-ally-scan-modal-back-button').get(0).onclick =\r\n                        function(){\r\n\r\n                            // hide the payments-ally-scan-modal\r\n                            $('#payments-ally-scan-modal').get(0).hide();\r\n\r\n                            // call the hide method for the currently active page\r\n                            utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.pageHide();\r\n                        };\r\n\r\n                // populate the payments-out chart\r\n                //utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.updatePaymentOutChart('today');\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.findButtonClicked);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n\r\n\r\n                // flag that no active payment is taking place\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.activePayment = false;\r\n\r\n                // remove the transparency from the webpage\r\n                $('html, body').removeClass('ally-transparent');\r\n                $('#payments-page').removeClass('transparent');\r\n                $('#payments-ally-scan-page').removeClass('transparent');\r\n\r\n\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#payments-ally-scan-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#payments-ally-scan-page [title]').removeAttr(\"title\");\r\n                $('#payments-ally-scan-page [data-hint]').removeAttr(\"data-hint\");\r\n\r\n                // reset the form\r\n                $('#payments-ally-scan-page #payments-ally-scan-form').get(0).reset();\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.reset();\r\n                $('#payments-ally-scan-page #payments-ally-scan-find-button').css(\"transform\", \"scale(1)\");\r\n\r\n                // reset the page scroll position to the top\r\n                $('#payments-ally-scan-page .page__content').scrollTop(0);\r\n\r\n                // disable the webview transparency\r\n                QRScanner.hide(function(status){\r\n                    QRScanner.resumePreview(function(){});\r\n                });\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n\r\n                // flag that no active payment is taking place\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.activePayment = false;\r\n\r\n                // remove the transparency from the webpage\r\n                $('html, body').removeClass('ally-transparent');\r\n                $('#payments-page').removeClass('transparent');\r\n                $('#payments-ally-scan-page').removeClass('transparent');\r\n\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#payments-ally-scan-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#payments-ally-scan-page [title]').removeAttr(\"title\");\r\n                $('#payments-ally-scan-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.destroy();\r\n\r\n\r\n                // destroy the current state of the QR Scanner &disable the webview transparency\r\n                QRScanner.destroy(function(status){\r\n\r\n                });\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * update the wallet payment-out chart. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         */\r\n        updatePaymentOutChart: function(periodType){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments Out (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments Out (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Wallet Payments Out (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the payments out Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.paymentsOutChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.paymentsOutChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#payments-ally-scan-page #payments-ally-scan-payments-out-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Wallet Payments Out\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.dashboardCharts.loadPaymentOutData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.paymentsOutChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#30A401\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Time (GMT +1)',\r\n                                valueType: 'DateTime',\r\n                                labelFormat: chartCustomisableSettings.labelFormat,\r\n                                intervalType: chartCustomisableSettings.intervalType,\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount in thousands (N)',\r\n                                valueType: 'Double',\r\n                                labelFormat: '{value}k',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                }\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 2,\r\n                                marker: {visible: true, width: 8, height:8},\r\n                                xName: 'DDATE', yName: 'AMOUNT',\r\n                                name: 'Outgoing Payments',\r\n                                //Series type as line\r\n                                type: 'Area'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#payments-ally-scan-page #payments-ally-scan-payments-out-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.paymentsOutChart.\r\n                    appendTo('#payments-ally-scan-payments-out-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet payments-out data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/chart-payment-out.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone, duration: periodType} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.dashboardCharts.loadPaymentOutData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.dashboardCharts.savePaymentOutData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.paymentsOutChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#30A401\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Time (GMT +1)',\r\n                            valueType: 'DateTime',\r\n                            labelFormat: chartCustomisableSettings.labelFormat,\r\n                            intervalType: chartCustomisableSettings.intervalType,\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount in thousands (N)',\r\n                            valueType: 'Double',\r\n                            labelFormat: '{value}k',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            }\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 2,\r\n                            marker: {visible: true, width: 8, height:8},\r\n                            xName: 'DDATE', yName: 'AMOUNT',\r\n                            name: 'Outgoing Payments',\r\n                            //Series type as line\r\n                            type: 'Area'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#payments-ally-scan-page #payments-ally-scan-payments-out-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.paymentsOutChart.\r\n                appendTo('#payments-ally-scan-payments-out-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate form that can be displayed by the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = (kendo.parseFloat(dataObject.AMOUNT)) / 1000; // divide amount by 1000\r\n                    dataObject.DDATE = kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the SCAN button is clicked\r\n         */\r\n        scanButtonClicked: async function(){\r\n\r\n            var permissionStatuses = null; // holds the permission statuses for the permissions requested\r\n\r\n            permissionStatuses =  await new Promise(function(resolve, reject){\r\n                cordova.plugins.diagnostic.requestRuntimePermissions(resolve, reject,[\r\n                    cordova.plugins.diagnostic.permission.CAMERA\r\n                ]);\r\n            });\r\n\r\n            // remove any tooltip being displayed on all forms on the page\r\n            $('#payments-ally-scan-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n            $('#payments-ally-scan-page [title]').removeAttr(\"title\");\r\n            $('#payments-ally-scan-page [data-hint]').removeAttr(\"data-hint\");\r\n            // reset the form validator object on the page\r\n            utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.reset();\r\n            // reset the form\r\n            $('#payments-ally-scan-page #payments-ally-scan-form').get(0).reset();\r\n\r\n            // make page transparent in preparation for QR code scanning\r\n            $('html, body').addClass('ally-transparent');\r\n            $('#payments-page').addClass('transparent');\r\n            $('#payments-ally-scan-page').addClass('transparent');\r\n\r\n            // start video display\r\n            QRScanner.resumePreview(function(status){\r\n\r\n                // show the payment-ally-scan-modal\r\n                $('#payments-ally-scan-modal').get(0).show();\r\n\r\n                QRScanner.show(function(status){ // make webview transparent\r\n                    QRScanner.scan(function(err,qrCode){ // begin scanning QR code\r\n\r\n                        if(err || !permissionStatuses ||\r\n                            permissionStatuses[cordova.plugins.diagnostic.permission.CAMERA] !==\r\n                            cordova.plugins.diagnostic.permissionStatus.GRANTED){ // an error occurred, so inform the user\r\n                            // ALSO check if the the requested runtime permissions were granted without errors\r\n\r\n                            // remove page transparency\r\n                            $('html, body').removeClass('ally-transparent');\r\n                            $('#payments-page').removeClass('transparent');\r\n                            $('#payments-ally-scan-page').removeClass('transparent');\r\n\r\n                            // hide the payment-ally-scan-modal\r\n                            $('#payments-ally-scan-modal').get(0).hide();\r\n\r\n                            // inform the user of the error\r\n                            ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                            'style=\"color: red;\"></ons-icon> ALLY Payment Error',\r\n                                messageHTML: '<span>' + 'Sorry, Merchant QR Code could not be scanned.<br> ' +\r\n                                'You can try again OR type in Merchant Code directly' + '</span>',\r\n                                cancelable: false\r\n                            });\r\n\r\n                            // flag that no active payment is taking place\r\n                            utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.activePayment = false;\r\n\r\n                            return; // exit after handling error\r\n                        } // end of error section\r\n\r\n                        // if code gets to this section below, then there was no error\r\n\r\n                        // flag that an active payment is taking place\r\n                        utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.activePayment = true;\r\n                        // flag that an active payment is taking place\r\n                        utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment = true;\r\n\r\n                        // pause the video preview\r\n                        QRScanner.pausePreview(function(status){\r\n                            // get each content of the QR Code\r\n                            var qrCodeSegmentsArray = (qrCode + \"\").trim().split(\"|\");\r\n                            // update the contents of the payment form with the qrCodeSegmentsArray\r\n                            $('#payments-ally-direct-page #payments-ally-direct-merchant-name').val(qrCodeSegmentsArray[0]);\r\n                            $('#payments-ally-direct-page #payments-ally-direct-merchant-code').val(qrCodeSegmentsArray[1]);\r\n                            $('#payments-ally-direct-page #payments-ally-direct-merchant-phone').val(qrCodeSegmentsArray[2]);\r\n\r\n                            // wait for some time before proceeding to payment\r\n                            window.setTimeout(function(){\r\n\r\n                                // remove page transparency\r\n                                $('html, body').removeClass('ally-transparent');\r\n                                $('#payments-page').removeClass('transparent');\r\n                                $('#payments-ally-scan-page').removeClass('transparent');\r\n\r\n                                // reset the form validator object on the page\r\n                                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formValidator.reset();\r\n                                // reset the form\r\n                                $('#payments-ally-scan-page #payments-ally-scan-form').get(0).reset();\r\n\r\n                                // hide the payment-ally-scan-modal\r\n                                $('#payments-ally-scan-modal').get(0).hide();\r\n                                // proceed to payment\r\n                                $('#payments-page #payments-tabbar').get(0).setActiveTab(1);\r\n                            }, 1000);\r\n\r\n\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the FIND button is clicked\r\n         */\r\n        findButtonClicked: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"merchant details cannot be found without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Finding Merchant Details...\");\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                merchantcode: $('#payments-ally-scan-page #payments-ally-scan-merchant-code').val().trim()\r\n            };\r\n\r\n            Promise.all([formData, $('#hour-glass-loader-modal').get(0).show()]).\r\n            then(function(promiseDataArray){\r\n\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/pay-merchant-normal.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: promiseDataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse = JSON.parse((serverResponse +\"\").trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status == \"error\"){ // an error occured\r\n                    throw serverResponse.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the serverResponse i.e the user details object\r\n            }).\r\n            then(function(serverResponse){\r\n                // update the payment form with the data retrieved\r\n                $('#payments-ally-direct-page #payments-ally-direct-merchant-code').val(serverResponse.usercode);\r\n                $('#payments-ally-direct-page #payments-ally-direct-merchant-phone').val(serverResponse.phone);\r\n                $('#payments-ally-direct-page #payments-ally-direct-merchant-name').val(serverResponse.merchantname);\r\n\r\n                // flag that merchant payment is active\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment = true;\r\n                // call the page pageHide method for this currently active page\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.pageHide();\r\n\r\n                // proceed to payment section\r\n                return $('#payments-page #payments-tabbar').get(0).setActiveTab(1);\r\n            }).\r\n            then(function(){\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = 'Sorry, merchant details could not be retrieved.<br> ' +\r\n                        'You can try again OR use ALLY Scan as an alternative';\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> ALLY Payment Error',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for payments-ally-direct page\r\n     */\r\n    paymentsAllyDirectPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * property is used to track whether there is an active ongoing payment.\r\n         * A value of true means there is an active payment; any other value means there is none\r\n         */\r\n        activePayment: null,\r\n\r\n        /**\r\n         * property is used to hold the payment mode dropdown list\r\n         */\r\n        paymentModeDropdown: null,\r\n\r\n        /**\r\n         * property is used to hold the Cards dropdown list\r\n         */\r\n        cardDropDownList: null,\r\n\r\n        /**\r\n         * property is used to hold the ej Grid component for payment receipts\r\n         */\r\n        merchantPaymentReceiptGrid: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // initialise the 'active payment' status to false i.e. no active payment\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment = false;\r\n\r\n                // inject the the modules required to create the merchant payment receipt grid\r\n                ej.grids.Grid.Inject(ej.grids.Page, ej.grids.Selection, ej.grids.Scroll, ej.grids.Search, ej.grids.Toolbar, ej.grids.PdfExport,\r\n                    ej.grids.ExcelExport);\r\n\r\n                // initialise payment mode dropdownlist\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown =\r\n                    new ej.dropdowns.DropDownList({\r\n                        placeholder: \"Select Mode\",\r\n                        floatLabelType: 'Auto',\r\n                        change: function(){ // change event handler\r\n                            // check the value of the payment mode dropdown\r\n                            switch(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value){\r\n                                case \"wallet payment\": // user selected wallet payment\r\n                                    // remove the required attribute for the card number dropdown\r\n                                    $('#payments-ally-direct-card-number').removeAttr(\"required\");\r\n                                    // so animatedly hide the card selection\r\n                                    anime({targets: '#payments-ally-direct-card-section', height: \"0em\", duration: 450});\r\n                                    break;\r\n                                case \"card payment\": // user selected card payment\r\n                                    // add the required attribute for the card dropdown\r\n                                    $('#payments-ally-direct-card-number').attr(\"required\", true);\r\n                                    // so animatedly show the card selection\r\n                                    anime({targets: '#payments-ally-direct-card-section', height: \"3.5em\", duration: 450,\r\n                                        complete: function(){$('#payments-ally-direct-card-section').css(\"height\", \"auto\")}});\r\n                                    break;\r\n                            }\r\n                        }\r\n                    });\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.\r\n                appendTo('#payments-ally-direct-payment-mode');\r\n\r\n                // initialise the card DropDown widget\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.cardDropDownList =  new ej.dropdowns.DropDownList({\r\n                    //set the data to dataSource property\r\n                    dataSource: [],\r\n                    fields: {text: 'CARDNUMBER2', value: 'CARDNUMBER2'},\r\n                    placeholder: \"Select Card\",\r\n                    floatLabelType: \"Auto\",\r\n                    popupHeight: \"300px\"\r\n                });\r\n\r\n                // render initialized card DropDownList\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.cardDropDownList.\r\n                appendTo('#payments-ally-direct-card-number');\r\n\r\n                // initialise the ej Grid used for displaying payment receipts\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid =\r\n                    new ej.grids.Grid({\r\n                        // Width for grid\r\n                        width: '100%',\r\n                        allowTextWrap: true,\r\n                        allowPdfExport: true,\r\n                        toolbar: ['pdfexport'],\r\n                        columns: [\r\n                            { field: 'paymentReceiptDesc', headerText: ' ', width: \"50%\", clipMode: 'ellipsiswithtooltip',\r\n                                customAttributes: {\r\n                                    class: 'payment-receipt-item-desc'\r\n                                }},\r\n                            { field: 'paymentReceiptValue', headerText: ' ', width: \"50%\", clipMode: 'ellipsiswithtooltip' }\r\n                        ],\r\n                        dataSource: [],\r\n                        pdfExportComplete: function(pdfExportCompleteArgs){\r\n                            console.log(\"ARGUMENTS\", pdfExportCompleteArgs);\r\n                            var fileObj = null; // variable holds the file object to be created\r\n                            var pdfExportBlob = null; // holds the blob for the pdf content being exported\r\n\r\n                            // get the blob data when the export process is completed\r\n                            pdfExportCompleteArgs.promise.then(function(pdfData){ // get the pdf structure if the content being exported\r\n                                pdfExportBlob = pdfData.blobData; // get the blob for the exported pdf\r\n                                console.log(\"EXPORTED\", pdfData);\r\n\r\n                                return new Promise(function(resolve, reject){ // return the directory where to store the document/image\r\n                                    window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, resolve, reject);\r\n                                });\r\n                            }).then(function(directory){\r\n                                return new Promise(function(resolve, reject){ // return the created file which holds the pdf document\r\n                                    directory.getFile('ALLY-Receipt-' + Date.now() + '.pdf', {create:true, exclusive: false},\r\n                                        resolve, reject);\r\n                                });\r\n                            }).\r\n                            then(function(file){ // get the file object\r\n                                fileObj = file; // assign the file object to the function variable\r\n\r\n                                return new Promise(function(resolve, reject){ // return the FileWriter object used to write content to the created file\r\n                                    file.createWriter(resolve, reject);\r\n                                });\r\n                            }).\r\n                            then(function(fileWriter){ // get the FileWriter object\r\n                                return new Promise(function(resolve, reject){\r\n                                    fileWriter.onwriteend = resolve;\r\n                                    fileWriter.onerror = reject;\r\n\r\n                                    fileWriter.write(pdfExportBlob); // write the content of the blob to the file\r\n                                });\r\n                            }).then(function(){ // notify that export completed\r\n                                window.plugins.toast.showWithOptions({\r\n                                    message: \"Receipt Saved to Root Folder!\",\r\n                                    duration: 4000,\r\n                                    position: \"bottom\",\r\n                                    styling: {\r\n                                        opacity: 1,\r\n                                        backgroundColor: '#008000',\r\n                                        textColor: '#FFFFFF',\r\n                                        textSize: 14\r\n                                    }\r\n                                }, function(toastEvent){\r\n                                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                                        window.plugins.toast.hide();\r\n                                    }\r\n                                });\r\n\r\n                            }).\r\n                            catch(function(err){console.log(\"EXPORT FAILED\", err)});\r\n                        }\r\n                    });\r\n\r\n                //append the newly created grid\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.\r\n                appendTo('#merchant-payment-receipt-grid');\r\n\r\n                // append the listener for the toolbar 'Export PDF' button click\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.\r\n                    toolbarClick = function (args) {\r\n                    console.log(\"ID \", args.item.id);\r\n                    if (args.item.id === 'merchant-payment-receipt-grid_pdfexport') { // the toolbar button being clicked is the 'PDF Export'\r\n                        utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.\r\n                        pdfExport({\r\n                            pageOrientation: 'landscape',\r\n                            includeHiddenColumn: true,\r\n                            pageSize: 'a4',\r\n                            header: {\r\n                                fromTop: 0,\r\n                                height: 130,\r\n                                contents: [\r\n                                    {\r\n                                        type: 'text',\r\n                                        value: \"ALLY Payment Receipt\",\r\n                                        position: { x: 60, y: 50 },\r\n                                        style: { textBrushColor: '#30a401', fontSize: 14, hAlign: 'center', bold: true}\r\n                                    }\r\n\r\n                                ]\r\n                            }\r\n                        }, null, null, true);\r\n\r\n                    }\r\n                };\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.paymentsAllyScanPageViewModel.formTooltip.appendTo('#payments-ally-direct-form');\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.amountFieldValidator =\r\n                    $('#payments-ally-direct-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#payments-ally-direct-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#payments-ally-direct-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator = $('#payments-ally-direct-form').parsley();\r\n\r\n                // attach listener for the pay button on the page\r\n                $('#payments-ally-direct-pay-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidated);\r\n\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // start a promise chain to setup the page\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-cards.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData // data to submit to server\r\n                    }\r\n                )).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                    // initialise the card DropDown widget\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.\r\n                        cardDropDownList.dataSource = serverResponse;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.cardDropDownList.dataBind();\r\n                }).\r\n                then(function(){\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#payments-ally-direct-form', $thisPage).css('display', \"block\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n\r\n\r\n                }).\r\n                catch(function(err){\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#payments-ally-direct-form', $thisPage).css('display', \"block\");\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n                });\r\n\r\n            };\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {\r\n\r\n            // check if the financial cards dropdown has been initialised\r\n            if(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.cardDropDownList){\r\n                // if yes, repopulate the dropdown with the updated lists of cards\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // start a promise chain to setup the page\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-cards.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData // data to submit to server\r\n                    }\r\n                )).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                    // initialise the card DropDown widget\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.\r\n                        cardDropDownList.dataSource = serverResponse;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.cardDropDownList.dataBind();\r\n                }).\r\n                catch(function(){});\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n\r\n                // flag that no active payment is taking place\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment = false;\r\n\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#payments-ally-direct-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#payments-ally-direct-page [title]').removeAttr(\"title\");\r\n                $('#payments-ally-direct-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.reset();\r\n                // reset the form\r\n                $('#payments-ally-direct-page #payments-ally-direct-form').get(0).reset();\r\n                $('#payments-ally-direct-page #payments-ally-direct-add-card').css(\"transform\", \"scale(1)\");\r\n\r\n                // reset the payment mode dropdown to the default value\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value = \"wallet payment\";\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.dataBind();\r\n\r\n                // reset the page scroll position to the top\r\n                $('#payments-ally-direct-page .page__content').scrollTop(0);\r\n\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n\r\n                // flag that no active payment is taking place\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment = false;\r\n\r\n                // remove the transparency from the webpage\r\n                $('html, body').removeClass('ally-transparent');\r\n                $('#payments-page').removeClass('transparent');\r\n                $('#payments-ally-direct-page').removeClass('transparent');\r\n\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#payments-ally-direct-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#payments-ally-direct-page [title]').removeAttr(\"title\");\r\n                $('#payments-ally-direct-page [data-hint]').removeAttr(\"data-hint\");\r\n\r\n                $('#payments-ally-direct-page #payments-ally-direct-add-card').css(\"transform\", \"scale(1)\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.destroy();\r\n\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"merchant payment cannot be made without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                phone_sender: utopiasoftware.ally.model.appUserDetails.phone,\r\n                phone_receiver: $('#payments-ally-direct-page #payments-ally-direct-merchant-phone').val(),\r\n                merchantcode: $('#payments-ally-direct-page #payments-ally-direct-merchant-code').val(),\r\n                amount: kendo.parseFloat($('#payments-ally-direct-page #payments-ally-direct-amount').val()),\r\n                merchantname: $('#payments-ally-direct-page #payments-ally-direct-merchant-name').val()\r\n            };\r\n\r\n            // check the transfer mode for the merchant payment\r\n            if(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value == \"wallet payment\"){\r\n                // add the specified payment mode to the form data\r\n                formData.payment_mode = \"wallet payment\";\r\n            }\r\n            // check the transfer mode for the merchant payment\r\n            if(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value == \"card payment\"){\r\n                // add the specified card mode and card number to the form data\r\n                formData.payment_mode = \"card payment\";\r\n                formData.cardno = utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.cardDropDownList.value;\r\n            }\r\n\r\n            ons.notification.prompt({title: \"ALLY Secure PIN Confirmation\",\r\n                id: 'pin-security-check2',\r\n                messageHTML: `<div><ons-icon icon=\"ion-lock-combination\" size=\"24px\"\r\n                    style=\"color: #30a401; float: left; width: 26px;\"></ons-icon>\r\n                    <span style=\"float: right; width: calc(100% - 26px);\">\r\n                    Confirm merchant payment by providing your ALLY Secure PIN</span></div>`,\r\n                cancelable: false, placeholder: \"Secure PIN\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                submitOnEnter: true\r\n            }).\r\n            then(function(userInput){ // get the user input\r\n\r\n                // update the form data to be submitted\r\n                formData.lock = userInput; // add the user secure pin\r\n\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Authorizing Merchant Payment...\");\r\n\r\n                return Promise.all([formData, $('#hour-glass-loader-modal').get(0).show()]); // forward the data to be submitted\r\n            }).\r\n            then(function(promiseDataArray){\r\n\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/pay-merchant-normal-confirm.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: promiseDataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse = JSON.parse((serverResponse +\"\").trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse[0].status == \"error\"){ // an error occured\r\n                    throw serverResponse[0].message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the serverResponse i.e the array containing user details & receipt objects\r\n            }).\r\n            then(function(responseDetailsArray){\r\n                // forward details of the save the user details to encrypted storage; also forward details of payment\r\n                return Promise.all([utopiasoftware.ally.saveUserAppDetails(responseDetailsArray[0]),\r\n                    responseDetailsArray[1]]);\r\n            }).\r\n            then(function(dataArray){\r\n                // update local copy of user app details\r\n                utopiasoftware.ally.model.appUserDetails = dataArray[0];\r\n\r\n                // flag that no active payment is taking place\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.activePayment = false;\r\n\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#payments-ally-direct-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#payments-ally-direct-page [title]').removeAttr(\"title\");\r\n                $('#payments-ally-direct-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.formValidator.reset();\r\n                // reset the form\r\n                $('#payments-ally-direct-page #payments-ally-direct-form').get(0).reset();\r\n\r\n                // reset the payment mode dropdown to the default value\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value = \"wallet payment\";\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.dataBind();\r\n\r\n                // reset the page scroll position to the top\r\n                $('#payments-ally-direct-page .page__content').scrollTop(0);\r\n\r\n                // serialize the receipt data & bind it to the receipt grid component in preparation for user display\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.dataSource =\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.serializeReceiptData(dataArray[1]);\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.dataBind();\r\n\r\n\r\n                // send push notification to the recipient of the transfer\r\n                let pushNotification = { // create the push notification object\r\n                    \"app_id\": \"d5d2bdba-eec0-46b1-836e-c5b8e318e928\",\r\n                    \"filters\": [{\"field\": \"tag\", \"key\": \"phone\", \"relation\": \"=\", \"value\":\r\n                    formData.phone_receiver}],\r\n                    \"contents\": {\"en\": \"You received payment into your ALLY WALLET from \" +\r\n                    utopiasoftware.ally.model.appUserDetails.firstname + \" \" + utopiasoftware.ally.model.appUserDetails.lastname},\r\n                    \"headings\": {\"en\": \"Payment Received\"},\r\n                    \"android_channel_id\": \"81baf9bc-d068-4f4c-9bae-1a3dc8488491\",\r\n                    \"android_visibility\": 0,\r\n                    \"priority\": 5\r\n                };\r\n\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: \"https://onesignal.com/api/v1/notifications\",\r\n                        type: \"post\",\r\n                        contentType: \"application/json\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"Authorization\", \"Basic MmQ3ODcwZGUtYmIyYS00NzY5LWIwZWQtMTk5ZGRjNzU2M2Q3\");\r\n                        },\r\n                        dataType: \"json\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: false,\r\n                        data: JSON.stringify(pushNotification)\r\n                    }\r\n                ));\r\n\r\n                hockeyapp.trackEvent(function(){}, function(){}, \"MERCHANT PAYMENT\"); // track merchant payments\r\n\r\n                // forward details of the wallet-transfer and the user details\r\n                return Promise.all([$('#hour-glass-loader-modal').get(0).hide(),\r\n                    $('#payments-page #payments-tabbar').get(0).setActiveTab(0),\r\n                    ons.notification.toast(\"Merchant Payment Successful!\", {timeout:4000}),\r\n                    $('#merchant-payment-receipt-modal').get(0).show()]);\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = 'Sorry, merchant payment could not be made.<br> ' +\r\n                        'You can try again OR scan the QR Code to pay merchant';\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> ALLY Payment Error',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the \"Add Card\" button is clicked\r\n         */\r\n        addCardButtonClicked: function(){\r\n\r\n            // generate the formData that will be passed over to the \"Add Card (Merchant Payment) page\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                phone_sender: utopiasoftware.ally.model.appUserDetails.phone,\r\n                phone_receiver: $('#payments-ally-direct-page #payments-ally-direct-merchant-phone').val(),\r\n                merchantcode: $('#payments-ally-direct-page #payments-ally-direct-merchant-code').val(),\r\n                amount: kendo.parseFloat($('#payments-ally-direct-page #payments-ally-direct-amount').val()),\r\n                merchantname: $('#payments-ally-direct-page #payments-ally-direct-merchant-name').val()\r\n            };\r\n\r\n\r\n            // check the payment mode for the merchant payment\r\n            if(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value == \"wallet transfer\"){\r\n                // add the specified payment mode to the form data\r\n                formData.payment_mode = \"wallet payment\";\r\n            }\r\n            // check the payment mode for the merchant payment\r\n            if(utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.paymentModeDropdown.value == \"card transfer\"){\r\n                // add the specified payment mode to the form data\r\n                formData.payment_mode = \"card payment\";\r\n            }\r\n\r\n            // display the \"Add Card (Merchant Payment)\" page\r\n            $('#app-main-navigator').get(0).pushPage('add-card-merchant-payment-page.html',\r\n                {data: formData, animation: 'lift-md'});\r\n        },\r\n\r\n\r\n        /**\r\n         *\r\n         * @param receiptObj {Object} a single receipt object to be serialized into objects within an array\r\n         * @returns {Array} the array containing componets of the receipt object to\r\n         * be displayed in the Grid component\r\n         */\r\n        serializeReceiptData: function(receiptObj){\r\n            var receiptItemsArray = [];\r\n            // create the receipt items array\r\n            receiptItemsArray.push({paymentReceiptDesc: 'Payment Reference', paymentReceiptValue: receiptObj.refid},\r\n                {paymentReceiptDesc: 'Payment Date', paymentReceiptValue: receiptObj.date},\r\n                {paymentReceiptDesc: 'Transaction Type', paymentReceiptValue: \"Merchant Payment\"},\r\n                {paymentReceiptDesc: 'Payment From',\r\n                    paymentReceiptValue: utopiasoftware.ally.model.appUserDetails.firstname + \" \" +\r\n                    utopiasoftware.ally.model.appUserDetails.lastname},\r\n                {paymentReceiptDesc: 'Payment To', paymentReceiptValue: receiptObj.merchantname},\r\n                {paymentReceiptDesc: 'Amount Paid', paymentReceiptValue: receiptObj.amount});\r\n\r\n            return receiptItemsArray; // return the receipt array\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for change-pin page\r\n     */\r\n    changePinPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.changePinPageViewModel.backButtonClicked;\r\n\r\n                // initialise the create-account form validation\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator = $('#change-pin-form').parsley();\r\n\r\n                // attach listener for the change pin button on the page\r\n                $('#change-pin-change-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.changePinPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for form field validation failure event\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.changePinPageViewModel.formValidated);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#change-pin-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#change-pin-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#change-pin-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#change-pin-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when sign-up form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY secure PIN cannot be changed without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                lock: $('#change-pin-page #change-pin-old').val(),\r\n                newlock: $('#change-pin-page #change-pin-new').val(),\r\n                phone: utopiasoftware.ally.model.appUserDetails.phone\r\n            };\r\n\r\n\r\n            // inform the user that their current pin is being changed\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Changing Secure PIN...\");\r\n\r\n            Promise.resolve($('#hour-glass-loader-modal').get(0).show()).\r\n            then(function(){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/change-pin.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status == \"error\"){ // an error occurred\r\n                    throw serverResponse.message; // throw the error message attached to this error\r\n                }\r\n\r\n                // store the updated secure pin\r\n                utopiasoftware.ally.model.appSecurePin = formData.newlock;\r\n            }).\r\n            then(function(){\r\n                // create a cypher data of the user secure pin\r\n                return Promise.all([\r\n                    Promise.resolve(intel.security.secureData.\r\n                    createFromData({\"data\": formData.newlock}))]);\r\n            }).\r\n            then(function(instanceIdArray){\r\n                // store the cyphered data & secure pin in secure persistent storage\r\n                return Promise.all([\r\n                    Promise.resolve(\r\n                        intel.security.secureStorage.write({\"id\": \"ally-user-secure-pin\", \"instanceID\": instanceIdArray[0]}))\r\n                ]);\r\n            }).\r\n            then(function(){\r\n\r\n                // reset the form\r\n                $('#change-pin-page #change-pin-form').get(0).reset();\r\n                utopiasoftware.ally.controller.changePinPageViewModel.formValidator.reset();\r\n                return $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n            }).\r\n            then(function(){\r\n\r\n                // send push notification that account was updated\r\n                let pushNotification = { // create the push notification object\r\n                    \"app_id\": \"d5d2bdba-eec0-46b1-836e-c5b8e318e928\",\r\n                    \"filters\": [{\"field\": \"tag\", \"key\": \"phone\", \"relation\": \"=\", \"value\":\r\n                    utopiasoftware.ally.model.appUserDetails.phone}],\r\n                    \"contents\": {\"en\": \"Your ALLY secure PIN has just been changed\"},\r\n                    \"headings\": {\"en\": \"ALLY PIN Changed\"},\r\n                    \"android_channel_id\": \"9fd6b6ae-9937-476f-8ae9-7e9958763532\",\r\n                    \"android_visibility\": 1,\r\n                    \"priority\": 10\r\n                };\r\n\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: \"https://onesignal.com/api/v1/notifications\",\r\n                        type: \"post\",\r\n                        contentType: \"application/json\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"Authorization\", \"Basic MmQ3ODcwZGUtYmIyYS00NzY5LWIwZWQtMTk5ZGRjNzU2M2Q3\");\r\n                        },\r\n                        dataType: \"json\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: false,\r\n                        data: JSON.stringify(pushNotification)\r\n                    }\r\n                ));\r\n\r\n                // inform user that PIN has been changed\r\n                ons.notification.toast(\"PIN changed successfully\", {timeout:3000});\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry, your Secure PIN could not be changed\"\r\n                }\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> PIN Change Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the PIN visibility button is clicked.\r\n         * It toggles pin visibility\r\n         *\r\n         * @param buttonElement\r\n         * @param inputFieldId\r\n         */\r\n        pinVisibilityButtonClicked: function(buttonElement, inputFieldId){\r\n            if($(buttonElement).attr(\"data-ally-visible\") === \"no\"){ // pin is not visible, make it visible\r\n                $(`#${inputFieldId} input`).css(\"-webkit-text-security\", \"none\"); // change the text-security for the input field\r\n                $(buttonElement).find('ons-icon').attr(\"icon\", \"md-eye-off\"); // change the icon associated with the input\r\n                $(buttonElement).attr(\"data-ally-visible\", \"yes\"); // flag the pin is now visible\r\n            }\r\n            else{ // make the pin not visible\r\n                $(`#${inputFieldId} input`).css(\"-webkit-text-security\", \"disc\"); // change the text-security for the input field\r\n                $(buttonElement).find('ons-icon').attr(\"icon\", \"md-eye\"); // change the icon associated with the input\r\n                $(buttonElement).attr(\"data-ally-visible\", \"no\"); // flag the pin is now invisible\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // go back to previous page in the main-navigator stack\r\n            $('#app-main-navigator').get(0).popPage({});\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for transaction history page\r\n     */\r\n    transactionHistoryPageViewModel: {\r\n\r\n        /**\r\n         * property is used to hold the \"Transaction History\" Grid\r\n         */\r\n        transactionHistoryGrid: null,\r\n\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.transactionHistoryPageViewModel.backButtonClicked;\r\n\r\n                // inject the the modules required to create the transaction history grid\r\n                ej.grids.Grid.Inject(ej.grids.Page, ej.grids.Selection, ej.grids.Scroll, ej.grids.Search, ej.grids.Toolbar, ej.grids.PdfExport,\r\n                ej.grids.ExcelExport);\r\n\r\n                // update the Transaction History Grid\r\n                utopiasoftware.ally.controller.transactionHistoryPageViewModel.updateTransactionHistoryGrid();\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n            // destroy the transaction history grid\r\n            utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.destroy();\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // go back to previous page in the main-navigator stack\r\n            $('#app-main-navigator').get(0).popPage({});\r\n        },\r\n\r\n\r\n\r\n        /**\r\n         * update the transaction history grid. Either using cached data or remote data\r\n         *\r\n         */\r\n        updateTransactionHistoryGrid: function(){\r\n\r\n            var pdfExportBlob = null; // holds the blob for the pdf content being exported\r\n\r\n            // check if the Transaction History Grid has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid){ // grid has previously been created\r\n                // destroy the grid object\r\n                utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.destroy();\r\n            }\r\n\r\n            // display grid loading indicator\r\n            $('#transaction-history-page #transaction-history-transaction-grid').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                    ALLY Transaction History\r\n                </div>\r\n                <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                    <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                    </ons-icon>\r\n                </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.transactionHistoryCharts.loadTransactionHistoryData().\r\n                then(function(dataArray){ // get the data array to be used by grid\r\n                    // format the data array so it can be properly used\r\n                    return gridDataMapping(dataArray);\r\n                }).\r\n                then(function(dataArray){\r\n                    utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid =\r\n                        new ej.grids.Grid({\r\n                            // Width for grid\r\n                            width: '100%',\r\n                            allowTextWrap: true,\r\n                            showColumnChooser: true,\r\n                            allowPdfExport: true,\r\n                            toolbar: ['search', 'columnchooser', 'pdfexport'],\r\n                            columns: [\r\n                                { field: 'SENDER', headerText: 'Sender', width: \"25%\", clipMode: 'ellipsiswithtooltip' },\r\n                                { field: 'RECEIVER', headerText: 'Recipient', width: \"25%\", clipMode: 'ellipsiswithtooltip' },\r\n                                { field: 'AMOUNT', headerText: 'Amount', width: \"25%\", textAlign: 'right',\r\n                                    clipMode: 'ellipsiswithtooltip'},\r\n                                { field: 'DDATE', headerText: 'Date', width: \"25%\",\r\n                                    clipMode: 'ellipsiswithtooltip'},\r\n                                { field: 'TRANSFERTYPE', headerText: 'Type', width: \"25%\",\r\n                                    clipMode: 'ellipsiswithtooltip', visible: false},\r\n                                { field: 'TRANSACTIONREF', headerText: 'Ref', width: \"25%\", clipMode: 'ellipsiswithtooltip',\r\n                                    visible: false}\r\n                            ],\r\n                            dataSource: dataArray,\r\n                            pdfExportComplete: async function(pdfExportCompleteArgs){\r\n                                console.log(\"ARGUMENTS\", pdfExportCompleteArgs);\r\n                                var fileObj = null; // variable holds the file object to be created\r\n\r\n                                var permissionStatuses = null; // holds the statuses of the runtime permissions requested\r\n\r\n                                // request runtime permissions to write pdf file to device\r\n                                permissionStatuses =  await new Promise(function(resolve, reject){\r\n                                    cordova.plugins.diagnostic.requestRuntimePermissions(resolve, reject,[\r\n                                        cordova.plugins.diagnostic.permission.WRITE_EXTERNAL_STORAGE,\r\n                                        cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE\r\n                                    ]);\r\n                                });\r\n\r\n                                // get the blob data when the export process is completed\r\n                                pdfExportCompleteArgs.promise.then(function(pdfData){ // get the pdf structure if the content being exported\r\n                                    pdfExportBlob = pdfData.blobData; // get the blob for the exported pdf\r\n\r\n                                    // check if the user has given permission to write pdf file to device\r\n                                    if(!permissionStatuses ||\r\n                                        permissionStatuses[cordova.plugins.diagnostic.permission.WRITE_EXTERNAL_STORAGE] !==\r\n                                        cordova.plugins.diagnostic.permissionStatus.GRANTED ||\r\n                                        permissionStatuses[cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE] !==\r\n                                        cordova.plugins.diagnostic.permissionStatus.GRANTED){\r\n                                        throw \"error\";\r\n                                    }\r\n\r\n                                    return new Promise(function(resolve, reject){ // return the directory where to store the document/image\r\n                                        window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, resolve, reject);\r\n                                    });\r\n                                }).then(function(directory){\r\n                                    return new Promise(function(resolve, reject){ // return the created file which holds the pdf document\r\n                                        directory.getFile('ALLY-Transactions-' + Date.now() + '.pdf', {create:true, exclusive: false},\r\n                                            resolve, reject);\r\n                                    });\r\n                                }).\r\n                                then(function(file){ // get the file object\r\n                                    fileObj = file; // assign the file object to the function variable\r\n\r\n                                    return new Promise(function(resolve, reject){ // return the FileWriter object used to write content to the created file\r\n                                        file.createWriter(resolve, reject);\r\n                                    });\r\n                                }).\r\n                                then(function(fileWriter){ // get the FileWriter object\r\n                                    return new Promise(function(resolve, reject){\r\n                                        fileWriter.onwriteend = resolve;\r\n                                        fileWriter.onerror = reject;\r\n\r\n                                        fileWriter.write(pdfExportBlob); // write the content of the blob to the file\r\n                                    });\r\n                                }).then(function(){ // notify that export completed\r\n                                    ons.notification.toast(\"PDF Exported to Root Folder!\", {timeout:4000});\r\n                                }).\r\n                                catch(function(err){console.log(\"EXPORT FAILED\", err)});\r\n                            }\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#transaction-history-page #transaction-history-transaction-grid').html(\"\");\r\n                    //append the newly created grid\r\n                    utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.\r\n                    appendTo('#transaction-history-transaction-grid');\r\n\r\n                    // append the listener for the toolbar 'Export PDF' button click\r\n                    utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.\r\n                        toolbarClick = function (args) {\r\n                        console.log(\"ID \", args.item.id);\r\n                        if (args.item.id === 'transaction-history-transaction-grid_pdfexport') { // the toolbar button being clicked is the 'PDF Export'\r\n                            console.log(\"DATASOURCE \", utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.dataSource);\r\n                            utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.\r\n                            pdfExport({\r\n                                pageOrientation: 'landscape',\r\n                                includeHiddenColumn: true,\r\n                                pageSize: 'a4',\r\n                                header: {\r\n                                    fromTop: 0,\r\n                                    height: 130,\r\n                                    contents: [\r\n                                        {\r\n                                            type: 'text',\r\n                                            value: \"ALLY Transaction History\",\r\n                                            position: { x: 30, y: 50 },\r\n                                            style: { textBrushColor: '#000000', fontSize: 14, hAlign: 'center', bold: true}\r\n                                        }\r\n\r\n                                    ]\r\n                                }\r\n                            }, null, null, true);\r\n\r\n                        }\r\n                    };\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet transfer-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/transaction-report.php\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: {phone: utopiasoftware.ally.model.appUserDetails.phone} // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.transactionHistoryCharts.loadTransactionHistoryData()]);\r\n            }).\r\n            then(function(dataArray){ // save the grid array data to cache\r\n                dataArray[1] = dataArray[1];\r\n                dataArray[1] = dataArray[0];\r\n                return utopiasoftware.ally.transactionHistoryCharts.saveTransactionHistoryData(dataArray[1]);\r\n            }).\r\n            then(function(dataArray){ // get the data array to be used by grid\r\n                // format the chart data array so it can be properly used\r\n                return gridDataMapping(dataArray);\r\n            }).\r\n            then(function(dataArray){\r\n                console.log(dataArray);\r\n                utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid =\r\n                    new ej.grids.Grid({\r\n                        // Width for grid\r\n                        width: '100%',\r\n                        allowTextWrap: true,\r\n                        showColumnChooser: true,\r\n                        allowTextWrap: true,\r\n                        showColumnChooser: true,\r\n                        allowPdfExport: true,\r\n                        allowExcelExport: true,\r\n                        toolbar: ['search', 'columnchooser', 'pdfexport'],\r\n                        columns: [\r\n                            { field: 'SENDER', headerText: 'Sender', width: \"25%\", clipMode: 'ellipsiswithtooltip' },\r\n                            { field: 'RECEIVER', headerText: 'Recipient', width: \"25%\", clipMode: 'ellipsiswithtooltip'},\r\n                            { field: 'AMOUNT', headerText: 'Amount', width: \"25%\", textAlign: 'right',\r\n                                clipMode: 'ellipsiswithtooltip'},\r\n                            { field: 'DDATE', headerText: 'Date', width: \"25%\",\r\n                                clipMode: 'ellipsiswithtooltip'},\r\n                            { field: 'TRANSFERTYPE', headerText: 'Type', width: \"25%\",\r\n                                clipMode: 'ellipsiswithtooltip', visible: false},\r\n                            { field: 'TRANSACTIONREF', headerText: 'Ref', width: \"25%\", clipMode: 'ellipsiswithtooltip',\r\n                                visible: false}\r\n                        ],\r\n                        dataSource: dataArray,\r\n                        pdfExportComplete: async function(pdfExportCompleteArgs){\r\n                            console.log(\"ARGUMENTS\", pdfExportCompleteArgs);\r\n                            var fileObj = null; // variable holds the file object to be created\r\n\r\n                            var permissionStatuses = null; // holds the statuses of the runtime permissions requested\r\n\r\n                            // request runtime permissions to write pdf file to device\r\n                            permissionStatuses =  await new Promise(function(resolve, reject){\r\n                                cordova.plugins.diagnostic.requestRuntimePermissions(resolve, reject,[\r\n                                    cordova.plugins.diagnostic.permission.WRITE_EXTERNAL_STORAGE,\r\n                                    cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE\r\n                                ]);\r\n                            });\r\n\r\n                            // get the blob data when the export process is completed\r\n                            pdfExportCompleteArgs.promise.then(function(pdfData){ // get the pdf structure if the content being exported\r\n                                pdfExportBlob = pdfData.blobData; // get the blob for the exported pdf\r\n                                console.log(\"EXPORTED\", pdfData);\r\n\r\n                                // check if the user has given permission to write pdf file to device\r\n                                if(!permissionStatuses ||\r\n                                    permissionStatuses[cordova.plugins.diagnostic.permission.WRITE_EXTERNAL_STORAGE] !==\r\n                                    cordova.plugins.diagnostic.permissionStatus.GRANTED ||\r\n                                    permissionStatuses[cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE] !==\r\n                                    cordova.plugins.diagnostic.permissionStatus.GRANTED){\r\n                                    throw \"error\";\r\n                                }\r\n\r\n                                return new Promise(function(resolve, reject){ // return the directory where to store the document/image\r\n                                    window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, resolve, reject);\r\n                                });\r\n                            }).then(function(directory){\r\n                                return new Promise(function(resolve, reject){ // return the created file which holds the pdf document\r\n                                    directory.getFile('ALLY-Transactions-' + Date.now() + '.pdf', {create:true, exclusive: false},\r\n                                        resolve, reject);\r\n                                });\r\n                            }).\r\n                            then(function(file){ // get the file object\r\n                                fileObj = file; // assign the file object to the function variable\r\n\r\n                                return new Promise(function(resolve, reject){ // return the FileWriter object used to write content to the created file\r\n                                    file.createWriter(resolve, reject);\r\n                                });\r\n                            }).\r\n                            then(function(fileWriter){ // get the FileWriter object\r\n                                return new Promise(function(resolve, reject){\r\n                                    fileWriter.onwriteend = resolve;\r\n                                    fileWriter.onerror = reject;\r\n\r\n                                    fileWriter.write(pdfExportBlob); // write the content of the blob to the file\r\n                                });\r\n                            }).then(function(){ // notify that export completed\r\n                                ons.notification.toast(\"PDF Exported to Root Folder!\", {timeout:4000});\r\n                            }).\r\n                            catch(function(err){console.log(\"EXPORT FAILED\", err)});\r\n                        }\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#transaction-history-page #transaction-history-transaction-grid').html(\"\");\r\n                //append the newly created grid\r\n                utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.\r\n                appendTo('#transaction-history-transaction-grid');\r\n\r\n                // append the listener for the toolbar 'Export PDF' button click\r\n                utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.\r\n                    toolbarClick = function (args) {\r\n                    console.log(\"ID \", args.item.id);\r\n                    if (args.item.id === 'transaction-history-transaction-grid_pdfexport') { // the toolbar button being clicked is the 'PDF Export'\r\n                        console.log(\"DATASOURCE \", utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.dataSource);\r\n                        utopiasoftware.ally.controller.transactionHistoryPageViewModel.transactionHistoryGrid.\r\n                        pdfExport({\r\n                            includeHiddenColumn: true,\r\n                            pageSize: 'a4',\r\n                            pageOrientation: 'landscape',\r\n                            header: {\r\n                                fromTop: 0,\r\n                                height: 130,\r\n                                contents: [\r\n                                    {\r\n                                        type: 'text',\r\n                                        value: \"ALLY Transaction History\",\r\n                                        position: { x: 30, y: 50 },\r\n                                        style: { textBrushColor: '#000000', fontSize: 14, hAlign: 'center', bold: true}\r\n                                    }\r\n\r\n                                ]\r\n                            }\r\n                        }, null, null, true);\r\n\r\n                    }\r\n                };\r\n\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the grid data into an appropriate form that can be displayed by the chart\r\n             * @param gridDataArray {Array} array containing grid data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the grid\r\n             */\r\n            function gridDataMapping(gridDataArray){\r\n                return gridDataArray.map(function(dataObject){\r\n                    dataObject.AMOUNT = kendo.toString(kendo.parseFloat(dataObject.AMOUNT), \"n2\"); // convert to currency format\r\n                    dataObject.DDATE = kendo.toString(kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd HH:mm:ss\"),\r\n                        \"yyyy-MM-dd; h:mmtt\"); // convert to date object\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for Wallet Transfer Add Card page\r\n     */\r\n    addCardWalletTransferPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to validate the card number field\r\n         */\r\n        cardNumberFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the ej library card masked text input\r\n         */\r\n        cardMaskedTextInput: null,\r\n\r\n        /**\r\n         * used to hold the ej library card month dropdown list component\r\n         */\r\n        cardMonthDropDownList: null,\r\n\r\n        /**\r\n         * used to hold the ej library card year dropdown list component\r\n         */\r\n        cardYearDropDownList: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.backButtonClicked;\r\n\r\n\r\n\r\n                // initialise the card masked input widget\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMaskedTextInput =  new ej.inputs.MaskedTextBox({\r\n                    mask: '0000 0000 0000 0000 99999',\r\n                    placeholder: \"Card Number\",\r\n                    promptChar: '*',\r\n                    floatLabelType: \"Always\"\r\n                });\r\n\r\n                // render initialized card masked input widget\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMaskedTextInput.\r\n                appendTo('#add-card-wallet-transfer-card-number');\r\n\r\n                // initialise the card month DropDown widget\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMonthDropDownList =\r\n                    new ej.dropdowns.DropDownList({\r\n                        dataSource: [{value: \"01\", displayText: \"01\"},\r\n                            {value: \"02\", displayText: \"02\"},\r\n                            {value: \"03\", displayText: \"03\"},\r\n                            {value: \"04\", displayText: \"04\"},\r\n                            {value: \"05\", displayText: \"05\"},\r\n                            {value: \"06\", displayText: \"06\"},\r\n                            {value: \"07\", displayText: \"07\"},\r\n                            {value: \"08\", displayText: \"08\"},\r\n                            {value: \"09\", displayText: \"09\"},\r\n                            {value: \"10\", displayText: \"10\"},\r\n                            {value: \"11\", displayText: \"11\"},\r\n                            {value: \"12\", displayText: \"12\"}],\r\n                        fields: {text: 'displayText', value: 'value'},\r\n                        placeholder: \"Expiry Month\",\r\n                        floatLabelType: \"Auto\"\r\n                    });\r\n\r\n                // render the initialized card month dropdown list\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMonthDropDownList.\r\n                appendTo('#add-card-wallet-transfer-expiry-month');\r\n\r\n                // initialise the array to hold the valid card expiry years\r\n                var cardYearsArray = [];\r\n                var yearOption = (new Date()).getFullYear(); // get the current year\r\n                // add the current year as an object in the cardYearsArray\r\n                cardYearsArray.push({value: (\"\" + yearOption).substring(2,4), displayText: yearOption});\r\n\r\n                // add 3 more years to the cardYearsArray for the Card Expiry Year\r\n                for(var index = 0; index < 3; index++){\r\n                    // increase the yearOption by 1\r\n                    yearOption += 1;\r\n                    // add the additional year as an object in the cardYearsArray\r\n                    cardYearsArray.push({value: (\"\" + yearOption).substring(2,4), displayText: yearOption});\r\n                }\r\n\r\n                // initialise the card expiry year DropDown widget\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardYearDropDownList =\r\n                    new ej.dropdowns.DropDownList({\r\n                        dataSource: cardYearsArray,\r\n                        fields: {text: 'displayText', value: 'value'},\r\n                        placeholder: \"Expiry Year\",\r\n                        floatLabelType: \"Auto\"\r\n                    });\r\n\r\n                // render the initialized card expiry year dropdown list\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardYearDropDownList.\r\n                appendTo('#add-card-wallet-transfer-expiry-year');\r\n\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formTooltip.\r\n                appendTo('#add-card-wallet-transfer-form');\r\n\r\n                // initialise the card number field validator\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardNumberFieldValidator =\r\n                    $('#add-card-wallet-transfer-card-number').parsley({\r\n                        value: function(parsley) {\r\n                            // return the unmasked input from the card number field\r\n                            return utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.\r\n                                cardMaskedTextInput.value;\r\n                        }\r\n                    });\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.amountFieldValidator =\r\n                    $('#add-card-wallet-transfer-charge-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#add-card-wallet-transfer-charge-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#add-card-wallet-transfer-charge-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator =\r\n                    $('#add-card-wallet-transfer-form').parsley();\r\n\r\n                // attach listener for the transfer button on the page\r\n                $('#add-card-wallet-transfer-transfer-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidated);\r\n\r\n                // populate the form using the data retrieved from the previous page\r\n                var prePopulatedData = $('#app-main-navigator').get(0).topPage.data;\r\n                $('#add-card-wallet-transfer-charge-amount', $thisPage).\r\n                val(kendo.toString(prePopulatedData.amount, \"n2\"));\r\n                $('#add-card-wallet-transfer-receiver-phone-number', $thisPage).val(prePopulatedData.phone_receiver);\r\n\r\n                // display the form\r\n                $('#add-card-form', $thisPage).css(\"display\", \"block\");\r\n                // hide the preloader\r\n                $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-card-wallet-transfer-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-card-wallet-transfer-page [title]').removeAttr(\"title\");\r\n                $('#add-card-wallet-transfer-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-card-wallet-transfer-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-card-wallet-transfer-page [title]').removeAttr(\"title\");\r\n                $('#add-card-wallet-transfer-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardNumberFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.destroy();\r\n                // destroy other form components\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMaskedTextInput.destroy();\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMonthDropDownList.destroy();\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardYearDropDownList.destroy();\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formTooltip.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY wallet cannot be saved without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                firstName: utopiasoftware.ally.model.appUserDetails.firstname,\r\n                lastName: utopiasoftware.ally.model.appUserDetails.lastname,\r\n                phone_sender: utopiasoftware.ally.model.appUserDetails.phone,\r\n                email: utopiasoftware.ally.model.appUserDetails.email ? utopiasoftware.ally.model.appUserDetails.email : \"\",\r\n                cardno: utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMaskedTextInput.value,\r\n                cvv: $('#add-card-wallet-transfer-page #add-card-wallet-transfer-cvv').val(),\r\n                expirymonth: utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardMonthDropDownList.value,\r\n                expiryyear: utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.cardYearDropDownList.value,\r\n                pin: $('#add-card-wallet-transfer-page #add-card-wallet-transfer-pin').val(),\r\n                amount: kendo.parseFloat($('#add-card-wallet-transfer-page #add-card-wallet-transfer-charge-amount').val()),\r\n                phone_receiver: $('#add-card-wallet-transfer-page #add-card-wallet-transfer-receiver-phone-number').val()\r\n            };\r\n\r\n            if(formData.phone_receiver.startsWith(\"0\")){ // the phone number starts with 0, replace it with international dialing code\r\n                formData.phone_receiver = formData.phone_receiver.replace(\"0\", \"+234\");\r\n            }\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Completing Wallet Transfer...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/transfer-wallet-to-wallet-via-card.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message || serverResponse.data.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(responseArray){\r\n                // ask user for transaction otp\r\n                return Promise.all([responseArray[0], ons.notification.prompt({title: \"OTP Confirmation\",\r\n                    messageHTML: `<div><ons-icon icon=\"md-ally-icon-otp\" size=\"24px\"\r\n                    style=\"color: #30a401; float: left; width: 26px;\"></ons-icon>\r\n                    <span style=\"float: right; width: calc(100% - 26px);\">\r\n                    FUNDING FEE: ${kendo.toString(kendo.parseFloat(responseArray[0].appfee), 'n2')}<br>\r\n                    AMOUNT TO CHARGE: ${kendo.toString(kendo.parseFloat(responseArray[0].total), 'n2')}<br>\r\n                    Confirm Transaction by providing OTP sent to your phone or generated by your bank token</span></div>`,\r\n                    cancelable: false, placeholder: \"OTP\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                    submitOnEnter: true\r\n                })]);\r\n            }).\r\n            then(function(responseArray){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Authorizing Wallet Transfer...\");\r\n                return Promise.all([...responseArray, $('#hour-glass-loader-modal').get(0).show()])\r\n            }).\r\n            then(function(responseArray){\r\n\r\n                // create the data object to be sent\r\n                var submitData = responseArray[0]; // send back previously received response\r\n                submitData.otp = responseArray[1];\r\n                submitData.phone_sender = utopiasoftware.ally.model.appUserDetails.phone;\r\n                submitData.phone_receiver = formData.phone_receiver;\r\n                submitData.savecard =\r\n                    $('#add-card-wallet-transfer-page #add-card-wallet-transfer-save-card-details').get(0).checked;\r\n\r\n                // submit the form data\r\n                return Promise.all([Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url +\r\n                        \"/mobile/transfer-wallet-to-wallet-via-card-confirm-otp.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: submitData // data to submit to server\r\n                    }\r\n                )), responseArray[0]]);\r\n            }).\r\n            then(function(serverResponseArray){\r\n                // serverResponse +=  \"\";\r\n                serverResponseArray[0] = JSON.parse(serverResponseArray[0].trim()); // get the new user object\r\n\r\n                // check if any error occurred\r\n                if(serverResponseArray[0].status == \"error\"){ // an error occured\r\n                    throw serverResponseArray[0].message; // throw the error message attached to this error\r\n                }\r\n\r\n                return Promise.all([...serverResponseArray, $('#hour-glass-loader-modal').get(0).hide()]); // hide loader\r\n            }).\r\n            then(function(dataArray){\r\n                // check if the recipient of the wallet transfer is a registered user\r\n                if(dataArray[1].isregistereduser != \"yes\") {\r\n                    // append the json details for the wallet-transfer to the wallet-transfer-sms-confirm-modal confirmation button\r\n                    $($('#wallet-transfer-sms-confirm-modal #wallet-transfer-sms-confirm-button').get(0)).\r\n                    attr(\"data-wallet-transfer\", JSON.stringify({receiver: formData.phone_receiver, amount: formData.amount}));\r\n                    // show the wallet-transfer-sms-confirm-modal to the user\r\n                    return $('#wallet-transfer-sms-confirm-modal').get(0).show();\r\n                }\r\n                else{ // recipient is registered\r\n                    return \"registered recipient\";\r\n                }\r\n            }).\r\n            then(function(){\r\n                hockeyapp.trackEvent(function(){}, function(){}, \"FUND TRANSFERRED\"); // track fund transfer\r\n\r\n                // reset the form for the add card wallet transfer page\r\n                $('#add-card-wallet-transfer-page #add-card-wallet-transfer-form').get(0).reset();\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.addCardWalletTransferPageViewModel.formValidator.reset();\r\n\r\n                // send push notification to the recipient of the transfer\r\n                let pushNotification = { // create the push notification object\r\n                    \"app_id\": \"d5d2bdba-eec0-46b1-836e-c5b8e318e928\",\r\n                    \"filters\": [{\"field\": \"tag\", \"key\": \"phone\", \"relation\": \"=\", \"value\":\r\n                    formData.phone_receiver}],\r\n                    \"contents\": {\"en\": \"You received funds into your ALLY WALLET from \" +\r\n                    utopiasoftware.ally.model.appUserDetails.firstname + \" \" + utopiasoftware.ally.model.appUserDetails.lastname},\r\n                    \"headings\": {\"en\": \"Funds Received\"},\r\n                    \"android_channel_id\": \"66dfeddf-12d7-4194-b3d9-38325042d258\",\r\n                    \"android_visibility\": 0,\r\n                    \"priority\": 5\r\n                };\r\n\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: \"https://onesignal.com/api/v1/notifications\",\r\n                        type: \"post\",\r\n                        contentType: \"application/json\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"Authorization\", \"Basic MmQ3ODcwZGUtYmIyYS00NzY5LWIwZWQtMTk5ZGRjNzU2M2Q3\");\r\n                        },\r\n                        dataType: \"json\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: false,\r\n                        data: JSON.stringify(pushNotification)\r\n                    }\r\n                ));\r\n\r\n                return Promise.all([ons.notification.toast(\"Recipient Wallet Funded Successfully!\", {timeout:4000}),\r\n                    $('#app-main-navigator').get(0).popPage({data: {refresh: true}})]);\r\n\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. Recipient ALLY wallet could not be funded. Please retry\"\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Wallet Funding Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // remove this page form the main navigator stack\r\n            $('#app-main-navigator').get(0).popPage();\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the 'Pick Contact\" button is clicked\r\n         */\r\n        pickContactButtonClicked: function(){\r\n\r\n            // display the list of contacts from the user's phone address book\r\n            new Promise(function(resolve, reject){\r\n                window.plugins.contactNumberPicker.pick(resolve, reject);\r\n            }).\r\n            then(function(contact){ // retrieve picked contact\r\n\r\n                // get the selected contact phone number\r\n                var contactPhoneNumber = contact.phoneNumber;\r\n\r\n                //format the retrieved phone number to acceptable app standards\r\n                contactPhoneNumber = contactPhoneNumber.replace(/\\D/ig, \"\"); // remove any non-digit character between phone numbers\r\n                // if any number brings with '0' replace it with '+234'\r\n                if(contactPhoneNumber.startsWith(\"0\")){ // the phone number starts with 0, replace it with international dialing code\r\n                    contactPhoneNumber = contactPhoneNumber.replace(\"0\", \"+234\");\r\n                }\r\n                //ensure phone number begins with a '+'\r\n                if(!contactPhoneNumber.startsWith(\"+\")){ // the phone number does not start with '+'\r\n                    contactPhoneNumber = \"+\" + contactPhoneNumber; // append the '+' to the beginning\r\n                }\r\n\r\n                // update the recipient phone input field with the retrieved & formatted phone number\r\n                $('#add-card-wallet-transfer-form #add-card-wallet-transfer-receiver-phone-number').val(contactPhoneNumber);\r\n            }).\r\n            catch(function(){\r\n\r\n                // inform the user that there was an error\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"phone contacts could not be accessed right now\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for Merchant Payment Add Card page\r\n     */\r\n    addCardMerchantPaymentPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to validate the card number field\r\n         */\r\n        cardNumberFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * used to hold the ej library card masked text input\r\n         */\r\n        cardMaskedTextInput: null,\r\n\r\n        /**\r\n         * used to hold the ej library card month dropdown list component\r\n         */\r\n        cardMonthDropDownList: null,\r\n\r\n        /**\r\n         * used to hold the ej library card year dropdown list component\r\n         */\r\n        cardYearDropDownList: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.backButtonClicked;\r\n\r\n\r\n\r\n                // initialise the card masked input widget\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMaskedTextInput =\r\n                    new ej.inputs.MaskedTextBox({\r\n                    mask: '0000 0000 0000 0000 99999',\r\n                    placeholder: \"Card Number\",\r\n                    promptChar: '*',\r\n                    floatLabelType: \"Always\"\r\n                });\r\n\r\n                // render initialized card masked input widget\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMaskedTextInput.\r\n                appendTo('#add-card-merchant-payment-card-number');\r\n\r\n                // initialise the card month DropDown widget\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMonthDropDownList =\r\n                    new ej.dropdowns.DropDownList({\r\n                        dataSource: [{value: \"01\", displayText: \"01\"},\r\n                            {value: \"02\", displayText: \"02\"},\r\n                            {value: \"03\", displayText: \"03\"},\r\n                            {value: \"04\", displayText: \"04\"},\r\n                            {value: \"05\", displayText: \"05\"},\r\n                            {value: \"06\", displayText: \"06\"},\r\n                            {value: \"07\", displayText: \"07\"},\r\n                            {value: \"08\", displayText: \"08\"},\r\n                            {value: \"09\", displayText: \"09\"},\r\n                            {value: \"10\", displayText: \"10\"},\r\n                            {value: \"11\", displayText: \"11\"},\r\n                            {value: \"12\", displayText: \"12\"}],\r\n                        fields: {text: 'displayText', value: 'value'},\r\n                        placeholder: \"Expiry Month\",\r\n                        floatLabelType: \"Auto\"\r\n                    });\r\n\r\n                // render the initialized card month dropdown list\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMonthDropDownList.\r\n                appendTo('#add-card-merchant-payment-expiry-month');\r\n\r\n                // initialise the array to hold the valid card expiry years\r\n                var cardYearsArray = [];\r\n                var yearOption = (new Date()).getFullYear(); // get the current year\r\n                // add the current year as an object in the cardYearsArray\r\n                cardYearsArray.push({value: (\"\" + yearOption).substring(2,4), displayText: yearOption});\r\n\r\n                // add 3 more years to the cardYearsArray for the Card Expiry Year\r\n                for(var index = 0; index < 3; index++){\r\n                    // increase the yearOption by 1\r\n                    yearOption += 1;\r\n                    // add the additional year as an object in the cardYearsArray\r\n                    cardYearsArray.push({value: (\"\" + yearOption).substring(2,4), displayText: yearOption});\r\n                }\r\n\r\n                // initialise the card expiry year DropDown widget\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardYearDropDownList =\r\n                    new ej.dropdowns.DropDownList({\r\n                        dataSource: cardYearsArray,\r\n                        fields: {text: 'displayText', value: 'value'},\r\n                        placeholder: \"Expiry Year\",\r\n                        floatLabelType: \"Auto\"\r\n                    });\r\n\r\n                // render the initialized card expiry year dropdown list\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardYearDropDownList.\r\n                appendTo('#add-card-merchant-payment-expiry-year');\r\n\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formTooltip.\r\n                appendTo('#add-card-merchant-payment-form');\r\n\r\n                // initialise the card number field validator\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardNumberFieldValidator =\r\n                    $('#add-card-merchant-payment-card-number').parsley({\r\n                        value: function(parsley) {\r\n                            // return the unmasked input from the card number field\r\n                            return utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.\r\n                                cardMaskedTextInput.value;\r\n                        }\r\n                    });\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.amountFieldValidator =\r\n                    $('#add-card-merchant-payment-charge-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#add-card-merchant-payment-charge-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#add-card-merchant-payment-charge-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator =\r\n                    $('#add-card-merchant-payment-form').parsley();\r\n\r\n                // attach listener for the pay button on the page\r\n                $('#add-card-merchant-payment-pay-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidated);\r\n\r\n                // populate the form using the data retrieved from the previous page\r\n                var prePopulatedData = $('#app-main-navigator').get(0).topPage.data;\r\n                $('#add-card-merchant-payment-charge-amount', $thisPage).\r\n                val(kendo.toString(prePopulatedData.amount, \"n2\"));\r\n                $('#add-card-merchant-payment-merchant-phone', $thisPage).val(prePopulatedData.phone_receiver);\r\n                $('#add-card-merchant-payment-merchant-code', $thisPage).val(prePopulatedData.merchantcode);\r\n                $('#add-card-merchant-payment-merchant-name', $thisPage).val(prePopulatedData.merchantname);\r\n\r\n                // display the form\r\n                $('#add-card-merchant-payment-form', $thisPage).css(\"display\", \"block\");\r\n                // hide the preloader\r\n                $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {},\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-card-merchant-payment-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-card-merchant-payment-page [title]').removeAttr(\"title\");\r\n                $('#add-card-merchant-payment-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-card-merchant-payment-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-card-merchant-payment-page [title]').removeAttr(\"title\");\r\n                $('#add-card-merchant-payment-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardNumberFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formValidator.destroy();\r\n                // destroy other form components\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMaskedTextInput.destroy();\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMonthDropDownList.destroy();\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardYearDropDownList.destroy();\r\n                utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.formTooltip.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"ALLY wallet cannot be saved without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                firstName: utopiasoftware.ally.model.appUserDetails.firstname,\r\n                lastName: utopiasoftware.ally.model.appUserDetails.lastname,\r\n                phone_sender: utopiasoftware.ally.model.appUserDetails.phone,\r\n                email: utopiasoftware.ally.model.appUserDetails.email ? utopiasoftware.ally.model.appUserDetails.email : \"\",\r\n                cardno: utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMaskedTextInput.value,\r\n                cvv: $('#add-card-merchant-payment-page #add-card-merchant-payment-cvv').val(),\r\n                expirymonth: utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardMonthDropDownList.value,\r\n                expiryyear: utopiasoftware.ally.controller.addCardMerchantPaymentPageViewModel.cardYearDropDownList.value,\r\n                pin: $('#add-card-merchant-payment-page #add-card-merchant-payment-pin').val(),\r\n                amount: kendo.parseFloat($('#add-card-merchant-payment-page #add-card-merchant-payment-charge-amount').val()),\r\n                phone_receiver: $('#add-card-merchant-payment-page #add-card-merchant-payment-merchant-phone').val(),\r\n                merchantcode: $('#add-card-merchant-payment-page #add-card-merchant-payment-merchant-code').val(),\r\n                merchantname: $('#add-card-merchant-payment-page #add-card-merchant-payment-merchant-name').val()\r\n            };\r\n\r\n            if(formData.phone_receiver.startsWith(\"0\")){ // the phone number starts with 0, replace it with international dialing code\r\n                formData.phone_receiver = formData.phone_receiver.replace(\"0\", \"+234\");\r\n            }\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Completing Merchant Payment...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/pay-merchant-via-card-direct.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n                console.log(\"MERCHANT PAY\", serverResponse);\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message || serverResponse.data.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(responseArray){\r\n                // ask user for transaction otp\r\n                return Promise.all([responseArray[0], ons.notification.prompt({title: \"OTP Confirmation\",\r\n                    messageHTML: `<div><ons-icon icon=\"md-ally-icon-otp\" size=\"24px\"\r\n                    style=\"color: #30a401; float: left; width: 26px;\"></ons-icon>\r\n                    <span style=\"float: right; width: calc(100% - 26px);\">\r\n                    APP FEE: ${kendo.toString(kendo.parseFloat(responseArray[0].appfee), 'n2')}<br>\r\n                    AMOUNT TO CHARGE: ${kendo.toString(kendo.parseFloat(responseArray[0].total), 'n2')}<br>\r\n                    Confirm Transaction by providing OTP sent to your phone or generated by your bank token</span></div>`,\r\n                    cancelable: false, placeholder: \"OTP\", inputType: \"number\", defaultValue: \"\", autofocus: false,\r\n                    submitOnEnter: true\r\n                })]);\r\n            }).\r\n            then(function(responseArray){\r\n                // display the loader message to indicate that account is being created;\r\n                $('#hour-glass-loader-modal .modal-message').html(\"Authorizing Merchant Payment...\");\r\n                return Promise.all([...responseArray, $('#hour-glass-loader-modal').get(0).show()])\r\n            }).\r\n            then(function(responseArray){\r\n\r\n                // create the data object to be sent\r\n                responseArray[0].otp = responseArray[1];\r\n                responseArray[0].savecard = $('#add-card-merchant-payment-page #add-card-merchant-payment-save-card-details').get(0).checked;\r\n\r\n                // submit the form data\r\n                return Promise.all([Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url +\r\n                        \"/mobile/pay-merchant-via-card-direct-confirm.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: responseArray[0] // data to submit to server\r\n                    }\r\n                ))]);\r\n            }).\r\n            then(function(serverResponseArray){\r\n                // serverResponse +=  \"\";\r\n                serverResponseArray = JSON.parse(serverResponseArray[0].trim()); // get parse response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponseArray[0].status == \"error\"){ // an error occured\r\n                    throw serverResponseArray[0].message; // throw the error message attached to this error\r\n                }\r\n\r\n                return Promise.all([...serverResponseArray, $('#hour-glass-loader-modal').get(0).hide()]); // hide loader\r\n            }).\r\n            then(function(dataArray){\r\n                console.log(\"PAY COMPLETE\", dataArray);\r\n                // forward details of the save the user details to encrypted storage; also forward details of payment\r\n                return Promise.all([utopiasoftware.ally.saveUserAppDetails(dataArray[0]), dataArray[1]]);\r\n            }).\r\n            then(function(dataArray){\r\n                // update local copy of user app details\r\n                utopiasoftware.ally.model.appUserDetails = dataArray[0];\r\n\r\n                // serialize the receipt data & bind it to the receipt grid component in preparation for user display\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.dataSource =\r\n                    utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.serializeReceiptData(dataArray[1]);\r\n                utopiasoftware.ally.controller.paymentsAllyDirectPageViewModel.merchantPaymentReceiptGrid.dataBind();\r\n\r\n                // send push notification to the recipient of the transfer\r\n                let pushNotification = { // create the push notification object\r\n                    \"app_id\": \"d5d2bdba-eec0-46b1-836e-c5b8e318e928\",\r\n                    \"filters\": [{\"field\": \"tag\", \"key\": \"phone\", \"relation\": \"=\", \"value\":\r\n                    formData.phone_receiver}],\r\n                    \"contents\": {\"en\": \"You received payment into your ALLY WALLET from \" +\r\n                    utopiasoftware.ally.model.appUserDetails.firstname + \" \" + utopiasoftware.ally.model.appUserDetails.lastname},\r\n                    \"headings\": {\"en\": \"Payment Received\"},\r\n                    \"android_channel_id\": \"81baf9bc-d068-4f4c-9bae-1a3dc8488491\",\r\n                    \"android_visibility\": 0,\r\n                    \"priority\": 5\r\n                };\r\n\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: \"https://onesignal.com/api/v1/notifications\",\r\n                        type: \"post\",\r\n                        contentType: \"application/json\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"Authorization\", \"Basic MmQ3ODcwZGUtYmIyYS00NzY5LWIwZWQtMTk5ZGRjNzU2M2Q3\");\r\n                        },\r\n                        dataType: \"json\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: false,\r\n                        data: JSON.stringify(pushNotification)\r\n                    }\r\n                ));\r\n\r\n                hockeyapp.trackEvent(function(){}, function(){}, \"MERCHANT PAYMENT\"); // track merchant payments\r\n\r\n                // forward details of the wallet-transfer and the user details\r\n                return Promise.all([$('#hour-glass-loader-modal').get(0).hide(),\r\n                    $('#app-main-navigator').get(0).popPage({}),\r\n                    $('#payments-page #payments-tabbar').get(0).setActiveTab(0),\r\n                    ons.notification.toast(\"Merchant Payment Successful!\", {timeout:4000}),\r\n                    $('#merchant-payment-receipt-modal').get(0).show()]);\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = 'Sorry, merchant payment could not be made.<br> ' +\r\n                        'You can try again OR scan the QR Code to pay merchant';\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> ALLY Payment Error',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // remove this page form the main navigator stack\r\n            $('#app-main-navigator').get(0).popPage();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for expense-tracker page\r\n     */\r\n    expenseTrackerPageViewModel: {\r\n\r\n        /**\r\n         * object is used to hold the tooltip for the expense tracker date range picker\r\n         */\r\n        dateRangePickerToolTip: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Period Select\" dropdown list\r\n         */\r\n        periodDropDownListObject: null,\r\n\r\n\r\n        /**\r\n         * property is used to hold the expense tracker Grid component\r\n         */\r\n        expenseTrackerGrid: null,\r\n\r\n        /**\r\n         * property is used to hold the date range picker for the\r\n         * custom expense date range\r\n         */\r\n        expenseTrackerDateRangerPicker: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Expense Tracker Bar Chart\"\r\n         */\r\n        expenseTrackerBarChart: null,\r\n\r\n        /**\r\n         * property is used to hold the \"Expense Tracker Doughnut Chart\"\r\n         */\r\n        expenseTrackerDoughnutChart: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $thisPage.get(0).onDeviceBackButton = utopiasoftware.ally.controller.expenseTrackerPageViewModel.backButtonClicked;\r\n\r\n                // inject the the modules required to create the transaction history grid\r\n                ej.grids.Grid.Inject(ej.grids.Page, ej.grids.Selection, ej.grids.Scroll, ej.grids.Search, ej.grids.Toolbar,\r\n                    ej.grids.PdfExport, ej.grids.ExcelExport, ej.grids.Group, ej.grids.Aggregate);\r\n\r\n                // inject the the modules required to create various charts for the page\r\n                ej.charts.Chart.Inject(ej.charts.Legend, ej.charts.ColumnSeries, ej.charts.Category,\r\n                    ej.charts.Tooltip);\r\n                ej.charts.AccumulationChart.Inject(ej.charts.Legend, ej.charts.PieSeries,\r\n                    ej.charts.AccumulationDataLabel, ej.charts.Tooltip);\r\n\r\n\r\n                // initialise the expense DateRangePicker\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDateRangerPicker =\r\n                    new ej.calendars.DateRangePicker({\r\n                        placeholder: 'Pick Date Range',\r\n                        floatLabelType: 'Auto',\r\n                        separator: '-',\r\n                        readonly: true,\r\n                        //sets the start date in the range\r\n                        //startDate: new Date(),\r\n                        //sets the end date in the range\r\n                        //endDate: new Date(),\r\n                        //sets the min date in the range\r\n                        min: new Date('2008-01-01'),\r\n                        //sets the max.\r\n                        max: new Date(),\r\n                        format: 'yyyy/MM/dd',\r\n                        change: function(){ // listener is triggered when date range values are successfully changed\r\n                            // create the arguments that will be passed to the appropriate method\r\n                            var argumentArray = [];\r\n                            argumentArray[0] = 'custom';\r\n                            argumentArray[1] = utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                                expenseTrackerDateRangerPicker.startDate;\r\n                            argumentArray[2] = utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                                expenseTrackerDateRangerPicker.endDate;\r\n                            // refresh the expense tracker displays\r\n                            utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                            refreshExpenseTrackerDisplays(...argumentArray);\r\n                        }\r\n                    });\r\n\r\n                // render initialized expense DatePicker\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDateRangerPicker.\r\n                appendTo('#expense-tracker-custom-date');\r\n\r\n                // initialise the DropDownList\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.periodDropDownListObject =\r\n                    new ej.dropdowns.DropDownList({\r\n                        placeholder: \"Select Period\",\r\n                        floatLabelType: 'Auto'\r\n                    });\r\n\r\n                // add listener for when the value of the period dropdown list is changed\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.periodDropDownListObject.\r\n                addEventListener(\"change\", function(){\r\n                    // check if the custom date selector needs to be shown\r\n                    if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.periodDropDownListObject.value ==\r\n                    \"custom\"){ // custom date selector needs to be displayed\r\n                        $('#expense-tracker-custom-date-container', $thisPage).css(\"visibility\", \"visible\");\r\n                    }\r\n                    else{ // hide the custom date selector\r\n                        $('#expense-tracker-custom-date-container', $thisPage).css(\"visibility\", \"collapse\");\r\n                        // refresh the expense tracker displays\r\n                        // Provide the currently selected value of the period dropdown list\r\n                        utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                            refreshExpenseTrackerDisplays(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                            periodDropDownListObject.value);\r\n                    }\r\n                });\r\n\r\n                // render initialized DropDownList\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.periodDropDownListObject.\r\n                appendTo('#expense-tracker-period-select');\r\n\r\n                // initialise date range picker tooltio\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.dateRangePickerToolTip =\r\n                new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'bottom right',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render date range picker tooltip\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.dateRangePickerToolTip.\r\n                appendTo('#expense-tracker-custom-date-container');\r\n\r\n                // refresh expense tracker grid\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.refreshExpenseTrackerDisplays();\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // stop the rotating animation on main menu page\r\n            //$('.rotating-infinite-ease-in-1').addClass('rotating-infinite-ease-in-1-paused');\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // hide date range picker\r\n            utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDateRangerPicker.hide();\r\n\r\n            // check if the menu tabbar exists\r\n            if($('#menu-tabbar').get(0)){ // the menu tabbar object exists\r\n                // move to the previous tab\r\n                $('#menu-tabbar').get(0).setActiveTab(3);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * /**\r\n         * method is used to request a refresh of all charts nad the grid on the expense page\r\n         *\r\n         * @param periodType {String} the time period for which the chars should be refreshed\r\n         * @param customStartDate {Date}\r\n         * @param customEndDate {Date}\r\n         */\r\n        refreshExpenseTrackerDisplays: function(periodType = 'today', customStartDate, customEndDate){\r\n\r\n            // update the expense tracker grid\r\n            utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n            updateExpenseTrackerGrid(periodType, customStartDate, customEndDate);\r\n            // update the expense tracker barchart\r\n            utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n            updateExpenseTrackerBarChart(periodType, customStartDate, customEndDate);\r\n            // update the expense tracker doughnut chart\r\n            utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n            updateExpenseTrackerDoughnutChart(periodType, customStartDate, customEndDate);\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the \"Refresh\" toolbar button is clicked\r\n         */\r\n        refreshButtonClicked: function(){\r\n\r\n            // get the value of the period dropdown and perform refresh actions as appropriate\r\n            if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.periodDropDownListObject.value ==\r\n            \"custom\"){ // \"custom\" value was selected from dropdown\r\n\r\n                // create the arguments that will be passed to the appropriate method\r\n                var argumentArray = [];\r\n                argumentArray[0] = 'custom';\r\n                argumentArray[1] = utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.startDate;\r\n                argumentArray[2] = utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.endDate;\r\n                // refresh the expense tracker displays\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                refreshExpenseTrackerDisplays(...argumentArray);\r\n\r\n            }\r\n            else{ // any other value was selected\r\n                // refresh the expense tracker displays\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                refreshExpenseTrackerDisplays(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    periodDropDownListObject.value);\r\n\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * update the expense tracker grid. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         * @param customStartDate\r\n         * @param customEndDate\r\n         */\r\n        updateExpenseTrackerGrid: function(periodType = 'today', customStartDate, customEndDate){\r\n\r\n            var pdfExportBlob = null; // holds the blob for the pdf content being exported\r\n\r\n            // check if the Expense Tracker Grid has been created before, if so, show spinner\r\n            if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid){ // grid has previously been created\r\n                // show spinner for the grid object\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.showSpinner();\r\n            }\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.expenseTrackerGrid.loadExpenseTrackerData().\r\n                then(function(data){ // get the data to be used by grid\r\n                    // format the data array so it can be properly used\r\n                    return gridDataMapping(data[periodType]);\r\n                }).\r\n                then(function(dataArray){\r\n                    console.log(dataArray);\r\n                    // check if the Expense Tracker Grid has been created before, if so, destroy it\r\n                    if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid){ // grid has previously been created\r\n                        // hide spinner\r\n                        utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.hideSpinner();\r\n                        // destroy the grid object\r\n                        utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.destroy();\r\n                    }\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid =\r\n                        new ej.grids.Grid({\r\n                            // Width for grid\r\n                            width: '100%',\r\n                            allowTextWrap: true,\r\n                            showColumnChooser: true,\r\n                            allowTextWrap: true,\r\n                            showColumnChooser: true,\r\n                            allowPdfExport: true,\r\n                            allowExcelExport: true,\r\n                            allowGrouping: true,\r\n                            groupSettings: {showDropArea: false, columns: ['CATEGORY']},\r\n                            toolbar: ['search', 'columnchooser', 'pdfexport'],\r\n                            columns: [\r\n                                { field: 'CATEGORY', headerText: 'Category', width: \"25%\", clipMode: 'ellipsiswithtooltip' },\r\n                                { field: 'DESCRIPTION', headerText: 'Desc.', width: \"25%\", clipMode: 'ellipsiswithtooltip',\r\n                                    allowGrouping: false},\r\n                                { field: 'DDATE', headerText: 'Date', width: \"25%\",\r\n                                    clipMode: 'ellipsiswithtooltip', visible: false, allowGrouping: false},\r\n                                { field: 'AMOUNT', headerText: 'Amount', width: \"25%\", textAlign: 'right', format: 'N2',\r\n                                    clipMode: 'ellipsiswithtooltip', allowGrouping: false}\r\n                            ],\r\n                            aggregates: [{\r\n                                columns: [{\r\n                                    type: 'sum',\r\n                                    field: 'AMOUNT',\r\n                                    format: 'N2',\r\n                                    groupFooterTemplate: 'Sub-total: ${sum}',\r\n                                    footerTemplate: 'Total: ${sum}'\r\n                                }]\r\n                            }],\r\n                            dataSource: dataArray,\r\n                            pdfExportComplete: function(pdfExportCompleteArgs){\r\n                                console.log(\"ARGUMENTS\", pdfExportCompleteArgs);\r\n                                var fileObj = null; // variable holds the file object to be created\r\n\r\n                                // get the blob data when the export process is completed\r\n                                pdfExportCompleteArgs.promise.then(function(pdfData){ // get the pdf structure if the content being exported\r\n                                    pdfExportBlob = pdfData.blobData; // get the blob for the exported pdf\r\n                                    console.log(\"EXPORTED\", pdfData);\r\n\r\n                                    return new Promise(function(resolve, reject){ // return the directory where to store the document/image\r\n                                        window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, resolve, reject);\r\n                                    });\r\n                                }).then(function(directory){\r\n                                    return new Promise(function(resolve, reject){ // return the created file which holds the pdf document\r\n                                        directory.getFile('ALLY-Expense-Tracker-' + Date.now() + '.pdf', {create:true, exclusive: false},\r\n                                            resolve, reject);\r\n                                    });\r\n                                }).\r\n                                then(function(file){ // get the file object\r\n                                    fileObj = file; // assign the file object to the function variable\r\n\r\n                                    return new Promise(function(resolve, reject){ // return the FileWriter object used to write content to the created file\r\n                                        file.createWriter(resolve, reject);\r\n                                    });\r\n                                }).\r\n                                then(function(fileWriter){ // get the FileWriter object\r\n                                    return new Promise(function(resolve, reject){\r\n                                        fileWriter.onwriteend = resolve;\r\n                                        fileWriter.onerror = reject;\r\n\r\n                                        fileWriter.write(pdfExportBlob); // write the content of the blob to the file\r\n                                    });\r\n                                }).then(function(){ // notify that export completed\r\n                                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                                        expenseTrackerGrid.groupColumn(\"CATEGORY\");\r\n                                    // hide the spinner\r\n                                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.hideSpinner();\r\n                                    ons.notification.toast(\"PDF Exported to Root Folder!\", {timeout:4000});\r\n                                }).\r\n                                catch(function(err){\r\n                                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                                    expenseTrackerGrid.groupColumn(\"CATEGORY\");\r\n                                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.hideSpinner();\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                    //append the newly created grid\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.\r\n                    appendTo('#expense-tracker-grid');\r\n\r\n                    // append the listener for the toolbar 'Export PDF' button click\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.\r\n                        toolbarClick = function (args) {\r\n                        console.log(\"ID \", args.item.id);\r\n                        if (args.item.id === 'expense-tracker-grid_pdfexport') { // the toolbar button being clicked is the 'PDF Export'\r\n                            utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.showSpinner();\r\n                            utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                            expenseTrackerGrid.ungroupColumn(\"CATEGORY\");\r\n\r\n                            utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.\r\n                            pdfExport({\r\n                                includeHiddenColumn: true,\r\n                                pageSize: 'a4',\r\n                                pageOrientation: 'landscape',\r\n                                header: {\r\n                                    fromTop: 0,\r\n                                    height: 130,\r\n                                    contents: [\r\n                                        {\r\n                                            type: 'text',\r\n                                            value: \"ALLY Expense Report\",\r\n                                            position: { x: 30, y: 50 },\r\n                                            style: { textBrushColor: '#000000', fontSize: 14, hAlign: 'center', bold: true}\r\n                                        }\r\n\r\n                                    ]\r\n                                }\r\n                            }, null, null, true);\r\n\r\n                        }\r\n                    };\r\n\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            // create the data to be sent to server\r\n            var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                duration: periodType};\r\n            // check if the periodType == custom . if so append the custom date ranges\r\n            if(periodType == 'custom'){\r\n                formData.from_date = kendo.toString(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.startDate, \"yyyy-MM-dd\");\r\n                formData.to_date = kendo.toString(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.endDate, \"yyyy-MM-dd\");\r\n            }\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet transfer-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url:  utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-expenses.php\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: formData // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.expenseTrackerGrid.loadExpenseTrackerData()]);\r\n            }).\r\n            then(function(dataArray){ // save the grid array data to cache\r\n                dataArray[1] = dataArray[1];\r\n                dataArray[1][periodType] = dataArray[0];\r\n                return utopiasoftware.ally.expenseTrackerGrid.saveExpenseTrackerData(dataArray[1]);\r\n            }).\r\n            then(function(dataArray){ // get the data array to be used by grid\r\n                // format the chart data array so it can be properly used\r\n                return gridDataMapping(dataArray[periodType]);\r\n            }).\r\n            then(function(dataArray){\r\n                console.log(dataArray);\r\n                // check if the Expense Tracker Grid has been created before, if so, destroy it\r\n                if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid){ // grid has previously been created\r\n                    // hide spinner\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.hideSpinner();\r\n                    // destroy the grid object\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.destroy();\r\n                }\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid =\r\n                    new ej.grids.Grid({\r\n                        // Width for grid\r\n                        width: '100%',\r\n                        allowTextWrap: true,\r\n                        showColumnChooser: true,\r\n                        allowTextWrap: true,\r\n                        showColumnChooser: true,\r\n                        allowPdfExport: true,\r\n                        allowExcelExport: true,\r\n                        allowGrouping: true,\r\n                        groupSettings: {showDropArea: false, columns: ['CATEGORY']},\r\n                        toolbar: ['search', 'columnchooser', 'pdfexport'],\r\n                        columns: [\r\n                            { field: 'CATEGORY', headerText: 'Category', width: \"25%\", clipMode: 'ellipsiswithtooltip' },\r\n                            { field: 'DESCRIPTION', headerText: 'Desc.', width: \"25%\", clipMode: 'ellipsiswithtooltip',\r\n                                allowGrouping: false},\r\n                            { field: 'DDATE', headerText: 'Date', width: \"25%\",\r\n                                clipMode: 'ellipsiswithtooltip', visible: false, allowGrouping: false},\r\n                            { field: 'AMOUNT', headerText: 'Amount', width: \"25%\", textAlign: 'right', format: 'N2',\r\n                                clipMode: 'ellipsiswithtooltip', allowGrouping: false}\r\n                        ],\r\n                        aggregates: [{\r\n                            columns: [{\r\n                                type: 'sum',\r\n                                field: 'AMOUNT',\r\n                                format: 'N2',\r\n                                groupFooterTemplate: 'Sub-total: ${sum}',\r\n                                footerTemplate: 'Total: ${sum}'\r\n                            }]\r\n                        }],\r\n                        dataSource: dataArray,\r\n                        pdfExportComplete: function(pdfExportCompleteArgs){\r\n                            console.log(\"ARGUMENTS\", pdfExportCompleteArgs);\r\n                            var fileObj = null; // variable holds the file object to be created\r\n\r\n                            // get the blob data when the export process is completed\r\n                            pdfExportCompleteArgs.promise.then(function(pdfData){ // get the pdf structure if the content being exported\r\n                                pdfExportBlob = pdfData.blobData; // get the blob for the exported pdf\r\n                                console.log(\"EXPORTED\", pdfData);\r\n\r\n                                return new Promise(function(resolve, reject){ // return the directory where to store the document/image\r\n                                    window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, resolve, reject);\r\n                                });\r\n                            }).then(function(directory){\r\n                                return new Promise(function(resolve, reject){ // return the created file which holds the pdf document\r\n                                    directory.getFile('ALLY-Expense-Tracker-' + Date.now() + '.pdf', {create:true, exclusive: false},\r\n                                        resolve, reject);\r\n                                });\r\n                            }).\r\n                            then(function(file){ // get the file object\r\n                                fileObj = file; // assign the file object to the function variable\r\n\r\n                                return new Promise(function(resolve, reject){ // return the FileWriter object used to write content to the created file\r\n                                    file.createWriter(resolve, reject);\r\n                                });\r\n                            }).\r\n                            then(function(fileWriter){ // get the FileWriter object\r\n                                return new Promise(function(resolve, reject){\r\n                                    fileWriter.onwriteend = resolve;\r\n                                    fileWriter.onerror = reject;\r\n\r\n                                    fileWriter.write(pdfExportBlob); // write the content of the blob to the file\r\n                                });\r\n                            }).then(function(){ // notify that export completed\r\n                                utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                                expenseTrackerGrid.groupColumn(\"CATEGORY\");\r\n                                // hide the spinner\r\n                                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.hideSpinner();\r\n                                ons.notification.toast(\"PDF Exported to Root Folder!\", {timeout:4000});\r\n                            }).\r\n                            catch(function(err){\r\n                                utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                                expenseTrackerGrid.groupColumn(\"CATEGORY\");\r\n                                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.hideSpinner();\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                //append the newly created grid\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.\r\n                appendTo('#expense-tracker-grid');\r\n\r\n                // append the listener for the toolbar 'Export PDF' button click\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.\r\n                    toolbarClick = function (args) {\r\n                    console.log(\"ID \", args.item.id);\r\n                    if (args.item.id === 'expense-tracker-grid_pdfexport') { // the toolbar button being clicked is the 'PDF Export'\r\n                        utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.showSpinner();\r\n                        utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                        expenseTrackerGrid.ungroupColumn(\"CATEGORY\");\r\n\r\n                        utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerGrid.\r\n                        pdfExport({\r\n                            includeHiddenColumn: true,\r\n                            pageSize: 'a4',\r\n                            pageOrientation: 'landscape',\r\n                            header: {\r\n                                fromTop: 0,\r\n                                height: 130,\r\n                                contents: [\r\n                                    {\r\n                                        type: 'text',\r\n                                        value: \"ALLY Expense Report\",\r\n                                        position: { x: 30, y: 50 },\r\n                                        style: { textBrushColor: '#000000', fontSize: 14, hAlign: 'center', bold: true}\r\n                                    }\r\n\r\n                                ]\r\n                            }\r\n                        }, null, null, true);\r\n\r\n                    }\r\n                };\r\n\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the grid data into an appropriate form that can be displayed by the grid\r\n             * @param gridDataArray {Array} array containing grid data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the grid\r\n             */\r\n            function gridDataMapping(gridDataArray = []){\r\n                return gridDataArray.map(function(dataObject){\r\n                    dataObject.DDATE = kendo.toString(kendo.parseDate(dataObject.DDATE, \"yyyy-MM-dd\"),\r\n                        \"yyyy-MM-dd\"); // convert to date object\r\n                    dataObject.AMOUNT = kendo.parseFloat(dataObject.AMOUNT); // convert the amount from string to number\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * update the expense track barchart. Either usinf cached data or remote data\r\n         *\r\n         * @param periodType\r\n         * @param customStartDate\r\n         * @param customEndDate\r\n         */\r\n        updateExpenseTrackerBarChart: function(periodType = 'today', customStartDate, customEndDate){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Bar Chart (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Bar Chart (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Bar Chart (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"custom\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Bar Chart (Custom)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the walletIncoming Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerBarChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerBarChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#expense-tracker-page #expense-tracker-barchart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                        ALLY Expense Tracker -Bar Chart\r\n                    </div>\r\n                    <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                        <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                        </ons-icon>\r\n                    </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.expenseTrackerChart.loadExpenseTrackerData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerBarChart =\r\n                        new ej.charts.Chart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            palettes: [\"#0FD0D0\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: true,\r\n                                format: 'Category: ${point.x} | Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: false\r\n                            },\r\n                            primaryYAxis: {\r\n                                title: 'Amount (N)',\r\n                                valueType: 'Double',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                },\r\n                                labelFormat: '{value}k',\r\n                                edgeLabelPlacement: 'Hide',\r\n                                labelIntersectAction: 'Hide'\r\n                            },\r\n                            primaryXAxis: {\r\n                                title: 'Expense Category',\r\n                                valueType: 'Category',\r\n                                titleStyle: {\r\n                                    size: '1em',\r\n                                    textAlignment: 'center'\r\n                                },\r\n                                edgeLabelPlacement: 'Shift',\r\n                                labelRotation: 45\r\n                            },\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                width: 5,\r\n                                xName: 'CATEGORY', yName: 'SUM',\r\n                                name: 'Expenses',\r\n                                //Series type as Column\r\n                                type: 'Column'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#expense-tracker-page #expense-tracker-barchart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerBarChart.\r\n                    appendTo('#expense-tracker-barchart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            // create the data to be sent to server\r\n            var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                duration: periodType};\r\n            // check if the periodType == custom . if so append the custom date ranges\r\n            if(periodType == 'custom'){\r\n                formData.from_date = kendo.toString(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.startDate, \"yyyy-MM-dd\");\r\n                formData.to_date = kendo.toString(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.endDate, \"yyyy-MM-dd\");\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet payments-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-expenses-group.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: formData // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.expenseTrackerChart.loadExpenseTrackerData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                return utopiasoftware.ally.expenseTrackerChart.saveExpenseTrackerData(chartDataArray[1]);\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerBarChart =\r\n                    new ej.charts.Chart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        palettes: [\"#0FD0D0\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: true,\r\n                            format: 'Category: ${point.x} | Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: false\r\n                        },\r\n                        primaryYAxis: {\r\n                            title: 'Amount (N)',\r\n                            valueType: 'Double',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            },\r\n                            labelFormat: '{value}k',\r\n                            edgeLabelPlacement: 'Hide',\r\n                            labelIntersectAction: 'Hide'\r\n                        },\r\n                        primaryXAxis: {\r\n                            title: 'Expense Category',\r\n                            valueType: 'Category',\r\n                            titleStyle: {\r\n                                size: '1em',\r\n                                textAlignment: 'center'\r\n                            },\r\n                            edgeLabelPlacement: 'Shift',\r\n                            labelRotation: 45\r\n                        },\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            width: 5,\r\n                            xName: 'CATEGORY', yName: 'SUM',\r\n                            name: 'Expenses',\r\n                            //Series type as Column\r\n                            type: 'Column'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#expense-tracker-page #expense-tracker-barchart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerBarChart.\r\n                appendTo('#expense-tracker-barchart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray = []){\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.SUM = (kendo.parseFloat(dataObject.SUM))/1000;\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * update the expense track doughnut chart. Either using cached data or remote data\r\n         *\r\n         * @param periodType\r\n         * @param customStartDate\r\n         * @param customEndDate\r\n         */\r\n        updateExpenseTrackerDoughnutChart: function(periodType = 'today', customStartDate, customEndDate){\r\n\r\n            // variable holds the object that contains the customisable settings for the chart created based on the 'periodType' parameter\r\n            var chartCustomisableSettings = null;\r\n\r\n            switch(periodType){ // check the periodType parameter and format chartCutomisableSetting accordingly\r\n\r\n                case \"today\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Doughnut Chart (Today)\",\r\n                        labelFormat: 'ha',\r\n                        intervalType: 'Hours'};\r\n                    break;\r\n\r\n                case \"weekly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Doughnut Chart (Last 7 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"monthly\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Doughnut Chart (Last 30 Days)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n\r\n                case \"custom\":\r\n                    chartCustomisableSettings = {chartTitle: \"ALLY Expense Tracker -Doughnut Chart (Custom)\",\r\n                        labelFormat: 'dMMM',\r\n                        intervalType: 'Days'};\r\n                    break;\r\n            }\r\n\r\n            // check if the Doughnut Chart has been created before, of so destroy it\r\n            if(utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDoughnutChart){ // chart has previously been created\r\n                // destroy the chart object\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDoughnutChart.destroy();\r\n            }\r\n\r\n            // display chart loading indicator\r\n            $('#expense-tracker-page #expense-tracker-doughnut-chart').\r\n            html(`<div class=\"title\" style=\"font-size: 0.85em; padding: 0.5em;\">\r\n                        ALLY Expense Tracker -Doughnut Chart\r\n                    </div>\r\n                    <div class=\"content\" style=\"padding: 0.5em;\">\r\n\r\n                        <ons-icon icon=\"md-settings\" size=\"28px\" style=\"color: #30a401;\" spin>\r\n                        </ons-icon>\r\n                    </div>`);\r\n\r\n\r\n            // check if there is internet connection or not\r\n            if(navigator.connection.type === Connection.NONE){ // there is no internet connection\r\n                // inform the user that cached data will be displayed in the absence of internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"No Internet Connection. Previously cached data will be displayed\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#008000',\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                // load the previously cached data\r\n                utopiasoftware.ally.expenseTrackerChart.loadExpenseTrackerData().\r\n                then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                    // format the chart data array so it can be properly used\r\n                    return chartDataMapping(chartDataArray[periodType]);\r\n                }).\r\n                then(function(chartDataArray){\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDoughnutChart =\r\n                        new ej.charts.AccumulationChart({\r\n                            // Width and height for chart in pixel\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                            //palettes: [\"#0FD0D0\"],\r\n                            title: chartCustomisableSettings.chartTitle,\r\n                            titleStyle: {\r\n                                size: '1em'\r\n                            },\r\n                            tooltip: { enable: false,\r\n                                format: 'Category: ${point.x} | Amount: ${point.y}'\r\n                            },\r\n                            // Legend for chart\r\n                            legendSettings: {\r\n                                visible: true\r\n                            },\r\n                            enableSmartLabels: true,\r\n                            series: [{\r\n                                dataSource: chartDataArray,\r\n                                xName: 'CATEGORY', yName: 'SUM',\r\n                                name: 'Expenses',\r\n                                dataLabel: {\r\n                                    visible: true,\r\n                                    name: 'LABELTEXT',\r\n                                    position: 'Outside',\r\n                                    font: {\r\n                                        color: '#000000'\r\n                                    }\r\n                                },\r\n                                innerRadius: '40%',\r\n                                //Series type as Column\r\n                                type: 'Pie'\r\n                            }]\r\n                        });\r\n\r\n                    // remove the loader content\r\n                    $('#expense-tracker-page #expense-tracker-doughnut-chart').html(\"\");\r\n                    //append the newly created chart\r\n                    utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDoughnutChart.\r\n                    appendTo('#expense-tracker-doughnut-chart');\r\n                });\r\n\r\n                return; // exit method\r\n            }\r\n\r\n            // create the data to be sent to server\r\n            var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                duration: periodType};\r\n            // check if the periodType == custom . if so append the custom date ranges\r\n            if(periodType == 'custom'){\r\n                formData.from_date = kendo.toString(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.startDate, \"yyyy-MM-dd\");\r\n                formData.to_date = kendo.toString(utopiasoftware.ally.controller.expenseTrackerPageViewModel.\r\n                    expenseTrackerDateRangerPicker.endDate, \"yyyy-MM-dd\");\r\n            }\r\n\r\n            //THERE IS AN INTERNET CONNECTION\r\n            // request for the user wallet payments-in data for the provided time period\r\n            Promise.resolve($.ajax(\r\n                {\r\n                    url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-my-expenses-group.php\",\r\n                    //url: \"in-wallet-chart-dummy.json\",\r\n                    type: \"post\",\r\n                    contentType: \"application/x-www-form-urlencoded\",\r\n                    beforeSend: function(jqxhr) {\r\n                        jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                    },\r\n                    dataType: \"text\",\r\n                    timeout: 240000, // wait for 4 minutes before timeout of request\r\n                    processData: true,\r\n                    data: formData // data to submit to server\r\n                }\r\n            )).\r\n            then(function(serverResponse){// retrieve the server response\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // return the server response as an object\r\n                return Promise.all([serverResponse, utopiasoftware.ally.expenseTrackerChart.loadExpenseTrackerData()]);\r\n            }).\r\n            then(function(chartDataArray){ // save the chart array data to cache\r\n                chartDataArray[1] = chartDataArray[1];\r\n                chartDataArray[1][periodType] = chartDataArray[0];\r\n                /****\r\n                 * NOTE: IN THIS CASE, THERE IS NO NEED TO SAVE THE DATA AGAIN TO PERSISTENT STORAGE.\r\n                 * THIS HAVE ALREADY BEEN DONE BEFORE BY THE BARCHART CREATION METHOD\r\n                 *****/\r\n                return chartDataArray[1];\r\n            }).\r\n            then(function(chartDataArray){ // get the chart data array to be used by chart\r\n                // format the chart data array so it can be properly used\r\n                return chartDataMapping(chartDataArray[periodType]);\r\n            }).\r\n            then(function(chartDataArray){\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDoughnutChart =\r\n                    new ej.charts.AccumulationChart({\r\n                        // Width and height for chart in pixel\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        margin: { left: 0, right: 15, top: 0, bottom: 0 },\r\n                        //palettes: [\"#0FD0D0\"],\r\n                        title: chartCustomisableSettings.chartTitle,\r\n                        titleStyle: {\r\n                            size: '1em'\r\n                        },\r\n                        tooltip: { enable: false,\r\n                            format: 'Category: ${point.x} | Amount: ${point.y}'\r\n                        },\r\n                        // Legend for chart\r\n                        legendSettings: {\r\n                            visible: true\r\n                        },\r\n                        enableSmartLabels: true,\r\n                        series: [{\r\n                            dataSource: chartDataArray,\r\n                            xName: 'CATEGORY', yName: 'SUM',\r\n                            name: 'Expenses',\r\n                            dataLabel: {\r\n                                visible: true,\r\n                                name: 'LABELTEXT',\r\n                                position: 'Outside',\r\n                                font: {\r\n                                    color: '#000000'\r\n                                }\r\n                            },\r\n                            innerRadius: '40%',\r\n                            //Series type as Column\r\n                            type: 'Pie'\r\n                        }]\r\n                    });\r\n\r\n                // remove the loader content\r\n                $('#expense-tracker-page #expense-tracker-doughnut-chart').html(\"\");\r\n                //append the newly created chart\r\n                utopiasoftware.ally.controller.expenseTrackerPageViewModel.expenseTrackerDoughnutChart.\r\n                appendTo('#expense-tracker-doughnut-chart');\r\n            });\r\n\r\n\r\n            /**\r\n             * function is used to map the chart data into an appropriate forma that can be displayed inby the chart\r\n             * @param chartDataArray {Array} array containing chart data objects to be mapped\r\n             *\r\n             * @return {Array} an array containing properly formatted objects that can be used by the chart\r\n             */\r\n            function chartDataMapping(chartDataArray = []){\r\n                var totalSum = 0; // the variable holds the grand total of all category summation\r\n\r\n                // get the grand total\r\n                totalSum = chartDataArray.reduce(function(accumulator, currentValue){\r\n                    accumulator += kendo.parseFloat(currentValue.SUM);\r\n                    return accumulator;\r\n                }, totalSum);\r\n\r\n                return chartDataArray.map(function(dataObject){\r\n                    dataObject.SUM = (kendo.parseFloat(dataObject.SUM));\r\n                    dataObject.LABELTEXT = kendo.toString((dataObject.SUM / totalSum), \"p\");\r\n                    return dataObject; // return the modified object\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is used to switch between the different types of expense visualisation\r\n         * i.e. between Grid and Chart type\r\n         *\r\n         * @param buttonVizTypeState\r\n         */\r\n        switchVizTypeButtonClicked: function(buttonVizTypeState){\r\n\r\n            // handle the different buttonVizTypeState values\r\n            switch(buttonVizTypeState){\r\n                case \"chart\": // current state is 'chart'. so, display chart now\r\n                    // move the carousel to the 1st chart item\r\n                    $('#expense-tracker-page #expense-tracker-carousel').get(0).setActiveIndex(1).\r\n                    then(function(){\r\n                        // display the chart visualisation mover button\r\n                        $('#expense-tracker-page #expense-tracker-viz-mover-fab').css(\"display\", \"inline-block\");\r\n                        // set the icon for the mover button\r\n                        $('#expense-tracker-page #expense-tracker-viz-mover-fab ons-icon').attr(\"icon\", \"md-chevron-up\");\r\n                        // set the visualisation mover value for the mover button\r\n                        $('#expense-tracker-page #expense-tracker-viz-mover-fab').attr(\"data-ally-viz-mover\", \"up\");\r\n                        // move the expense tracker add button to the corner of the screen\r\n                        $('#expense-tracker-page #expense-tracker-add-expense-fab').css(\"margin-left\", \"calc(100vw - 48px)\");\r\n                    });\r\n                    break;\r\n\r\n                case \"grid\": // current state is 'grid'. so display grid\r\n                    // move the carousel to the grid item\r\n                    $('#expense-tracker-page #expense-tracker-carousel').get(0).setActiveIndex(2).\r\n                    then(function(){\r\n                        // hide the chart visualisation mover button\r\n                        $('#expense-tracker-page #expense-tracker-viz-mover-fab').css(\"display\", \"none\");\r\n                        // set the icon for the mover button\r\n                        $('#expense-tracker-page #expense-tracker-viz-mover-fab ons-icon').attr(\"icon\", \"md-chevron-up\");\r\n                        // set the visualisation mover value for the mover button\r\n                        $('#expense-tracker-page #expense-tracker-viz-mover-fab').attr(\"data-ally-viz-mover\", \"up\");\r\n                        // move the expense tracker add button close to the middle of the screen\r\n                        $('#expense-tracker-page #expense-tracker-add-expense-fab').css(\"margin-left\", \"43vw\");\r\n                    });\r\n                    break;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is used to move between the available chart types\r\n         *\r\n         * @param buttonElem\r\n         */\r\n        moveVizButtonClicked: function(buttonElem){\r\n            var vizMoverPosition = $(buttonElem).attr('data-ally-viz-mover'); // get the visualisation mover state of the button\r\n\r\n            // handle the different vizMoverPosition values\r\n            switch(vizMoverPosition){\r\n                case \"up\": // current position is 'up'. so, move the carousel to the next higher item\r\n                    $('#expense-tracker-page #expense-tracker-carousel').get(0).setActiveIndex(0).\r\n                    then(function(){\r\n                        // change the button icon from up to down\r\n                        $('ons-icon', buttonElem).attr(\"icon\", \"md-chevron-down\");\r\n                        // update the button visualisation mover state attribute of the button\r\n                        $(buttonElem).attr(\"data-ally-viz-mover\", \"down\");\r\n                    });\r\n                    break;\r\n\r\n                case \"down\": // current position is 'down'. so, move the carousel to the next lower item\r\n                    $('#expense-tracker-page #expense-tracker-carousel').get(0).setActiveIndex(1).\r\n                    then(function(){\r\n                        // change the button icon from down to up\r\n                        $('ons-icon', buttonElem).attr(\"icon\", \"md-chevron-up\");\r\n                        // update the button visualisation mover state attribute of the button\r\n                        $(buttonElem).attr(\"data-ally-viz-mover\", \"up\");\r\n                    });\r\n                    break;\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * object is view-model for add-expense page\r\n     */\r\n    addExpensePageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the parsley validator for the Amount field\r\n         */\r\n        amountFieldValidator: null,\r\n\r\n        /**\r\n         * * used to hold the ej Tooltip component\r\n         */\r\n        formTooltip: null,\r\n\r\n        /**\r\n         * used to hold the expense category ej DropdownList component\r\n         */\r\n        expenseCategoryDropdown: null,\r\n\r\n        /**\r\n         * used to hold the expense DatePicker component\r\n         */\r\n        expenseDatePicker: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.backButtonClicked;\r\n\r\n                // display the page preloader\r\n                $('.page-preloader', $thisPage).css('display', \"block\");\r\n\r\n                // hide the form\r\n                $('#add-expense-form', $thisPage).css('display', \"none\");\r\n\r\n                // initialise the expense DatePicker\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker =\r\n                    new ej.calendars.DatePicker({\r\n                        placeholder: 'Pick Expense Date',\r\n                        floatLabelType: 'Auto',\r\n                        readonly: true,\r\n                        // sets the value.\r\n                        value: new Date(),\r\n                        // sets the min date\r\n                        //min: new Date(),\r\n                        //sets the max date\r\n                        max: new Date(),\r\n                        format: 'yyyy-MM-dd',\r\n                        focus: function(){ // listen for when component has focus\r\n                            // open the date picker\r\n                            utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.show();\r\n                        }\r\n                    });\r\n\r\n                // render initialized expense DatePicker\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.\r\n                appendTo('#add-expense-date');\r\n\r\n\r\n                // initialise the expense category widget\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown =\r\n                    new ej.dropdowns.DropDownList({\r\n                    //set the data to dataSource property\r\n                    dataSource: [],\r\n                    fields: {text: 'CATEGORYNAME', value: 'CATEGORYNAME'},\r\n                    sortOrder: 'Ascending',\r\n                    placeholder: \"Select Category\",\r\n                    floatLabelType: \"Auto\",\r\n                    popupHeight: \"300px\"\r\n                });\r\n\r\n                // render initialized card DropDownList\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown.\r\n                appendTo('#add-expense-categories');\r\n\r\n                // initialise form tooltips\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formTooltip = new ej.popups.Tooltip({\r\n                    target: '.ally-input-tooltip',\r\n                    position: 'top center',\r\n                    cssClass: 'ally-input-tooltip',\r\n                    opensOn: 'focus'\r\n                });\r\n\r\n                // render the initialized form tooltip\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formTooltip.appendTo('#add-expense-form');\r\n\r\n                // initialise the amount field\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.amountFieldValidator =\r\n                    $('#add-expense-amount').parsley({\r\n                        value: function(parsley) {\r\n                            // convert the amount back to a plain text without the thousand separator\r\n                            let parsedNumber = kendo.parseFloat($('#add-expense-amount', $thisPage).val());\r\n                            return (parsedNumber ? parsedNumber : $('#add-expense-amount', $thisPage).val());\r\n                        }\r\n                    });\r\n\r\n                // initialise the form validation\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator = $('#add-expense-form').parsley();\r\n\r\n                // attach listener for the wallet-transfer button on the page\r\n                $('#add-expense-add-button').get(0).onclick = function(){\r\n                    // run the validation method for the form\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.whenValidate();\r\n                };\r\n\r\n                // listen for the form field validation failure event\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                    $(fieldInstance.$element).attr(\"title\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for the form field validation success event\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                    $(fieldInstance.$element).removeAttr(\"title\");\r\n                });\r\n\r\n                // listen for the form validation success\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.formValidated);\r\n\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // start a promise chain to setup the page\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-expense-categories.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData // data to submit to server\r\n                    }\r\n                )).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                    // initialise the category DropDown widget\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.\r\n                        expenseCategoryDropdown.dataSource = serverResponse;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown.dataBind();\r\n                }).\r\n                then(function(){\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#add-expense-form', $thisPage).css('display', \"block\");\r\n\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n\r\n\r\n                }).\r\n                catch(function(err){\r\n                    console.log(err);\r\n                    // hide the page preloader\r\n                    $('.page-preloader', $thisPage).css('display', \"none\");\r\n\r\n                    // display the form\r\n                    $('#add-expense-form', $thisPage).css('display', \"block\");\r\n\r\n                    // inform the user that they cannot proceed without Internet\r\n                    window.plugins.toast.showWithOptions({\r\n                        message: \"some content could be loaded without an Internet Connection\",\r\n                        duration: 4000,\r\n                        position: \"top\",\r\n                        styling: {\r\n                            opacity: 1,\r\n                            backgroundColor: '#ff0000', //red\r\n                            textColor: '#FFFFFF',\r\n                            textSize: 14\r\n                        }\r\n                    }, function(toastEvent){\r\n                        if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                            window.plugins.toast.hide();\r\n                        }\r\n                    });\r\n\r\n                });\r\n\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {\r\n            // check if the expense category dropdown has been initialised\r\n            if(utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown){\r\n                // repopulate the expense category dropdown list\r\n                // create the form data to be sent\r\n                var formData = {phone: utopiasoftware.ally.model.appUserDetails.phone};\r\n\r\n                // start a promise chain to setup the page\r\n                Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/get-expense-categories.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData // data to submit to server\r\n                    }\r\n                )).\r\n                then(function(serverResponse){\r\n                    serverResponse +=  \"\";\r\n                    serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                    // initialise the card DropDown widget\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.\r\n                        expenseCategoryDropdown.dataSource = serverResponse;\r\n\r\n                    // bind the new update to the dropdown list\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown.dataBind();\r\n                }).catch(function(){});\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-expense-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-expense-page [title]').removeAttr(\"title\");\r\n                $('#add-expense-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n            try{\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#add-expense-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#add-expense-page [data-hint]').removeAttr(\"title\");\r\n                $('#add-expense-page [data-hint]').removeAttr(\"data-hint\");\r\n                // destroy the form validator objects on the page\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.amountFieldValidator.destroy();\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         */\r\n        formValidated: function(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"New expense cannot be added without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // create the form data to be submitted\r\n            var formData = {\r\n                phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                description: $('#add-expense-page #add-expense-description').val().trim(),\r\n                amount: kendo.parseFloat($('#add-expense-page #add-expense-amount').val()),\r\n                category: utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown.value,\r\n                date: kendo.toString(utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.value,\r\n                \"yyyy-MM-dd\")\r\n            };\r\n\r\n\r\n            // display the loader message to indicate that account is being created;\r\n            $('#hour-glass-loader-modal .modal-message').html(\"Adding New Expense...\");\r\n            // forward the form data & show loader\r\n            Promise.all([formData, Promise.resolve($('#hour-glass-loader-modal').get(0).show())]).\r\n            then(function(dataArray){\r\n                // submit the form data\r\n                return Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware.ally.model.ally_base_url + \"/mobile/save-expense.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: dataArray[0] // data to submit to server\r\n                    }\r\n                ));\r\n            }).\r\n            then(function(serverResponse){\r\n                serverResponse +=  \"\";\r\n                serverResponse = JSON.parse(serverResponse.trim()); // get the response object\r\n\r\n                // check if any error occurred\r\n                if(serverResponse.status != \"success\"){ // an error occured\r\n                    throw serverResponse.message; // throw the error message attached to this error\r\n                }\r\n\r\n                return serverResponse; // forward the server response\r\n            }).\r\n            then(function(serverResponse){\r\n                // hide the loader\r\n                return Promise.all([serverResponse, $('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(){\r\n\r\n                // reset the page scroll position to the top\r\n                $('#add-expense-page .page__content').scrollTop(0);\r\n                // hide the loader\r\n                return Promise.all([$('#hour-glass-loader-modal').get(0).hide()]);\r\n            }).\r\n            then(function(){\r\n\r\n                // reset the form for the add expense page\r\n                $('#add-expense-page #add-expense-form').get(0).reset();\r\n                // reset the form validator object on the page\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.formValidator.reset();\r\n\r\n                // reset the date picker dropdown to the default value\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.value =\r\n                    utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.max;\r\n               utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.dataBind();\r\n\r\n                // reset the expense category dropdown to default value\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown.value = null;\r\n                utopiasoftware.ally.controller.addExpensePageViewModel.expenseCategoryDropdown.dataBind();\r\n\r\n                return Promise.all([ons.notification.toast(\"Expense Successfully Added!\", {timeout:4000})]); // conclude expense added process\r\n\r\n            }).\r\n            catch(function(err){\r\n                if(typeof err !== \"string\"){ // if err is NOT a String\r\n                    err = \"Sorry. New expense could not be added. Please retry\"\r\n                }\r\n\r\n                $('#hour-glass-loader-modal').get(0).hide(); // hide loader\r\n                ons.notification.alert({title: '<ons-icon icon=\"md-close-circle-o\" size=\"32px\" ' +\r\n                'style=\"color: red;\"></ons-icon> Expense Addition Failed',\r\n                    messageHTML: '<span>' + err + '</span>',\r\n                    cancelable: false\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // close the date picker if it is open\r\n            utopiasoftware.ally.controller.addExpensePageViewModel.expenseDatePicker.hide();\r\n\r\n            // move to the previous page on the app main navigator stack\r\n            $('#app-main-navigator').get(0).popPage();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for account-settings page\r\n     */\r\n    accountSettingsPageViewModel: {\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.ally.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware.ally.controller.accountSettingsPageViewModel.backButtonClicked;\r\n\r\n                // add listener for when the push notification setting is changed\r\n                $('#account-settings-push-notification', $thisPage).on(\"change\", function(toggleEvent){\r\n                    try{\r\n                        window.plugins.OneSignal.\r\n                        setSubscription(toggleEvent.originalEvent.value); // enable/disable push notification\r\n                        // inform the user of the update\r\n                        ons.notification.\r\n                        toast(`${toggleEvent.originalEvent.value ? 'Enabled' : 'Disabled'} push notifications`, {timeout:3000})\r\n                    }\r\n                    catch(err){ // display an error message to the user\r\n                        window.plugins.toast.showWithOptions({\r\n                            message: \"your push notification setting could not be updated right now\",\r\n                            duration: 4000,\r\n                            position: \"top\",\r\n                            styling: {\r\n                                opacity: 1,\r\n                                backgroundColor: '#ff0000', //red\r\n                                textColor: '#FFFFFF',\r\n                                textSize: 14\r\n                            }\r\n                        }, function(toastEvent){\r\n                            if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                                window.plugins.toast.hide();\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n                // add listener for when the ussd setting is changed\r\n                $('#account-settings-ussd', $thisPage).on(\"change\", function(toggleEvent){\r\n                    // show page preloader\r\n                    $('.page-preloader', $thisPage).css(\"display\", \"block\");\r\n                    // update the user's ussd setting\r\n                    Promise.resolve($.ajax(\r\n                        {\r\n                            url: utopiasoftware.ally.model.ally_base_url + \"/mobile/ussd-save-status.php\",\r\n                            type: \"post\",\r\n                            contentType: \"application/x-www-form-urlencoded\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                            },\r\n                            dataType: \"text\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: true,\r\n                            data: {phone: utopiasoftware.ally.model.appUserDetails.phone,\r\n                            status: toggleEvent.originalEvent.value ? 1 : 0}\r\n                        }\r\n                    )).\r\n                    then(function(serverResponse){\r\n                        serverResponse = serverResponse.trim();\r\n                        if(serverResponse !== \"success\"){ // an error occured\r\n                            throw \"error\";\r\n                        }\r\n                        else{ // there was no error\r\n                            // hide page preloader\r\n                            $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                            // inform user that ussd settings have changed\r\n                            ons.notification.\r\n                            toast(`${toggleEvent.originalEvent.value ? 'Enabled' : 'Disabled'} ALLY USSD`, {timeout:3000})\r\n                        }\r\n                    }).catch(function(){ // an error occurred\r\n                        // hide page preloader\r\n                        $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                        // inform the user of the error\r\n                        window.plugins.toast.showWithOptions({\r\n                            message: \"your ALLY USSD setting could not be updated right now\",\r\n                            duration: 4000,\r\n                            position: \"top\",\r\n                            styling: {\r\n                                opacity: 1,\r\n                                backgroundColor: '#ff0000', //red\r\n                                textColor: '#FFFFFF',\r\n                                textSize: 14\r\n                            }\r\n                        }, function(toastEvent){\r\n                            if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                                window.plugins.toast.hide();\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n\r\n\r\n                // retrieve the app's currently version number and update the page footer display\r\n                Promise.resolve(cordova.getAppVersion.getVersionNumber()).\r\n                then(function (versionNumber) { // get the app version number\r\n                    $('#account-settings-ally-version', $thisPage).html(versionNumber); // update the version number display\r\n                }).\r\n                then(function(){ // get the present push notification status of the device\r\n                    return new Promise(function(resolve, reject){\r\n                        window.plugins.OneSignal.getPermissionSubscriptionState(resolve); // get device push notification status\r\n                    });\r\n                }).\r\n                then(function(pushStatus){ // update the displayed push notification settings status based on its current setting\r\n                    // check if push notification is enabled and allowed\r\n                    if(pushStatus.subscriptionStatus.subscribed === true &&\r\n                        pushStatus.subscriptionStatus.userSubscriptionSetting === true){ // push notification is enabled\r\n                        // enable the push notification setting\r\n                        $('#account-settings-push-notification', $thisPage).get(0).checked = true;\r\n                    }\r\n                    else{ // push notification is disabled\r\n                        // disable the push notification setting\r\n                        $('#account-settings-push-notification', $thisPage).get(0).checked = false;\r\n                    }\r\n\r\n                }).\r\n                then(function(){ // get the current user ussd setting from the app\r\n                    return Promise.resolve($.ajax(\r\n                        {\r\n                            url: utopiasoftware.ally.model.ally_base_url + \"/mobile/ussd-get-status.php\",\r\n                            type: \"post\",\r\n                            contentType: \"application/x-www-form-urlencoded\",\r\n                            beforeSend: function(jqxhr) {\r\n                                jqxhr.setRequestHeader(\"X-ALLY-APP\", \"mobile\");\r\n                            },\r\n                            dataType: \"text\",\r\n                            timeout: 240000, // wait for 4 minutes before timeout of request\r\n                            processData: true,\r\n                            data: {phone: utopiasoftware.ally.model.appUserDetails.phone}\r\n                        }\r\n                    ));\r\n                }).\r\n                then(function(serverResponse){ // retrieve the server response and update the ussd settings accordingly\r\n                    serverResponse = window.parseInt(serverResponse.trim()); // response could be either 1 or 0\r\n                    // the update the ussd settings display\r\n                    $('#account-settings-ussd', $thisPage).get(0).checked = serverResponse === 1 ? true:false;\r\n                }).\r\n                then(function(){\r\n                    // remove page preloader\r\n                    $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                }).\r\n                catch(function(){\r\n                    // remove page preloader\r\n                    $('.page-preloader', $thisPage).css(\"display\", \"none\");\r\n                    window.plugins.toast.showWithOptions({\r\n                        message: \"your account settings could not be updated right now. Please check your Internet connection\",\r\n                        duration: 4000,\r\n                        position: \"top\",\r\n                        styling: {\r\n                            opacity: 1,\r\n                            backgroundColor: '#ff0000', //red\r\n                            textColor: '#FFFFFF',\r\n                            textSize: 14\r\n                        }\r\n                    }, function(toastEvent){\r\n                        if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                            window.plugins.toast.hide();\r\n                        }\r\n                    });\r\n                });\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         *\r\n         * @param event\r\n         */\r\n        pageShow: (event) => {\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is hidden\r\n         * @param event\r\n         */\r\n        pageHide: (event) => {\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the page is destroyed\r\n         * @param event\r\n         */\r\n        pageDestroy: (event) => {\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            // move to the previous page on the app main navigator stack\r\n            $('#app-main-navigator').get(0).popPage();\r\n        }\r\n\r\n    }\r\n};\r\n"]}